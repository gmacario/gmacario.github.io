{"pageProps":{"post":{"title":"Testing Rancher OS","content":"<h3 id=\"introduction\">Introduction</h3>\n<p>My first steps trying <a href=\"http://rancher.com/rancher-os/\">RancherOS</a>.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://medium.com/devs-foodit/pimp-my-jenkins-continuous-delivery-dashboard-edition-229463755730\">https://medium.com/devs-foodit/pimp-my-jenkins-continuous-delivery-dashboard-edition-229463755730</a></li>\n<li><a href=\"http://rancher.com/deploying-a-scalable-jenkins-cluster-with-docker-and-rancher/\">http://rancher.com/deploying-a-scalable-jenkins-cluster-with-docker-and-rancher/</a></li>\n<li><a href=\"http://thenewstack.io/now-in-beta-rancher-labs-runs-docker-natively-in-production/\">http://thenewstack.io/now-in-beta-rancher-labs-runs-docker-natively-in-production/</a></li>\n<li><a href=\"https://www.quora.com/What-are-the-differences-between-RancherOS-and-CoreOS\">https://www.quora.com/What-are-the-differences-between-RancherOS-and-CoreOS</a></li>\n<li><a href=\"https://github.com/rancher/os\">https://github.com/rancher/os</a></li>\n<li><a href=\"http://docs.rancher.com/os/quick-start-guide/\">http://docs.rancher.com/os/quick-start-guide/</a></li>\n</ul>\n<h3 id=\"launching-rancheros-using-vagrant\">Launching RancherOS using Vagrant</h3>\n<p>(adapted from <a href=\"http://docs.rancher.com/os/quick-start-guide/\">http://docs.rancher.com/os/quick-start-guide/</a>)</p>\n<p>Logged in as gmacario@itm-gmacario-w7, start a Cygwin terminal</p>\n<p>Clone the RancherOS Vagrant repository.</p>\n<pre><code>$ mkdir -p ~/test &amp;&amp; cd ~/test\n$ git clone https://github.com/rancher/os-vagrant.git\n$ cd os-vagrant\n</code></pre>\n<p>Startup your VM with <code>vagrant up</code></p>\n<pre><code>$ vagrant up\nBringing machine &#39;rancher-01&#39; up with &#39;virtualbox&#39; provider...\n...\n==&gt; rancher-01: Machine booted and ready!\n==&gt; rancher-01: Setting hostname...\n==&gt; rancher-01: Configuring and enabling network interfaces...\n</code></pre>\n<p>Log into your VM with <code>vagrant ssh</code></p>\n<pre><code>$ vagrant ssh\n[rancher@rancher-01 ~]$\n</code></pre>\n<h3 id=\"a-first-look-at-rancheros\">A first look at RancherOS</h3>\n<h4 id=\"check-kernel-version\">Check kernel version</h4>\n<pre><code>[rancher@rancher-01 ~]$ uname -a\nLinux rancher-01 4.2.3-rancher #1 SMP Wed Oct 14 11:25:04 UTC 2015 x86_64 GNU/Linux\n[rancher@rancher-01 ~]$\n</code></pre>\n<h4 id=\"inspect-disk-usage\">Inspect disk usage</h4>\n<pre><code>[rancher@rancher-01 ~]$ sudo df -h\nFilesystem                Size      Used Available Use% Mounted on\noverlay                  36.5G    231.4M     34.3G   1% /\ntmpfs                   484.9M         0    484.9M   0% /dev\ntmpfs                   498.3M         0    498.3M   0% /sys/fs/cgroup\nnone                    498.3M    252.0K    498.0M   0% /run\n/dev/sda1                36.5G    231.4M     34.3G   1% /home\n/dev/sda1                36.5G    231.4M     34.3G   1% /opt\n/dev/sda1                36.5G    231.4M     34.3G   1% /etc/docker\n/dev/sda1                36.5G    231.4M     34.3G   1% /lib/firmware\nnone                    498.3M    252.0K    498.0M   0% /var/run\n/dev/sda1                36.5G    231.4M     34.3G   1% /sbin/reboot\n/dev/sda1                36.5G    231.4M     34.3G   1% /var/log\ndevtmpfs                484.9M         0    484.9M   0% /host/dev\nshm                      64.0M         0     64.0M   0% /host/dev/shm\n/dev/sda1                36.5G    231.4M     34.3G   1% /sbin/shutdown\n/dev/sda1                36.5G    231.4M     34.3G   1% /sbin/halt\n/dev/sda1                36.5G    231.4M     34.3G   1% /sbin/iptables\n/dev/sda1                36.5G    231.4M     34.3G   1% /sbin/poweroff\n/dev/sda1                36.5G    231.4M     34.3G   1% /etc/rkt\n/dev/sda1                36.5G    231.4M     34.3G   1% /lib/modules\n/dev/sda1                36.5G    231.4M     34.3G   1% /usr/sbin/ros\n/dev/sda1                36.5G    231.4M     34.3G   1% /usr/bin/system-docker\n/dev/sda1                36.5G    231.4M     34.3G   1% /var/lib/docker\n/dev/sda1                36.5G    231.4M     34.3G   1% /usr/bin/user-docker\n/dev/sda1                36.5G    231.4M     34.3G   1% /var/lib/rkt\n/dev/sda1                36.5G    231.4M     34.3G   1% /usr/sbin/wait-for-network\n/dev/sda1                36.5G    231.4M     34.3G   1% /usr/bin/dockerlaunch\n/dev/sda1                36.5G    231.4M     34.3G   1% /usr/bin/cloud-init\n/dev/sda1                36.5G    231.4M     34.3G   1% /usr/bin/docker.dist\n/dev/sda1                36.5G    231.4M     34.3G   1% /usr/sbin/rancherctl\n/dev/sda1                36.5G    231.4M     34.3G   1% /usr/sbin/wait-for-docker\n/dev/sda1                36.5G    231.4M     34.3G   1% /usr/bin/respawn\n/dev/sda1                36.5G    231.4M     34.3G   1% /usr/sbin/netconf\n/dev/sda1                36.5G    231.4M     34.3G   1% /var/lib/rancher\n/dev/sda1                36.5G    231.4M     34.3G   1% /var/lib/rancher/conf\n/dev/sda1                36.5G    231.4M     34.3G   1% /usr/share/ros/os-config.yml\n/dev/sda1                36.5G    231.4M     34.3G   1% /etc/ssl/certs/ca-certificates.crt.rancher\n/dev/sda1                36.5G    231.4M     34.3G   1% /etc/resolv.conf\n/dev/sda1                36.5G    231.4M     34.3G   1% /etc/hostname\nshm                      64.0M         0     64.0M   0% /dev/shm\ndevtmpfs                484.9M         0    484.9M   0% /dev\nshm                      64.0M         0     64.0M   0% /dev/shm\n[rancher@rancher-01 ~]$\n</code></pre>\n<h4 id=\"check-network-interfaces\">Check network interfaces</h4>\n<pre><code>[root@rancher-01 ~]$ ifconfig\ndocker-sys Link encap:Ethernet  HWaddr 00:00:00:00:00:00\n          inet addr:172.18.42.1  Bcast:0.0.0.0  Mask:255.255.0.0\n          inet6 addr: fe80::c4e4:8ff:fe67:ae2d/64 Scope:Link\n          UP BROADCAST MULTICAST  MTU:1500  Metric:1\n          RX packets:5 errors:0 dropped:0 overruns:0 frame:0\n          TX packets:8 errors:0 dropped:0 overruns:0 carrier:0\n          collisions:0 txqueuelen:0\n          RX bytes:368 (368.0 B)  TX bytes:648 (648.0 B)\n\ndocker0   Link encap:Ethernet  HWaddr 02:42:46:53:C8:82\n          inet addr:172.17.0.1  Bcast:0.0.0.0  Mask:255.255.0.0\n          inet6 addr: fe80::42:46ff:fe53:c882/64 Scope:Link\n          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1\n          RX packets:59 errors:0 dropped:0 overruns:0 frame:0\n          TX packets:54 errors:0 dropped:0 overruns:0 carrier:0\n          collisions:0 txqueuelen:0\n          RX bytes:4003 (3.9 KiB)  TX bytes:4563 (4.4 KiB)\n\neth0      Link encap:Ethernet  HWaddr 08:00:27:9F:1D:71\n          inet addr:10.0.2.15  Bcast:10.0.2.255  Mask:255.255.255.0\n          inet6 addr: fe80::a00:27ff:fe9f:1d71/64 Scope:Link\n          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1\n          RX packets:104139 errors:0 dropped:0 overruns:0 frame:0\n          TX packets:55480 errors:0 dropped:0 overruns:0 carrier:0\n          collisions:0 txqueuelen:1000\n          RX bytes:75924932 (72.4 MiB)  TX bytes:3401703 (3.2 MiB)\n\neth1      Link encap:Ethernet  HWaddr 08:00:27:19:16:E4\n          inet addr:172.19.8.101  Bcast:0.0.0.0  Mask:255.255.255.0\n          inet6 addr: fe80::a00:27ff:fe19:16e4/64 Scope:Link\n          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1\n          RX packets:7181 errors:0 dropped:4 overruns:0 frame:0\n          TX packets:29 errors:0 dropped:0 overruns:0 carrier:0\n          collisions:0 txqueuelen:1000\n          RX bytes:755660 (737.9 KiB)  TX bytes:3362 (3.2 KiB)\n\nlo        Link encap:Local Loopback\n          inet addr:127.0.0.1  Mask:255.0.0.0\n          inet6 addr: ::1/128 Scope:Host\n          UP LOOPBACK RUNNING  MTU:65536  Metric:1\n          RX packets:0 errors:0 dropped:0 overruns:0 frame:0\n          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0\n          collisions:0 txqueuelen:0\n          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)\n\nveth0196292 Link encap:Ethernet  HWaddr FE:49:55:09:12:AA\n          inet6 addr: fe80::fc49:55ff:fe09:12aa/64 Scope:Link\n          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1\n          RX packets:13 errors:0 dropped:0 overruns:0 frame:0\n          TX packets:30 errors:0 dropped:0 overruns:0 carrier:0\n          collisions:0 txqueuelen:0\n          RX bytes:822 (822.0 B)  TX bytes:1944 (1.8 KiB)\n\n[root@rancher-01 ~]$\n</code></pre>\n<h4 id=\"check-docker-version\">Check Docker version</h4>\n<pre><code>[rancher@rancher-01 ~]$ docker version\nClient:\n Version:      1.9.1-rc1\n API version:  1.21\n Go version:   go1.4.3\n Git commit:   4663423\n Built:        Mon Nov 16 06:05:31 UTC 2015\n OS/Arch:      linux/amd64\n\nServer:\n Version:      1.9.1-rc1\n API version:  1.21\n Go version:   go1.4.3\n Git commit:   4663423\n Built:        Mon Nov 16 06:05:31 UTC 2015\n OS/Arch:      linux/amd64\n[rancher@rancher-01 ~]$\n</code></pre>\n<h4 id=\"inspect-running-system-containers\">Inspect running system containers</h4>\n<p>Notice that <code>system-docker ps</code> fails unless it is run as <code>root</code>.</p>\n<pre><code>[rancher@rancher-01 ~]$ sudo -i\n[root@rancher-01 ~]# system-docker ps\nCONTAINER ID        IMAGE                       COMMAND                  CREATED             STATUS              PORTS               NAMES\n692016a11484        rancher/os-docker:v0.4.1    &quot;/usr/sbin/entry.sh /&quot;   2 hours ago         Up 2 hours                              docker\nebe39a8deb65        rancher/os-console:v0.4.1   &quot;/usr/sbin/entry.sh /&quot;   2 hours ago         Up 2 hours                              os_console_1\nec28508ac472        rancher/os-ntp:v0.4.1       &quot;/usr/sbin/entry.sh /&quot;   2 hours ago         Up 2 hours                              ntp\n503dd1a3f135        rancher/os-network:v0.4.1   &quot;/usr/sbin/entry.sh n&quot;   2 hours ago         Up 2 hours                              network\nccf03fbf1693        rancher/os-udev:v0.4.1      &quot;/usr/sbin/entry.sh /&quot;   2 hours ago         Up 2 hours                              udev\nf6f621151318        rancher/os-acpid:v0.4.1     &quot;/usr/sbin/entry.sh /&quot;   2 hours ago         Up 2 hours                              acpid\n24a59d843f13        rancher/os-syslog:v0.4.1    &quot;/usr/sbin/entry.sh /&quot;   2 hours ago         Up 2 hours                              syslog\n[root@rancher-01 ~]# exit\nlogout\n[rancher@rancher-01 ~]$\n</code></pre>\n<h4 id=\"run-ubuntu-inside-a-container\">Run Ubuntu inside a container</h4>\n<pre><code>[rancher@rancher-01 ~]$ docker run -it ubuntu\nroot@f2180b351d1b:/# lsb_release -a\nNo LSB modules are available.\nDistributor ID: Ubuntu\nDescription:    Ubuntu 14.04.3 LTS\nRelease:        14.04\nCodename:       trusty\nroot@f2180b351d1b:/#\n</code></pre>\n<h4 id=\"run-nginx-inside-a-container\">Run nginx inside a container</h4>\n<pre><code>[rancher@rancher-01 ~]$ ifconfig eth1 | grep &quot;inet addr&quot;\n          inet addr:172.19.8.101  Bcast:0.0.0.0  Mask:255.255.255.0\n[rancher@rancher-01 ~]$ docker run -d --name nginx -p 8000:80 husseingalal/nginxbusy\n8331240ea5fdf078822dc3f79380627e6137d2a5d7d1c75fad567da12419b850\n[rancher@rancher-01 ~]$\n</code></pre>\n<p>Now logged as gmacario@itm-gmacario-w7, browse <a href=\"http://172.19.8.101:8000/\">http://172.19.8.101:8000/</a></p>\n<h4 id=\"deploy-a-system-service-container\">Deploy a system service container</h4>\n<pre><code>[rancher@rancher-01 ~]$ sudo system-docker run -d --net=host --name busydash husseingalal/busydash\nb6fb4f1983399f285c1e29f0133b454837d2d9d2f461f3328b3467233573195f\n[rancher@rancher-01 ~]$\n</code></pre>\n<p>logged as gmacario@itm-gmacario-w7, browse <a href=\"http://172.19.8.101/\">http://172.19.8.101/</a></p>\n<p><strong>NOTE 1</strong>: Docker image <code>husseingalal/busydash</code> was built from the following <code>Dockerfile</code>:</p>\n<pre><code>FROM hwestphal/nodebox\nMAINTAINER hussein.galal.ahmed.11@gmail.com\n\nRUN opkg-install unzip\nRUN curl -k -L -o master.zip https://github.com/afaqurk/linux-dash/archive/master.zip\nRUN unzip master.zip\nWORKDIR linux-dash-master\nRUN npm install\n\nENTRYPOINT [&quot;node&quot;,&quot;server&quot;]\n</code></pre>\n<p><strong>NOTE 2</strong>: Sources for Docker image <code>hwestphal/nodebox</code> are available at <a href=\"https://github.com/hwestphal/docker-nodebox\">https://github.com/hwestphal/docker-nodebox</a></p>\n<p>That&#39;s all for today... Stay tuned for future posts about RancherOS!</p>\n<!-- EOF -->\n"},"config":{"title":"gmacario.github.io","description":"Gianpaolo Macario's public rants","social":{"github":{"name":"gmacario","link":"https://github.com/gmacario"},"twitter":{"name":"gpmacario","link":"https://www.twitter.com/gpmacario"}}}},"__N_SSG":true}