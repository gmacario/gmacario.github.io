{"pageProps":{"post":{"title":"Running Kismet on a Raspberry Pi","content":"<h2 id=\"introduction\">Introduction</h2>\n<p>This post describes how to install <a href=\"https://www.kismetwireless.net/\">Kismet</a> on a Linux host, then use the program to perform some &quot;network intelligence&quot;.</p>\n<p><img src=\"https://user-images.githubusercontent.com/75182/236668176-cfafef6f-2652-422e-a7a6-5c06e84555cc.png\" alt=\"image\"></p>\n<h2 id=\"requirements\">Requirements</h2>\n<ul>\n<li>A host running a recent Debian-based distribution.\nTested on <code>rpi3bgm28</code> - a <a href=\"https://www.raspberrypi.com/products/raspberry-pi-3-model-b/\">Raspberry Pi 3 Model B</a> running <a href=\"https://www.raspberrypi.com/software/\">Raspberry Pi OS Lite</a> 64-bit (bullseye)</li>\n<li>A Wi-Fi adapter which supports monitor mode. Tested with a <a href=\"https://support.dlink.com/ProductInfo.aspx?m=DWL-G122\">D-Link DWL-G122</a> Wireless-G USB Dongle</li>\n</ul>\n<h2 id=\"step-by-step-instructions\">Step-by-step instructions</h2>\n<p>Login to the Raspberry Pi via SSH:</p>\n<pre><code class=\"language-bash\">ssh rpi3bgm28\n</code></pre>\n<p>Check the version of the installed OS</p>\n<pre><code class=\"language-bash\">uname -a\nlsb_release -a\n</code></pre>\n<p>Result</p>\n<pre><code class=\"language-text\">gmacario@rpi3bgm28:~ $ uname -a\nLinux rpi3bgm28 6.1.21-v8+ #1642 SMP PREEMPT Mon Apr  3 17:24:16 BST 2023 aarch64 GNU/Linux\ngmacario@rpi3bgm28:~ $ lsb_release -a\nNo LSB modules are available.\nDistributor ID: Debian\nDescription:    Debian GNU/Linux 11 (bullseye)\nRelease:        11\nCodename:       bullseye\ngmacario@rpi3bgm28:~ $\n</code></pre>\n<p>In our case we are running <a href=\"https://www.raspberrypi.com/software/\">Raspberry Pi OS Lite</a>:</p>\n<ul>\n<li>System: 64-bit (arch=<code>aarch64</code>)</li>\n<li>Debian Release: 11 (bullseye)</li>\n</ul>\n<p>Make sure the distribution is up-to-date</p>\n<pre><code class=\"language-bash\">sudo apt-get update \\\n  &amp;&amp; sudo apt-get -y dist-upgrade \\\n  &amp;&amp; sudo apt-get -y autoremove --purge\n</code></pre>\n<p>Install Kismet following the instructions at <a href=\"https://www.kismetwireless.net/packages/\">https://www.kismetwireless.net/packages/</a> (use the one which corresponds to the installed OS)</p>\n<pre><code class=\"language-bash\">wget -O - https://www.kismetwireless.net/repos/kismet-release.gpg.key --quiet | gpg --dearmor | sudo tee /usr/share/keyrings/kismet-archive-keyring.gpg &gt;/dev/null\necho &#39;deb [signed-by=/usr/share/keyrings/kismet-archive-keyring.gpg] https://www.kismetwireless.net/repos/apt/release/bullseye bullseye main&#39; | sudo tee /etc/apt/sources.list.d/kismet.list &gt;/dev/null\nsudo apt update\nsudo apt install kismet\n</code></pre>\n<p>Provide the following answers when requested:</p>\n<ul>\n<li>Do you want to continue? Y</li>\n<li>Should Kismet be installed with suid-root helpers? Yes</li>\n</ul>\n<p>Verify that Kismet has been installed correctly:</p>\n<pre><code class=\"language-text\">gmacario@rpi3bgm28:~ $ kismet --version\nKismet 2022-08-R1\ngmacario@rpi3bgm28:~ $\n</code></pre>\n<p>Add current user to group <code>kismet</code>:</p>\n<pre><code class=\"language-bash\">sudo usermod -aG kismet $USER\nnewgrp kismet\n</code></pre>\n<p>Logged in as <code>gmacario@rpi3bgm28</code>, type <code>iwconfig</code> to list the existing Wireless interfaces.</p>\n<pre><code class=\"language-text\">gmacario@rpi3bgm28:~ $ iwconfig\nlo        no wireless extensions.\n\neth0      no wireless extensions.\n\nwlan0     IEEE 802.11  ESSID:&quot;Galaxy A32 gpmacario&quot;\n          Mode:Managed  Frequency:2.437 GHz  Access Point: A6:B5:89:FE:22:0D\n          Bit Rate=65 Mb/s   Tx-Power=31 dBm\n          Retry short limit:7   RTS thr:off   Fragment thr:off\n          Power Management:on\n          Link Quality=57/70  Signal level=-53 dBm\n          Rx invalid nwid:0  Rx invalid crypt:0  Rx invalid frag:0\n          Tx excessive retries:0  Invalid misc:0   Missed beacon:0\n\ntailscale0  no wireless extensions.\n\ndocker0   no wireless extensions.\n\ngmacario@rpi3bgm28:~ $\n</code></pre>\n<p>Now insert the <a href=\"https://support.dlink.com/ProductInfo.aspx?m=DWL-G122\">D-Link DWL-G122</a>\ninto one USB port of the Raspberry Pi.</p>\n<p>Execute the <code>iwconfig</code> command again and verify that the Wi-Fi USB dongle gets recognized.\nTake note of the new interface name (in our case, this is <code>wlan1</code>):</p>\n<pre><code class=\"language-text\">gmacario@rpi3bgm28:~ $ iwconfig\nlo        no wireless extensions.\n\neth0      no wireless extensions.\n\nwlan0     IEEE 802.11  ESSID:&quot;Galaxy A32 gpmacario&quot;\n          Mode:Managed  Frequency:2.437 GHz  Access Point: A6:B5:89:FE:22:0D\n          Bit Rate=72.2 Mb/s   Tx-Power=31 dBm\n          Retry short limit:7   RTS thr:off   Fragment thr:off\n          Power Management:on\n          Link Quality=56/70  Signal level=-54 dBm\n          Rx invalid nwid:0  Rx invalid crypt:0  Rx invalid frag:0\n          Tx excessive retries:0  Invalid misc:0   Missed beacon:0\n\ntailscale0  no wireless extensions.\n\ndocker0   no wireless extensions.\n\nwlan1     IEEE 802.11  ESSID:&quot;Galaxy A32 gpmacario&quot;\n          Mode:Managed  Frequency:2.437 GHz  Access Point: A6:B5:89:FE:22:0D\n          Bit Rate=54 Mb/s   Tx-Power=20 dBm\n          Retry short limit:7   RTS thr:off   Fragment thr:off\n          Power Management:on\n          Link Quality=62/70  Signal level=-48 dBm\n          Rx invalid nwid:0  Rx invalid crypt:0  Rx invalid frag:0\n          Tx excessive retries:0  Invalid misc:21   Missed beacon:0\n\ngmacario@rpi3bgm28:~ $\n</code></pre>\n<p>Launch Kismet and configure it to use new Wi-Fi interface as datasource:</p>\n<pre><code class=\"language-bash\">kismet -c wlan1\n</code></pre>\n<p>Result:</p>\n<pre><code class=\"language-text\">gmacario@rpi3bgm28:~ $ kismet -c wlan1\nINFO: Including sub-config file: /etc/kismet/kismet_httpd.conf\nINFO: Including sub-config file: /etc/kismet/kismet_memory.conf\nINFO: Including sub-config file: /etc/kismet/kismet_alerts.conf\nINFO: Including sub-config file: /etc/kismet/kismet_80211.conf\nINFO: Including sub-config file: /etc/kismet/kismet_logging.conf\nINFO: Including sub-config file: /etc/kismet/kismet_filter.conf\nINFO: Including sub-config file: /etc/kismet/kismet_uav.conf\nINFO: Loading config override file &#39;/etc/kismet/kismet_package.conf&#39;\nINFO: Optional sub-config file not present: /etc/kismet/kismet_package.conf\nINFO: Loading config override file &#39;/etc/kismet/kismet_site.conf&#39;\nINFO: Optional sub-config file not present: /etc/kismet/kismet_site.conf\nKISMET - Point your browser to http://localhost:2501 (or the address of this system) for the INFO: Keeping EAPOL packets in memory for easy download and WIDS\n      functionality; this can use more RAM.\nINFO: Registered PHY handler &#39;IEEE802.11&#39; as ID 0\nINFO: Registered PHY handler &#39;RTL433&#39; as ID 1\nINFO: Registered PHY handler &#39;Z-Wave&#39; as ID 2\nINFO: Registered PHY handler &#39;Bluetooth&#39; as ID 3\nINFO: Registered PHY handler &#39;UAV&#39; as ID 4\nINFO: Registered PHY handler &#39;NrfMousejack&#39; as ID 5\nINFO: Using default rates of 10/min, 1/sec for alert &#39;BLEEDINGTOOTH&#39;\nINFO: Registered PHY handler &#39;BTLE&#39; as ID 6\nINFO: Registered PHY handler &#39;METER&#39; as ID 7\nINFO: Indexing ADSB ICAO db\nINFO: Completed indexing ADSB ICAO db, 322278 lines 6446 indexes\nINFO: Registered PHY handler &#39;ADSB&#39; as ID 8\nINFO: Registered PHY handler &#39;802.15.4&#39; as ID 9\nINFO: Registered PHY handler &#39;RADIATION&#39; as ID 10\nINFO: Serving static file content from /usr/share/kismet/httpd/\nINFO: Enabling channel hopping by default on sources which support channel\n      control.\nINFO: Setting default channel hop rate to 5/sec\nINFO: Enabling channel list splitting on sources which share the same list\n      of channels\nINFO: Enabling channel list shuffling to optimize overlaps\nINFO: Sources will be re-opened if they encounter an error\nINFO: Saving datasources to the Kismet database log every 30 seconds.\nINFO: Launching remote capture server on 127.0.0.1 3501\nINFO: Data sources passed on the command line (via -c source), ignoring\n      source= definitions in the Kismet config file.\nINFO: Probing interface &#39;wlan1&#39; to find datasource type\nINFO: Opened kismetdb log file &#39;.//Kismet-20230424-12-35-40-1.kismet&#39;\nINFO: Saving packets to the Kismet database log.\nINFO: GPS track will be logged to the Kismet logfile\nINFO: Starting Kismet web server...\nINFO: HTTP server listening on 0.0.0.0:2501\nINFO: Could not open system plugin directory (/usr/lib/kismet/), skipping:\n      No such file or directory\nINFO: Did not find a user plugin directory (/home/gmacario/.kismet//plugins\n      /), skipping: No such file or directory\nINFO: Found type &#39;linuxwifi&#39; for &#39;wlan1&#39;\nINFO: wlan1 bringing down parent interface &#39;wlan1&#39;\nINFO: wlan1 finished configuring wlan1mon, ready to capture\nINFO: Data source &#39;wlan1&#39; launched successfully\n</code></pre>\n<p>Browse <a href=\"http://rpi3bgm28:2501\">http://rpi3bgm28:2501</a> to access Kismet web UI.</p>\n<p>The first time you access the web UI you the following dialog box will be displayed:</p>\n<blockquote>\n<p><strong>Set Login</strong></p>\n<p>To finish setting up Kismet, you need to configure a login.</p>\n<p>This login will be stored in <code>.kismet/kismet_httpd.conf</code> in the\n<em>home directory of the user who launched Kismet</em>;\nThis server is running as gmacario, and the login will be saved\nin <code>~gmacario/.kismet/kismet_httpd.conf</code>.</p>\n<p>Set Login</p>\n<ul>\n<li>User name: TODO</li>\n<li>Password: TODO</li>\n<li>Confirm: TODO</li>\n</ul>\n</blockquote>\n<p>Fill in the requested information, then click &quot;Save&quot;.</p>\n<blockquote>\n<p><strong>Welcome</strong></p>\n<p>Welcome!</p>\n<p>This is the first time you&#39;ve used this Kismet server in this browser.</p>\n<p>Kismet stores local settings in the HTML5 storage of your browser.</p>\n<p>You should configure your preferences and login settings in the settings panel!</p>\n<p>Settings | Continue</p>\n</blockquote>\n<!-- TODO -->\n\n<h3 id=\"runtime-censorship\">Runtime censorship</h3>\n<p>Kismet can be configured to censor some information - such as the last digits of MAC address or SSID - displayed in the web UI, in order to make it easier to share screenshots or demos without revealing sensitive data.</p>\n<p>Censorship mode can be enabled by adding <code>?censor=1</code> to Kismet URL, for instance\n<a href=\"http://localhost:2501/?censor=1\">http://localhost:2501/?censor=1</a> or <a href=\"http://rpi3bgm28:2501/?censor=1\">http://rpi3bgm28:2501/?censor=1</a></p>\n<!-- TODO: Screenshot -->\n\n<p>Reference: <a href=\"https://www.kismetwireless.net/docs/readme/configuring/webserver/\">https://www.kismetwireless.net/docs/readme/configuring/webserver/</a></p>\n<!--\nTODO: Try enabling Data Source hci0\n(should not be connected via wlab0, though)\n\nSee also:\n- <https://www.kismetwireless.net/docs/readme/datasources/datasources/>\n- <https://www.kismetwireless.net/docs/readme/datasources/bluetooth-hci-bluetooth/>\n\nKismet web UI: Data Sources > TODO\n\nkismet -c hci0\n-->\n\n<h3 id=\"export-kismet-files-to-pcap\">Export <code>*.kismet</code> files to <code>*.pcap</code></h3>\n<pre><code class=\"language-bash\">gmacario@rpi3bgm28:~ $ kismetdb_to_pcap \\\n    --in Kismet-20230424-12-57-23-1.kismet \\\n    --out Kismet-20230424-12-57-23-1.kismet.pcap\nDone...\ngmacario@rpi3bgm28:~ $ ls -la Kismet-20230424-12-57-23-1.kismet*\n-rw-r--r-- 1 gmacario gmacario 9347072 Apr 24 15:17 Kismet-20230424-12-57-23-1.kismet\n-rw-r--r-- 1 gmacario gmacario 3575696 Apr 24 15:17 Kismet-20230424-12-57-23-1.kismet.pcap\ngmacario@rpi3bgm28:~ $\n</code></pre>\n<p>You may then open the generated <code>*.pcap</code> file using a suitable tool, for instance <a href=\"https://www.wireshark.org/\">Wireshark</a>.</p>\n<!-- TODO: Screenshot -->\n\n<h3 id=\"recovering-lost-passwords\">Recovering lost passwords</h3>\n<p>After converting <code>*.kismet</code> to <code>*.pcap</code> using the <code>kismetdb_to_pcap</code> tool,\nbrowse <a href=\"https://hashcat.net/cap2hashcat/\">https://hashcat.net/cap2hashcat/</a> and upload the <code>*.pcap</code> file.</p>\n<p>The tool will verify the <code>*.pcap</code> file and convert it to a format\nsuitable for the <a href=\"https://hashcat.net/hashcat/\">hashcat</a> tool.</p>\n<!-- TODO -->\n\n<h2 id=\"see-also\">See also</h2>\n<ul>\n<li><a href=\"https://www.linkielist.com/hacks/wpa-cracking-from-kismet-sensors/\">WPA Cracking from Kismet sensors</a> - Linkielist.com, 2020-03-25</li>\n<li><a href=\"https://www.freecodecamp.org/news/wireless-security-using-raspberry-pi-4-kismet-and-python/\">How to Secure Your Home Wireless Infrastructure with Kismet and Python</a> - Jose Vicente Nunez on freeCodeCamp, 2022-03-02</li>\n</ul>\n<!-- EOF -->\n"},"config":{"title":"gmacario.github.io","description":"Gianpaolo Macario's public rants","social":{"github":{"name":"gmacario","link":"https://github.com/gmacario"},"twitter":{"name":"gpmacario","link":"https://www.twitter.com/gpmacario"}}}},"__N_SSG":true}