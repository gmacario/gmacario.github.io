{"pageProps":{"post":{"title":"Trying Kali Linux 2.1.2 on a Raspberry Pi 3","content":"<!-- markdown-link-check-disable -->\n\n<p>This blog post explains my experiences with <a href=\"http://www.kali.org/\">Kali Linux 2.1.2</a> on a <a href=\"https://www.raspberrypi.org/products/raspberry-pi-3-model-b/\">Raspberry Pi 3 Model B</a>.</p>\n<p>Following instructions at YouTube Video: <a href=\"https://www.youtube.com/watch?v=6xXnUGR_e4E\">Kali Linux on Raspberry Pi 3</a> (8:11)</p>\n<h3 id=\"format-microsd-card-with-kali-linux-image-for-rpi-2--3\">Format MicroSD-card with Kali Linux image for RPi 2 / 3</h3>\n<p>Browse <a href=\"https://www.kali.org/\">https://www.kali.org/</a> &gt; Downloads &gt; Kali ARM images</p>\n<p>Choose Kali image for RaspberryPi 2 / 3</p>\n<ul>\n<li>Size: 1166M</li>\n<li>Version: 2.1.2</li>\n<li>SHA1Sum: DB36FCD53C630FD32F2F8943DDDD9F57B3673C5A</li>\n</ul>\n<p>Verify checksum of the downloaded image</p>\n<pre><code>gmacario@ITM-GPAOLO-W10 ~\n$ sha1sum.exe /cygdrive/d/data/public/Linux/Kali/kali-2.1.2-rpi2.img.xz\ndb36fcd53c630fd32f2f8943dddd9f57b3673c5a */cygdrive/d/data/public/Linux/Kali/kali-2.1.2-rpi2.img.xz\n\ngmacario@ITM-GPAOLO-W10 ~\n$\n</code></pre>\n<p>Uncompress the downloaded image</p>\n<pre><code>xzcat kali-2.1.2-rpi2.img.xz &gt;kali-2.1.2-rpi2.img\n</code></pre>\n<p>Launch <a href=\"https://sourceforge.net/projects/win32diskimager/\">Win32 Disk Imager</a></p>\n<p>Write image <code>kali-2.1.2-rpi2.img</code> to an empty MicroSD-card (16 GB or bigger)</p>\n<!-- 2017-01-09 18:45 CET -->\n\n<p>Insert your MicroSD-card into the RPi, then power up the board.</p>\n<p>Login as user <code>root</code> (default password: <code>toor</code>).</p>\n<p><strong>IMPORTANT</strong>: Change default password now!</p>\n<pre><code>root@kali:~# passwd\nEnter new UNIX password:\nRetype new UNIX password:\npasswd: password updated successfully\nroot@kali:~#\n</code></pre>\n<p>Regenerate SSH Host Key (they were pre-configured on the downloaded images)</p>\n<pre><code>rm /etc/ssh/ssh_host_*\ndpkg-reconfigure openssh-server\nservice ssh restart\n</code></pre>\n<p>Type <code>ip address</code> to know the assigned IP address (in my example, this is <code>192.168.64.114</code>). Alternatively, use the <a href=\"https://www2.fing.io/\">Fing</a> App from an Android phone connected to the same Wireless Access Point.</p>\n<p>Login from another machine with the following command: <code>ssh root@kali.lan</code>\nor by specifying the target IP address:</p>\n<pre><code>gmacario@ITM-GPAOLO-W10 ~\n$ ssh root@192.168.64.114\nroot@192.168.64.114&#39;s password:\n\nThe programs included with the Kali GNU/Linux system are free software;\nthe exact distribution terms for each program are described in the\nindividual files in /usr/share/doc/*/copyright.\n\nKali GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent\npermitted by applicable law.\nLast login: Mon Jan  9 15:19:54 2017 from 192.168.64.112\nroot@kali:~#\n</code></pre>\n<h3 id=\"install-vnc-server-on-kali-linux\">Install VNC Server on Kali Linux</h3>\n<p>Watch YouTube video: <a href=\"https://www.youtube.com/watch?v=ZR-ztmJ7mks\">How to Remote Access Linux on Raspberry Pi 2</a> (17:13)</p>\n<p>NOTE: As of 2017-01-19 Kali Linux <code>tightvncserver</code> is a transitional package - will try <a href=\"http://tigervnc.org/\">TigerVNC</a> instead.</p>\n<pre><code>apt-get update\napt-get -y install tigervnc-common tigervnc-standalone-server\napt-get -y install autocutsel\n</code></pre>\n<p>Type <code>vncpasswd</code> to create session password (will be saved in <code>~/.vnc/passwd</code>)</p>\n<p>Create systemd unit file <code>/etc/systemd/system/vncserver.service</code></p>\n<pre><code>[Unit]\nDescription=VNC remote desktop server\nAfter=sshd.service\n\n[Service]\nType=dbus\nExecStart=/usr/bin/vncserver -localhost no\nUser=root\nType=forking\n\n[Install]\nWantedBy=multi-user.target\n</code></pre>\n<p><strong>NOTE</strong>: Added option <code>-localhost no</code> to allow VNC connections from outside (default is only from localhost, needs to setup a SSH tunnel). This is relaxing security, though.</p>\n<p>Adjust file owner and permissions</p>\n<pre><code>sudo chown root:root /etc/systemd/system/vncserver.service\nsudo chmod 644 /etc/systemd/system/vncserver.service\n</code></pre>\n<p>Test</p>\n<pre><code>sudo systemctl start vncserver\nsudo systemctl enable vncserver\n</code></pre>\n<p>Verify that the server is running</p>\n<pre><code>sudo systemctl status vncserver\nvncserver -list\n</code></pre>\n<p>From another machine (i.e. a laptop) launch TigerVNC Viewer</p>\n<ul>\n<li>Remote Host: <code>kali.lan:5901</code></li>\n<li>Password: <code>xxxx</code> (the password chosen when first running <code>vncserver</code> )</li>\n</ul>\n<p><strong>Issue 1</strong>: Cannot launch Wireshark</p>\n<pre><code>root@kali:~# wireshark\nUnable to find an X11 visual which matches EGL config 1\nSegmentation fault\nroot@kali:!#\n</code></pre>\n<p><strong>Issue 2</strong>: Copy-and-paste does not seem to work (it worked with tightvncserver)</p>\n<h3 id=\"resize-root-partition\">Resize Root Partition</h3>\n<p>Logged as <a href=\"mailto:&#x72;&#111;&#x6f;&#116;&#64;&#107;&#x61;&#108;&#105;&#46;&#x6c;&#x61;&#x6e;\">&#x72;&#111;&#x6f;&#116;&#64;&#107;&#x61;&#108;&#105;&#46;&#x6c;&#x61;&#x6e;</a></p>\n<pre><code>apt-get -y install gparted\n</code></pre>\n<p>Then type <code>gparted</code> and resize the partition to use all the available space on the MicroSD.</p>\n<h3 id=\"install-all-kali-linux-tools\">Install all Kali Linux tools</h3>\n<pre><code>apt-get install kali-linux-full\n</code></pre>\n<p><strong>NOTE</strong>: Depending on network speed, the above command may take a few hours to complete</p>\n<h3 id=\"links\">Links</h3>\n<ul>\n<li>Kali Linux: <a href=\"https://kali.org/\">https://kali.org/</a></li>\n<li>Metasploitable 2: <a href=\"https://sourceforge.net/projects/metasploitable/files/Metasploitable2/\">https://sourceforge.net/projects/metasploitable/files/Metasploitable2/</a></li>\n<li>Rasbperry Pi 3: <a href=\"http://goo.gl/T1NJ2D\">http://goo.gl/T1NJ2D</a></li>\n</ul>\n<!-- markdown-link-check-enable -->\n<!-- EOF -->\n"},"config":{"title":"gmacario.github.io","description":"Gianpaolo Macario's public rants","social":{"github":{"name":"gmacario","link":"https://github.com/gmacario"},"twitter":{"name":"gpmacario","link":"https://www.twitter.com/gpmacario"}}}},"__N_SSG":true}