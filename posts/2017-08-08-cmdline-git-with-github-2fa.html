<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><meta name="description" content="Gianpaolo Macario&#x27;s public rants"/><title>Using command-line git with GitHub 2FA</title><meta name="next-head-count" content="4"/><link rel="preload" href="/_next/static/css/08fafe92abad983f984c.css" as="style"/><link rel="stylesheet" href="/_next/static/css/08fafe92abad983f984c.css" data-n-g=""/><noscript data-n-css=""></noscript><link rel="preload" href="/_next/static/chunks/webpack-50bee04d1dc61f8adf5b.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework.1a5e6c0bcaecf178eee2.js" as="script"/><link rel="preload" href="/_next/static/chunks/commons.a817edd9b2693fcc6af8.js" as="script"/><link rel="preload" href="/_next/static/chunks/main-daaff4f95c13923f49a5.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/_app-041b1432faef8bf5f62a.js" as="script"/><link rel="preload" href="/_next/static/chunks/b38cc82cec06c0ea8b096def674947a423bb2764.260eb1ac110a53311620.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/posts/%5Bslug%5D-1c9a30b06d2f3be2ac9c.js" as="script"/></head><body><div id="__next"><main class="h-screen flex flex-col"><header class="py-3 fixed top-0 z-50 flex flex-wrap justify-between w-screen bg-white border-b border-gray-200"><div class="mx-3 py-2 px-4  font-bold text-indigo-500">Gianpaolo Macario&#x27;s blog</div><div class="justify-end"><a class="mr-6 py-2 px-4 inline-block rounded h-full text-indigo-500 hover:text-white hover:bg-indigo-500" href="/">Home</a><a class="mr-6 py-2 px-4 inline-block rounded h-full text-indigo-500 hover:text-white hover:bg-indigo-500" href="/posts">Posts</a></div></header><div class="pt-28 mx-auto w-5/6 break-words flex flex-grow prose prose-indigo hover:prose-black md:prose-lg lg:prose-xl"><article><h1>Using command-line git with GitHub 2FA</h1><div class="prose prose-indigo hover:prose-black md:prose-lg lg:prose-xl"><!-- markdown-link-check-disable -->

<p>After enabling <a href="https://help.github.com/articles/securing-your-account-with-two-factor-authentication-2fa/">two-factor authentication on my GitHub account</a> it seemed I became unable to push my local repositories from command-line git using the https transport.</p>
<p>I was simply wrong, here what I did to fix the issue.</p>
<h3 id="create-a-personal-access-token">Create a Personal Access Token</h3>
<p>Two-factor authentication in GitHub works by replacing your GitHub password with a Personal Access Token which can be different depending on the application you want to enable.</p>
<p>To create a Personal Access Token, browse <a href="https://github.com/settings/tokens">https://github.com/settings/tokens</a>, then click &quot;Generate new token&quot;.</p>
<ul>
<li>Provide a Token description, i.e. &quot;git @my-linux-laptop&quot;</li>
<li>Select scopes. Select &quot;repo&quot; to have full control of private repositories</li>
<li>Click &quot;Generate token&quot;</li>
</ul>
<p>Now from the command line perform some actions which require user authentication, for instance clone a private repository</p>
<pre><code class="language-shell">git clone https://github.com/myuser/my-private-repo
</code></pre>
<p>Alternatively, clone (via https) a repository you own, then commit a simple change and do <code>git push</code>.</p>
<p>In either case git will request your GitHub credentials before proceeding.</p>
<p>When requested for &quot;Username&quot; type your GitHub username (in my case, &quot;gmacario&quot;):</p>
<pre><code>vagrant@ch1:~/github/gmacario/my-secret-repo$ git push -u origin master
Username for &#39;https://github.com&#39;: gmacario
Password for &#39;https://gmacario@github.com&#39;:
</code></pre>
<p>On the other hand, when requested for Password, DO NOT type your GitHub password.
Instead, click the &quot;copy&quot; icon on the GitHub setting page, then paste your newly created Personal access token instead.</p>
<h3 id="enable-git-credentials-cache-recommended">Enable Git credentials cache (recommended)</h3>
<p>To avoid providing the same credentials every time, you may enable the Git credentials cache through the following command:</p>
<pre><code class="language-shell">git config --global credential.helper cache
</code></pre>
<p>Through this configuration a daemon will be run to cache the provided credentials and avoid the user to be requested again.</p>
<p>The default cache expiry timeout is 900 seconds (15 minutes) and can be changed with the <code>--timeout</code> option as follows:</p>
<pre><code class="language-shell">git config --global credential.helper &#39;cache --timeout=300&#39;
</code></pre>
<p>If you want the daemon to exit early, forgetting all cached credentials before their timeout, you can issue an exit action:</p>
<pre><code class="language-shell">git credential-cache exit
</code></pre>
<h3 id="alternative-enable-git-credentials-store">Alternative: Enable Git credentials store</h3>
<p>A less secure but more convenient way for saving your credentials is enabling the git-credential-store through the following command</p>
<pre><code class="language-shell">git config credential.helper store
</code></pre>
<p><strong>NOTE</strong>: The credentials will be saved unencrypted on a file inside your home directory, therefore use it with discretion.</p>
<h3 id="see-also">See also</h3>
<ul>
<li><a href="https://help.github.com/articles/providing-your-2fa-authentication-code/">https://help.github.com/articles/providing-your-2fa-authentication-code/</a></li>
<li><a href="https://git-scm.com/docs/git-credential-cache">https://git-scm.com/docs/git-credential-cache</a></li>
<li><a href="https://git-scm.com/docs/git-credential-store">https://git-scm.com/docs/git-credential-store</a></li>
</ul>
<!-- markdown-link-check-enable -->
<!-- EOF -->
</div></article></div><footer class="h-auto mt-20 bg-gray-100 justify-between border-t border-gray-200"><div class="pt-6 mx-auto  gap-x-6 w-9/12 flex flex-col prose prose-indigo hover:prose-black md:prose-lg lg:prose-xl"><div class="prose-xl"><p class="">gmacario.github.io</p></div><div class="flex flex-col sm:flex-row flex-wrap justify-between md:justify-start"><p class="mr-12 text-gray-600 prose-sm">gmacario.github.io</p><div class="mr-12 flex flex-col justify-start"><p class="text-gray-600 prose-sm flex flex-row"><svg class="MuiSvgIcon-root mr-2" focusable="false" viewBox="0 0 24 24" aria-hidden="true"><path d="M12 .3a12 12 0 0 0-3.8 23.4c.6.1.8-.3.8-.6v-2c-3.3.7-4-1.6-4-1.6-.6-1.4-1.4-1.8-1.4-1.8-1-.7.1-.7.1-.7 1.2 0 1.9 1.2 1.9 1.2 1 1.8 2.8 1.3 3.5 1 0-.8.4-1.3.7-1.6-2.7-.3-5.5-1.3-5.5-6 0-1.2.5-2.3 1.3-3.1-.2-.4-.6-1.6 0-3.2 0 0 1-.3 3.4 1.2a11.5 11.5 0 0 1 6 0c2.3-1.5 3.3-1.2 3.3-1.2.6 1.6.2 2.8 0 3.2.9.8 1.3 1.9 1.3 3.2 0 4.6-2.8 5.6-5.5 5.9.5.4.9 1 .9 2.2v3.3c0 .3.1.7.8.6A12 12 0 0 0 12 .3"></path></svg><a href="https://github.com/gmacario">gmacario</a></p><p class="text-gray-600 prose-sm flex flex-row"><svg class="MuiSvgIcon-root mr-2" focusable="false" viewBox="0 0 24 24" aria-hidden="true"><path d="M22.46 6c-.77.35-1.6.58-2.46.69.88-.53 1.56-1.37 1.88-2.38-.83.5-1.75.85-2.72 1.05C18.37 4.5 17.26 4 16 4c-2.35 0-4.27 1.92-4.27 4.29 0 .34.04.67.11.98C8.28 9.09 5.11 7.38 3 4.79c-.37.63-.58 1.37-.58 2.15 0 1.49.75 2.81 1.91 3.56-.71 0-1.37-.2-1.95-.5v.03c0 2.08 1.48 3.82 3.44 4.21a4.22 4.22 0 0 1-1.93.07 4.28 4.28 0 0 0 4 2.98 8.521 8.521 0 0 1-5.33 1.84c-.34 0-.68-.02-1.02-.06C3.44 20.29 5.7 21 8.12 21 16 21 20.33 14.46 20.33 8.79c0-.19 0-.37-.01-.56.84-.6 1.56-1.36 2.14-2.23z"></path></svg><a href="https://www.twitter.com/gpmacario">gpmacario</a></p></div><p class="mr-12 text-gray-600 prose-sm">Gianpaolo Macario&#x27;s public rants</p></div></div></footer></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"Using command-line git with GitHub 2FA","content":"\u003c!-- markdown-link-check-disable --\u003e\n\n\u003cp\u003eAfter enabling \u003ca href=\"https://help.github.com/articles/securing-your-account-with-two-factor-authentication-2fa/\"\u003etwo-factor authentication on my GitHub account\u003c/a\u003e it seemed I became unable to push my local repositories from command-line git using the https transport.\u003c/p\u003e\n\u003cp\u003eI was simply wrong, here what I did to fix the issue.\u003c/p\u003e\n\u003ch3 id=\"create-a-personal-access-token\"\u003eCreate a Personal Access Token\u003c/h3\u003e\n\u003cp\u003eTwo-factor authentication in GitHub works by replacing your GitHub password with a Personal Access Token which can be different depending on the application you want to enable.\u003c/p\u003e\n\u003cp\u003eTo create a Personal Access Token, browse \u003ca href=\"https://github.com/settings/tokens\"\u003ehttps://github.com/settings/tokens\u003c/a\u003e, then click \u0026quot;Generate new token\u0026quot;.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eProvide a Token description, i.e. \u0026quot;git @my-linux-laptop\u0026quot;\u003c/li\u003e\n\u003cli\u003eSelect scopes. Select \u0026quot;repo\u0026quot; to have full control of private repositories\u003c/li\u003e\n\u003cli\u003eClick \u0026quot;Generate token\u0026quot;\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eNow from the command line perform some actions which require user authentication, for instance clone a private repository\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-shell\"\u003egit clone https://github.com/myuser/my-private-repo\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eAlternatively, clone (via https) a repository you own, then commit a simple change and do \u003ccode\u003egit push\u003c/code\u003e.\u003c/p\u003e\n\u003cp\u003eIn either case git will request your GitHub credentials before proceeding.\u003c/p\u003e\n\u003cp\u003eWhen requested for \u0026quot;Username\u0026quot; type your GitHub username (in my case, \u0026quot;gmacario\u0026quot;):\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003evagrant@ch1:~/github/gmacario/my-secret-repo$ git push -u origin master\nUsername for \u0026#39;https://github.com\u0026#39;: gmacario\nPassword for \u0026#39;https://gmacario@github.com\u0026#39;:\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eOn the other hand, when requested for Password, DO NOT type your GitHub password.\nInstead, click the \u0026quot;copy\u0026quot; icon on the GitHub setting page, then paste your newly created Personal access token instead.\u003c/p\u003e\n\u003ch3 id=\"enable-git-credentials-cache-recommended\"\u003eEnable Git credentials cache (recommended)\u003c/h3\u003e\n\u003cp\u003eTo avoid providing the same credentials every time, you may enable the Git credentials cache through the following command:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-shell\"\u003egit config --global credential.helper cache\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThrough this configuration a daemon will be run to cache the provided credentials and avoid the user to be requested again.\u003c/p\u003e\n\u003cp\u003eThe default cache expiry timeout is 900 seconds (15 minutes) and can be changed with the \u003ccode\u003e--timeout\u003c/code\u003e option as follows:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-shell\"\u003egit config --global credential.helper \u0026#39;cache --timeout=300\u0026#39;\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eIf you want the daemon to exit early, forgetting all cached credentials before their timeout, you can issue an exit action:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-shell\"\u003egit credential-cache exit\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"alternative-enable-git-credentials-store\"\u003eAlternative: Enable Git credentials store\u003c/h3\u003e\n\u003cp\u003eA less secure but more convenient way for saving your credentials is enabling the git-credential-store through the following command\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-shell\"\u003egit config credential.helper store\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cstrong\u003eNOTE\u003c/strong\u003e: The credentials will be saved unencrypted on a file inside your home directory, therefore use it with discretion.\u003c/p\u003e\n\u003ch3 id=\"see-also\"\u003eSee also\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://help.github.com/articles/providing-your-2fa-authentication-code/\"\u003ehttps://help.github.com/articles/providing-your-2fa-authentication-code/\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://git-scm.com/docs/git-credential-cache\"\u003ehttps://git-scm.com/docs/git-credential-cache\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://git-scm.com/docs/git-credential-store\"\u003ehttps://git-scm.com/docs/git-credential-store\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c!-- markdown-link-check-enable --\u003e\n\u003c!-- EOF --\u003e\n"},"config":{"title":"gmacario.github.io","description":"Gianpaolo Macario's public rants","social":{"github":{"name":"gmacario","link":"https://github.com/gmacario"},"twitter":{"name":"gpmacario","link":"https://www.twitter.com/gpmacario"}}}},"__N_SSG":true},"page":"/posts/[slug]","query":{"slug":"2017-08-08-cmdline-git-with-github-2fa"},"buildId":"cDPC9yw5u24h96f3B2HVu","runtimeConfig":{},"isFallback":false,"gsp":true}</script><script nomodule="" src="/_next/static/chunks/polyfills-144e5fa6fafab6397d9c.js"></script><script src="/_next/static/chunks/webpack-50bee04d1dc61f8adf5b.js" async=""></script><script src="/_next/static/chunks/framework.1a5e6c0bcaecf178eee2.js" async=""></script><script src="/_next/static/chunks/commons.a817edd9b2693fcc6af8.js" async=""></script><script src="/_next/static/chunks/main-daaff4f95c13923f49a5.js" async=""></script><script src="/_next/static/chunks/pages/_app-041b1432faef8bf5f62a.js" async=""></script><script src="/_next/static/chunks/b38cc82cec06c0ea8b096def674947a423bb2764.260eb1ac110a53311620.js" async=""></script><script src="/_next/static/chunks/pages/posts/%5Bslug%5D-1c9a30b06d2f3be2ac9c.js" async=""></script><script src="/_next/static/cDPC9yw5u24h96f3B2HVu/_buildManifest.js" async=""></script><script src="/_next/static/cDPC9yw5u24h96f3B2HVu/_ssgManifest.js" async=""></script></body></html>