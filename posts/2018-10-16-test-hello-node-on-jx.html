<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><meta name="description" content="Gianpaolo Macario&#x27;s public rants"/><title>Deploying a Node.JS application on Kubernetes using Jenkins X</title><meta name="next-head-count" content="4"/><link rel="preload" href="/_next/static/css/08fafe92abad983f984c.css" as="style"/><link rel="stylesheet" href="/_next/static/css/08fafe92abad983f984c.css" data-n-g=""/><noscript data-n-css=""></noscript><link rel="preload" href="/_next/static/chunks/webpack-50bee04d1dc61f8adf5b.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework.1a5e6c0bcaecf178eee2.js" as="script"/><link rel="preload" href="/_next/static/chunks/commons.a817edd9b2693fcc6af8.js" as="script"/><link rel="preload" href="/_next/static/chunks/main-daaff4f95c13923f49a5.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/_app-041b1432faef8bf5f62a.js" as="script"/><link rel="preload" href="/_next/static/chunks/b38cc82cec06c0ea8b096def674947a423bb2764.260eb1ac110a53311620.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/posts/%5Bslug%5D-1c9a30b06d2f3be2ac9c.js" as="script"/></head><body><div id="__next"><main class="h-screen flex flex-col"><header class="py-3 fixed top-0 z-50 flex flex-wrap justify-between w-screen bg-white border-b border-gray-200"><div class="mx-3 py-2 px-4  font-bold text-indigo-500">Gianpaolo Macario&#x27;s blog</div><div class="justify-end"><a class="mr-6 py-2 px-4 inline-block rounded h-full text-indigo-500 hover:text-white hover:bg-indigo-500" href="/">Home</a><a class="mr-6 py-2 px-4 inline-block rounded h-full text-indigo-500 hover:text-white hover:bg-indigo-500" href="/posts">Posts</a></div></header><div class="pt-28 mx-auto w-5/6 break-words flex flex-grow prose prose-indigo hover:prose-black md:prose-lg lg:prose-xl"><article><h1>Deploying a Node.JS application on Kubernetes using Jenkins X</h1><div class="prose prose-indigo hover:prose-black md:prose-lg lg:prose-xl"><!-- markdown-link-check-disable -->

<h3 id="introduction">Introduction</h3>
<p>This article explains how to deploy a simple <a href="https://nodejs.org/">Node.JS</a> application on a <a href="https://kubernetes.io/">Kubernetes</a> cluster using <a href="https://jenkins-x.io/">Jenkins X</a>.</p>
<p>This post is the follow-up to my previous article <a href="https://gmacario.github.io/howto/kubernetes/gcp/jenkins/2018/10/09/install-jenkinsx-on-gcp.html">Installing Jenkins X on Google Cloud Platform</a>.</p>
<p>The following instructions have been tested on host &quot;nemo&quot; (Ubuntu 18.04.1 LTS 64-bit).</p>
<p>We will create our sample application using Jenkins X Quickstart. Quickstarts are pre-made applications you can start a project from, instead of starting from scratch.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://jenkins-x.io/getting-started/">https://jenkins-x.io/getting-started/</a></li>
<li><a href="https://gmacario.github.io/howto/kubernetes/gcp/jenkins/2018/10/09/install-jenkinsx-on-gcp.html">https://gmacario.github.io/howto/kubernetes/gcp/jenkins/2018/10/09/install-jenkinsx-on-gcp.html</a></li>
</ul>
<h3 id="prerequisites">Prerequisites</h3>
<ul>
<li>The <code>jx</code> binary is installed and available from your shell</li>
<li>Jenkins X properly configured</li>
</ul>
<p>Browse <a href="https://console.cloud.google.com/">https://console.cloud.google.com/</a></p>
<p>Select the proper GCP project (in our case, <code>kubernetes-workshop-218213</code>)</p>
<p>Click on the &quot;Activate Cloud Shell&quot; icon.</p>
<h4 id="reinstalling-the-jx-binary">Reinstalling the <code>jx</code> binary</h4>
<!-- 2018-10-15 12:21 CEST -->

<p>Type the following commands in case the <code>jx</code> command was not properly installed:</p>
<pre><code class="language-shell">mkdir -p ~/.jx/bin
curl -L \
  https://github.com/jenkins-x/jx/releases/download/v1.3.431/jx-linux-amd64.tar.gz \
  | tar xzv -C ~/.jx/bin
export PATH=$PATH:~/.jx/bin
echo &#39;export PATH=$PATH:~/.jx/bin&#39; &gt;&gt; ~/.bashrc
</code></pre>
<h4 id="verify-that-jx-is-correctly-configured">Verify that jx is correctly configured</h4>
<!-- 2018-10-15 16:17 CEST -->

<pre><code class="language-shell">jx status
</code></pre>
<p>Expected output:</p>
<pre><code>gmacario@cloudshell:~ (kubernetes-workshop-218213)$ jx status
Jenkins X checks passed for Cluster(gke_kubernetes-workshop-218213_europe-west1-b_howlernoon): 3 nodes, memory 15% of 17354292Ki, cpu 41% of 5790m. Jenkins is running at http://jenkins.jx.35.195.140.178.nip.io
gmacario@cloudshell:~ (kubernetes-workshop-218213)$
</code></pre>
<!-- 2018-10-15 16:18 CEST -->

<pre><code class="language-shell">jx diagnose
</code></pre>
<p>Expected output:</p>
<pre><code>gmacario@cloudshell:~ (kubernetes-workshop-218213)$ jx diagnose
Running in namespace: jx
Jenkins X Version:
 Using helmBinary helm with feature flag: none
NAME               VERSION
jx                 1.3.431
jenkins x platform 0.0.2765
Kubernetes cluster v1.9.7-gke.6
kubectl            v1.10.7
helm client        v2.10.0+g9ad53aa
helm server        v2.10.0+g9ad53aa
git                git version 2.11.0

Jenkins X Status:
 Jenkins X checks passed for Cluster(gke_kubernetes-workshop-218213_europe-west1-b_howlernoon): 3 nodes, memory 15% of 17354292Ki, cpu 41% of 5790m. Jenkins is running at http://jenkins.jx.35.195.140.178.nip.io

Kubernetes PVCs:
 NAME                        STATUS    VOLUME                                     CAPACITY   ACCESS MODES   STORAGECLASS   AGE
jenkins                     Bound     pvc-59d7abdc-d065-11e8-8172-42010a8401ee   30Gi       RWO            standard       3h
jenkins-x-chartmuseum       Bound     pvc-59d670d0-d065-11e8-8172-42010a8401ee   8Gi        RWO            standard       3h
jenkins-x-docker-registry   Bound     pvc-59d72bce-d065-11e8-8172-42010a8401ee   100Gi      RWO            standard       3h
jenkins-x-mongodb           Bound     pvc-59d90e70-d065-11e8-8172-42010a8401ee   8Gi        RWO            standard       3h
jenkins-x-nexus             Bound     pvc-59da88d9-d065-11e8-8172-42010a8401ee   8Gi        RWO            standard       3h

Kubernetes Pods:
 NAME                                            READY     STATUS    RESTARTS   AGE
jenkins-5dcf5bcd85-7xflw                        1/1       Running   0          3h
jenkins-x-chartmuseum-645d78c798-fckz4          1/1       Running   0          3h
jenkins-x-controllerteam-858ff8c6b8-m728p       1/1       Running   0          3h
jenkins-x-controllerworkflow-595d54767-fqvqd    1/1       Running   0          3h
jenkins-x-docker-registry-dcb6d6d44-2xcvn       1/1       Running   0          3h
jenkins-x-heapster-96bd95dcf-kdgjj              2/2       Running   0          3h
jenkins-x-mongodb-968b595dd-ngjpg               1/1       Running   1          3h
jenkins-x-monocular-api-6cff5d65df-9wwgq        1/1       Running   2          3h
jenkins-x-monocular-prerender-6d8897856-dx4kq   1/1       Running   0          3h
jenkins-x-monocular-ui-6b7645b67-w8qt6          1/1       Running   0          3h
jenkins-x-nexus-55f87888dc-b5l59                1/1       Running   0          3h

Kubernetes Ingresses:
 NAME              HOSTS                                      ADDRESS          PORTS     AGE
chartmuseum       chartmuseum.jx.35.195.140.178.nip.io       35.233.119.214   80        3h
docker-registry   docker-registry.jx.35.195.140.178.nip.io   35.233.119.214   80        3h
jenkins           jenkins.jx.35.195.140.178.nip.io           35.233.119.214   80        3h
monocular         monocular.jx.35.195.140.178.nip.io         35.233.119.214   80        3h
nexus             nexus.jx.35.195.140.178.nip.io             35.233.119.214   80        3h

Kubernetes Secrets:
 NAME                                       TYPE                                  DATA      AGE
cleanup-token-bql7k                        kubernetes.io/service-account-token   3         3h
default-token-g42q9                        kubernetes.io/service-account-token   3         3h
expose-token-6dlll                         kubernetes.io/service-account-token   3         3h
jenkins                                    Opaque                                3         3h
jenkins-docker-cfg                         Opaque                                1         3h
jenkins-git-credentials                    Opaque                                1         3h
jenkins-git-ssh                            Opaque                                2         3h
jenkins-hub-api-token                      Opaque                                1         3h
jenkins-maven-settings                     Opaque                                1         3h
jenkins-npm-token                          Opaque                                1         3h
jenkins-release-gpg                        Opaque                                4         3h
jenkins-ssh-config                         Opaque                                1         3h
jenkins-token-929mw                        kubernetes.io/service-account-token   3         3h
jenkins-x-chartmuseum                      Opaque                                2         3h
jenkins-x-controllerteam-token-m4dsz       kubernetes.io/service-account-token   3         3h
jenkins-x-controllerworkflow-token-vbzsm   kubernetes.io/service-account-token   3         3h
jenkins-x-docker-registry-secret           Opaque                                1         3h
jenkins-x-mongodb                          Opaque                                1         3h
jx-basic-auth                              Opaque                                1         3h
jx-install-config                          Opaque                                3         3h
jx-pipeline-git-github-github              Opaque                                2         3h
nexus                                      Opaque                                1         3h

Please visit https://jenkins-x.io/faq/issues/ for any known issues.
Finished printing diagnostic information.
gmacario@cloudshell:~ (kubernetes-workshop-218213)$
</code></pre>
<h3 id="create-quickstart-application-node-http-hmi-repository">Create quickstart application <code>node-http-hmi-repository</code></h3>
<!-- 2018-10-12 16:51CEST -->

<p>Reference: <a href="https://jenkins-x.io/developing/create-quickstart/">https://jenkins-x.io/developing/create-quickstart/</a></p>
<p>Logged as <code>gmacario@cloudshell</code></p>
<pre><code class="language-shell">jx create quickstart
</code></pre>
<p>Result</p>
<pre><code>gmacario@cloudshell:~ (kubernetes-workshop-218213)$ jx create quickstart
? select the quickstart you wish to create  [Use arrows to move, type to filter]
&gt; android-quickstart
  angular-io-quickstart
  aspnet-app
  dlang-http
  golang-http
  jenkins-cwp-quickstart
  jenkins-quickstart
</code></pre>
<p>Select <code>node-http</code></p>
<pre><code>? select the quickstart you wish to create node-http
? Project name (node-http)
</code></pre>
<p>Type <code>node-http-hmi-repository</code></p>
<pre><code>? Project name node-http-hmi-repository
Generated quickstart at /home/gmacario/node-http-hmi-repository
 ### NO charts folder /home/gmacario/node-http-hmi-repository/charts/node-http
Created project at /home/gmacario/node-http-hmi-repository

No username defined for the current Git server!
? Do you wish to use gmacario as the Git user name: (Y/n)
</code></pre>
<p>Type <code>Y</code></p>
<pre><code>? Do you wish to use gmacario as the Git user name: Yes
The directory /home/gmacario/node-http-hmi-repository is not yet using git
? Would you like to initialise git now? (Y/n)
</code></pre>
<p>Type <code>Y</code></p>
<pre><code>? Would you like to initialise git now? Yes
? Commit message:  (Initial import)
</code></pre>
<p>Accept default</p>
<pre><code>? Commit message:  Initial import

Git repository created
performing pack detection in folder /home/gmacario/node-http-hmi-repository
--&gt; Draft detected JavaScript (36.530078%)
selected pack: /home/gmacario/.jx/draft/packs/github.com/jenkins-x/draft-packs/packs/javascript
replacing placeholders in directory /home/gmacario/node-http-hmi-repository
app name: node-http-hmi-repository, git server: github.com, org: gmacario, Docker registry org: gmacario
skipping directory &quot;/home/gmacario/node-http-hmi-repository/.git&quot;
Using Git provider GitHub at https://github.com


About to create repository node-http-hmi-repository on server https://github.com with user gmacario
? Which organisation do you want to use?  [Use arrows to move, type to filter]
  SOLARMA
  TorinoTech
  arolgroup
&gt; gmacario
  hackafake
  kuruho
  robotrokers
</code></pre>
<p>Select gmacario</p>
<pre><code>? Which organisation do you want to use? gmacario
? Enter the new repository name:  (node-http-hmi-repository)
</code></pre>
<p>Accept default</p>
<pre><code>? Enter the new repository name:  node-http-hmi-repository


Creating repository gmacario/node-http-hmi-repository
Pushed Git repository to https://github.com/gmacario/node-http-hmi-repository

Created Jenkins Project: http://jenkins.jx.35.195.52.165.nip.io/job/gmacario/job/node-http-hmi-repository/

Watch pipeline activity via:    jx get activity -f node-http-hmi-repository -w
Browse the pipeline log via:    jx get build logs gmacario/node-http-hmi-repository/master
Open the Jenkins console via    jx console
You can list the pipelines via: jx get pipelines
When the pipeline is complete:  jx get applications

For more help on available commands see: https://jenkins-x.io/developing/browsing/

Note that your first pipeline may take a few minutes to start while the necessary images get downloaded!

Creating GitHub webhook for gmacario/node-http-hmi-repository for url http://jenkins.jx.35.195.52.165.nip.io/github-webhook/
gmacario@cloudshell:~ (kubernetes-workshop-218213)$
</code></pre>
<h4 id="run-jx-status">Run <code>jx status</code></h4>
<!-- 2018-10-15 16:21 CEST -->

<p>Command</p>
<pre><code class="language-shell">jx status
</code></pre>
<p>Result</p>
<pre><code>gmacario@cloudshell:~ (kubernetes-workshop-218213)$ jx status
Jenkins X checks passed for Cluster(gke_kubernetes-workshop-218213_europe-west1-b_howlernoon): 3 nodes, memory 15% of 17354292Ki, cpu 41% of 5790m. Jenkins is running at http://jenkins.jx.35.195.140.178.nip.io
gmacario@cloudshell:~ (kubernetes-workshop-218213)$
</code></pre>
<h4 id="run-jx-console">Run <code>jx console</code></h4>
<!-- 2018-10-15 16:21 CEST -->

<p>To know the URL of the Jenkins Dashboard, use the <code>jx console</code> command:</p>
<pre><code>gmacario@cloudshell:~ (kubernetes-workshop-218213)$ jx console
Jenkins Console: http://jenkins.jx.35.195.140.178.nip.io/blue
gmacario@cloudshell:~ (kubernetes-workshop-218213)$
</code></pre>
<p>In our example, browse <a href="http://jenkins.jx.35.195.140.178.nip.io/blue">http://jenkins.jx.35.195.140.178.nip.io/blue</a></p>
<p><strong>NOTE</strong>: Jenkins login credentials (username: <code>admin</code>, password: <code>****</code>) were displayed during the installation of Jenkins X, and are stored in file <code>~/.jx/jenkinsAuth.yaml</code>.</p>
<p>You should find three pipelines:</p>
<ul>
<li>gmacario/environment-howlernoon-production</li>
<li>gmacario/environment-howlernoon-staging</li>
<li>gmacario/node-http-hmi-repository</li>
</ul>
<h4 id="run-jx-get-build-logs">Run <code>jx get build logs</code></h4>
<!-- 2018-10-15 16:23 CEST -->

<p>You may also inspect the logs of the Jenkins pipelines
with the <code>jx build logs</code> command:</p>
<pre><code>gmacario@cloudshell:~ (kubernetes-workshop-218213)$ jx get build logs
? Which pipeline do you want to view the logs of?:   [Use arrows to move, type to filter]
&gt; gmacario/environment-howlernoon-production/master
  gmacario/environment-howlernoon-staging/master
  gmacario/node-http-hmi-repository/master
</code></pre>
<p>Inspect each of the above pipelines and make sure that all of them
have completed successfully.</p>
<h3 id="preview-the-application">Preview the application</h3>
<!-- 2018-10-15 16:23 CEST -->

<p>Use the <code>jx get environment</code> command to display the configured Jenkins X environments:</p>
<pre><code>gmacario@cloudshell:~ (kubernetes-workshop-218213)$ jx get environment
NAME       LABEL       KIND        PROMOTE NAMESPACE     ORDER CLUSTER SOURCE                                                            REF PR
dev        Development Development Never   jx            0                                                              
staging    Staging     Permanent   Auto    jx-staging    100           https://github.com/gmacario/environment-howlernoon-staging.git
production Production  Permanent   Manual  jx-production 200           https://github.com/gmacario/environment-howlernoon-production.git
gmacario@cloudshell:~ (kubernetes-workshop-218213)$
</code></pre>
<h4 id="preview-the-staging-environment">Preview the staging environment</h4>
<!-- 2018-10-15 16:23 CEST -->

<pre><code>gmacario@cloudshell:~ (kubernetes-workshop-218213)$ jx open --env staging
Name                     URL
node-http-hmi-repository http://node-http-hmi-repository.jx-staging.35.195.140.178.nip.io
gmacario@cloudshell:~ (kubernetes-workshop-218213)$
</code></pre>
<p>then browse the URL corresponding to service <code>node-http-hmi-repository</code> -
in our case, <a href="http://node-http-hmi-repository.jx-staging.35.195.140.178.nip.io">http://node-http-hmi-repository.jx-staging.35.195.140.178.nip.io</a></p>
<p>Alternatively:</p>
<p>Browse GCP Console &gt; Kubernetes Engine &gt; Services</p>
<p>In tab &quot;Kubernetes services&quot;, filter by &quot;Service Type: Ingress&quot;</p>
<p>Browse the staging environment of &quot;node-http-hmi-repository&quot; at
<a href="http://node-http-hmi-repository.jx-staging.35.195.140.178.nip.io/">http://node-http-hmi-repository.jx-staging.35.195.140.178.nip.io/</a></p>
<h4 id="preview-the-production-environment">Preview the production environment</h4>
<p>For the time being no applications have been deployed to the production environment:</p>
<pre><code>gmacario@cloudshell:~ (kubernetes-workshop-218213)$ jx open --env production
Name URL
gmacario@cloudshell:~ (kubernetes-workshop-218213)$
</code></pre>
<p>As demonstrated by the <code>jx get environment</code> command above,
the deployment to the production environment is configured to be performed manually.</p>
<h3 id="typical-application-development-workflow">Typical application development workflow</h3>
<h4 id="create-an-issue-to-node-http-hmi-repository">Create an issue to node-http-hmi-repository</h4>
<!-- 2018-10-12 17:21 CEST -->

<p>Logged as gmacario@cloudshell</p>
<pre><code class="language-shell">cd ~/node-http-hmi-repository
jx create issue -t &quot;Change message on the homepage&quot;
</code></pre>
<pre><code>gmacario@cloudshell:~ (kubernetes-workshop-218213)$ cd node-http-hmi-repository/
gmacario@cloudshell:~/node-http-hmi-repository (kubernetes-workshop-218213)$ jx create issue -t &quot;Change message on the homepage&quot;
? Do you wish to use gmacario as the user name to use for authenticating with git issues Yes

Created issue #1 at https://github.com/gmacario/node-http-hmi-repository/issues/1
gmacario@cloudshell:~/node-http-hmi-repository (kubernetes-workshop-218213)$
</code></pre>
<p>Double check: <a href="https://github.com/gmacario/node-http-hmi-repository/issues">https://github.com/gmacario/node-http-hmi-repository/issues</a></p>
<h4 id="create-a-development-branch">Create a development branch</h4>
<!-- 2018-10-12 17:23 CEST -->

<p>Now let us switch to a branch where we can work on fixing the issue</p>
<pre><code class="language-shell">git checkout -b feature/update-index
vi index.html
git add index.html
git commit -a -m &quot;index.html: Update text - fixes #1&quot;
git push -u origin feature/update-index
</code></pre>
<p>Now if we installed the &quot;<a href="https://hub.github.com/">hub</a>&quot; tool,
we could create a Pull Request directly from the Command Line.
Otherwise we can just do it from the GitHub web interface.</p>
<h4 id="create-a-pull-request-to-node-http-hmi-repository">Create a Pull Request to node-http-hmi-repository</h4>
<p>Browse <a href="https://github.com/gmacario/node-http-hmi-repository">https://github.com/gmacario/node-http-hmi-repository</a>
and create a Pull Request from the branch you have just pushed</p>
<p>From <a href="https://github.com/gmacario/node-http-hmi-repository/pull/2">https://github.com/gmacario/node-http-hmi-repository/pull/2</a></p>
<blockquote>
<p>PR built and available in a preview environment <strong>gmacario-node-http-hmi-repository-pr-2</strong> <a href="http://node-http-hmi-repository.jx-gmacario-node-http-hmi-repository-pr-2.35.195.52.165.nip.io/">here</a></p>
</blockquote>
<p>After the PR is merged to master, the change will be deployed to the staging environment.</p>
<p>You may verify the progress of the pipelines with the following command</p>
<pre><code class="language-shell">jx get build logs
</code></pre>
<!-- 2018-10-15 09:26 CEST -->

<p>If we run the <code>jx get apps</code> command, we can see that version 0.0.2 has been deployed to the staging environment:</p>
<pre><code>gmacario@cloudshell:~ (kubernetes-workshop-218213)$ jx get apps
APPLICATION              STAGING PODS URL                                                             PRODUCTION PODS URL
node-http-hmi-repository 0.0.2   1/1  http://node-http-hmi-repository.jx-staging.35.195.52.165.nip.io
gmacario@cloudshell:~ (kubernetes-workshop-218213)$
</code></pre>
<p>List the services in the development environment:</p>
<pre><code>gmacario@cloudshell:~ (kubernetes-workshop-218213)$ jx open
Name                      URL
jenkins                   http://jenkins.jx.35.195.52.165.nip.io
jenkins-x-chartmuseum     http://chartmuseum.jx.35.195.52.165.nip.io
jenkins-x-docker-registry http://docker-registry.jx.35.195.52.165.nip.io
jenkins-x-monocular-api   http://monocular.jx.35.195.52.165.nip.io
jenkins-x-monocular-ui    http://monocular.jx.35.195.52.165.nip.io
nexus                     http://nexus.jx.35.195.52.165.nip.io
gmacario@cloudshell:~ (kubernetes-workshop-218213)$
</code></pre>
<p>List the services in the staging environment:</p>
<pre><code>gmacario@cloudshell:~ (kubernetes-workshop-218213)$ jx open --env staging
Name                     URL
node-http-hmi-repository http://node-http-hmi-repository.jx-staging.35.195.52.165.nip.io
gmacario@cloudshell:~ (kubernetes-workshop-218213)$
</code></pre>
<p>List the services in the production environment:</p>
<pre><code>gmacario@cloudshell:~ (kubernetes-workshop-218213)$ jx open --env production
Name URL
gmacario@cloudshell:~ (kubernetes-workshop-218213)$
</code></pre>
<!-- 2018-10-15 09:58 CEST -->

<p>Display the activities for application &quot;node-http-hmi-repository&quot;</p>
<pre><code class="language-shell">jx get activity -f node-http-hmi-repository
</code></pre>
<p>Result:</p>
<pre><code>gmacario@cloudshell:~/node-http-hmi-repository (kubernetes-workshop-218213)$ jx get activity -f node-http-hmi-repository
STEP                                                        STARTED AGO DURATION STATUS
gmacario/node-http-hmi-repository/master #1                    65h2m37s    6m19s Succeeded Version: 0.0.1
  Checkout Source                                              65h1m46s      11s Succeeded
  CI Build and push snapshot                                   65h1m35s          NotExecuted
  Build Release                                                65h1m34s    1m11s Succeeded
  Promote to Environments                                      65h0m23s     4m4s Succeeded
  Promote: staging                                            64h59m55s    3m29s Succeeded
    PullRequest                                               64h59m55s     2m7s Succeeded  PullRequest: https://github.com/gmacario/environment-craftersaber-staging/pull/1 Merge SHA: f6c065ce56e1eb0e9f63def06b3cea2f9934c15a
    Update                                                    64h57m48s    1m22s Succeeded  Status: Success at: http://jenkins.jx.35.195.52.165.nip.io/job/gmacario/job/environment-craftersaber-staging/job/master/4/display/redirect
    Promoted                                                  64h57m48s    1m22s Succeeded  Application is at: http://node-http-hmi-repository.jx-staging.35.195.52.165.nip.io
  Clean up                                                    64h56m19s       1s Succeeded
gmacario/node-http-hmi-repository/master #2                    64h28m3s    4m25s Succeeded Version: 0.0.2
  Checkout Source                                             64h27m35s       8s Succeeded
  CI Build and push snapshot                                  64h27m27s          NotExecuted
  Build Release                                               64h27m26s      47s Succeeded
  Promote to Environments                                     64h26m39s     3m1s Succeeded
  Promote: staging                                            64h26m12s    2m28s Succeeded
    PullRequest                                               64h26m12s    1m26s Succeeded  PullRequest: https://github.com/gmacario/environment-craftersaber-staging/pull/2 Merge SHA: 032d965749c9abb38a1a17da94e71e0530413848
    Update                                                    64h24m46s     1m2s Succeeded  Status: Success at: http://jenkins.jx.35.195.52.165.nip.io/job/gmacario/job/environment-craftersaber-staging/job/master/5/display/redirect
    Promoted                                                  64h24m46s     1m2s Succeeded  Application is at: http://node-http-hmi-repository.jx-staging.35.195.52.165.nip.io
  Clean up                                                    64h23m38s       0s Succeeded
gmacario/node-http-hmi-repository/PR-2 #1                     64h31m13s    1m43s Succeeded
  Checkout Source                                             64h30m45s       8s Succeeded
  CI Build and push snapshot                                  64h30m37s     1m7s Succeeded
  Preview                                                     64h29m31s           https://github.com/gmacario/node-http-hmi-repository/pull/2
    Preview Application                                       64h29m31s           http://node-http-hmi-repository.jx-gmacario-node-http-hmi-repository-pr-2.35.195.52.165.nip.io
  Build Release                                               64h29m30s          NotExecuted
  Promote to Environments                                     64h29m30s          NotExecuted
  Clean up                                                    64h29m30s       0s Succeeded
gmacario@cloudshell:~/node-http-hmi-repository (kubernetes-workshop-218213)$
</code></pre>
<h4 id="creating-a-devpod">Creating a devpod</h4>
<!-- 2018-10-15 10:18 CEST -->

<pre><code class="language-shell">jx create devpod
</code></pre>
<p>Result:</p>
<pre><code>gmacario@cloudshell:~/node-http-hmi-repository (kubernetes-workshop-218213)$ jx create devpod
Installing the ExposecontrollerService in the namespace: jx-edit-gmacario
Updating Helm repository...
Using helmBinary helm with feature flag: none
Helm repository update done.
Creating a DevPod of label: nodejs
Created pod gmacario-nodejs - waiting for it to be ready...
Updating Helm repository...
Helm repository update done.
Pod gmacario-nodejs is now ready!
You can open other shells into this DevPod via jx create devpod
You can edit your app using Theia (a browser based IDE) at http://gmacario-nodejs-theia.jx.35.195.52.165.nip.io
Port 80 is open on [http://gmacario-nodejs-port-3000.jx.35.195.52.165.nip.io http://gmacario-nodejs-port-9229.jx.35.195.52.165.nip.io] and forwarded to the devpod
Installing Bash Completion into DevPod
Defaulting container name to nodejs.
Use &#39;kubectl describe pod/gmacario-nodejs -n jx&#39; to see all of the containers in this pod.
Generated Git credentials file /home/jenkins/git/credentials
Cloning into &#39;node-http-hmi-repository&#39;...
remote: Enumerating objects: 62, done.
remote: Counting objects: 100% (62/62), done.
remote: Compressing objects: 100% (40/40), done.
remote: Total 62 (delta 15), reused 60 (delta 14), pack-reused 0
Unpacking objects: 100% (62/62), done.
Checking connectivity... done.
[root@gmacario-nodejs node-http-hmi-repository]#
</code></pre>
<p>The command has now opened a devshell in my devpod.
It&#39;s a bit like ssh-ing into my devpod.</p>
<p>If I now type <code>docker ps</code> I will list the containers running on my Kubernetes cluster:</p>
<pre><code>[root@gmacario-nodejs node-http-hmi-repository]# docker ps
CONTAINER ID        IMAGE                                                 COMMAND                  CREATED             STATUS              PORTS               NAMES
4879c689cac6        jenkinsxio/builder-nodejs                             &quot;/bin/sh -c cat&quot;         10 minutes ago      Up 10 minutes                           k8s_nodejs_gmacario-nodejs_jx_1292aab6-d053-11e8-a13f-42010a84007c_0
46c0a72de1a3        jenkinsxio/exposecontroller                           &quot;/exposecontroller -…&quot;   12 minutes ago      Up 12 minutes                           k8s_exposecontroller-service_exposecontroller-service-6b5bf9cc68-h47br_jx-edit-gmacario_127c8a9b-d053-11e8-a13f-42010a84007c_0
6a3012ffa069        k8s.gcr.io/pause-amd64:3.1                            &quot;/pause&quot;                 12 minutes ago      Up 12 minutes                           k8s_POD_gmacario-nodejs_jx_1292aab6-d053-11e8-a13f-42010a84007c_0
019cba949c7b        k8s.gcr.io/pause-amd64:3.1                            &quot;/pause&quot;                 12 minutes ago      Up 12 minutes                           k8s_POD_exposecontroller-service-6b5bf9cc68-h47br_jx-edit-gmacario_127c8a9b-d053-11e8-a13f-42010a84007c_0
a5349f2f3e1e        055e8e6ae33a                                          &quot;/monitor --stackdri…&quot;   2 days ago          Up 2 days                               k8s_prometheus-to-sd-exporter_fluentd-gcp-v3.1.0-l9swq_kube-system_1f1ac6d2-ceab-11e8-a13f-42010a84007c_0
6952d5766cc4        gcr.io/stackdriver-agents/stackdriver-logging-agent   &quot;/entrypoint.sh /usr…&quot;   2 days ago          Up 2 days                               k8s_fluentd-gcp_fluentd-gcp-v3.1.0-l9swq_kube-system_1f1ac6d2-ceab-11e8-a13f-42010a84007c_0
06794ae76980        k8s.gcr.io/pause-amd64:3.1                            &quot;/pause&quot;                 2 days ago          Up 2 days                               k8s_POD_fluentd-gcp-v3.1.0-l9swq_kube-system_1f1ac6d2-ceab-11e8-a13f-42010a84007c_0
4919cf79de07        380b233f1574                                          &quot;/bin/sh -c &#39;exec ku…&quot;   2 days ago          Up 2 days                               k8s_kube-proxy_kube-proxy-gke-craftersaber-default-pool-9203d5e5-xkws_kube-system_0cfe54e72c47cb3c4efc7f396ebbda85_0
d0543cb37dfa        k8s.gcr.io/pause-amd64:3.1                            &quot;/pause&quot;                 2 days ago          Up 2 days                               k8s_POD_kube-proxy-gke-craftersaber-default-pool-9203d5e5-xkws_kube-system_0cfe54e72c47cb3c4efc7f396ebbda85_0
[root@gmacario-nodejs node-http-hmi-repository]#
</code></pre>
<p>This command has also run the <code>ksync</code> command.
<a href="https://vapor-ware.github.io/ksync">Ksync</a> is an open source tool which syncs files from your local system to a specific container running in a Kubernetes cluster.</p>
<pre><code>[root@gmacario-nodejs node-http-hmi-repository]# pwd
/workspace/node-http-hmi-repository
[root@gmacario-nodejs node-http-hmi-repository]# ls -la
total 84
drwxr-xr-x 4 root root  4096 Oct 15 08:30 .
drwxrwxrwx 3 root root  4096 Oct 15 08:30 ..
drwxr-xr-x 4 root root  4096 Oct 15 08:30 charts
-rwxr-xr-x 1 root root   122 Oct 15 08:30 curlloop.sh
-rw-r--r-- 1 root root    93 Oct 15 08:30 Dockerfile
-rw-r--r-- 1 root root    43 Oct 15 08:30 .dockerignore
drwxr-xr-x 8 root root  4096 Oct 15 08:30 .git
-rw-r--r-- 1 root root   884 Oct 15 08:30 .gitignore
-rw-r--r-- 1 root root   398 Oct 15 08:30 .helmignore
-rw-r--r-- 1 root root   193 Oct 15 08:30 index.html
-rw-r--r-- 1 root root  2620 Oct 15 08:30 Jenkinsfile
-rw-r--r-- 1 root root 11357 Oct 15 08:30 LICENSE
-rw-r--r-- 1 root root    44 Oct 15 08:30 OWNERS
-rw-r--r-- 1 root root    74 Oct 15 08:30 OWNERS_ALIASES
-rw-r--r-- 1 root root   244 Oct 15 08:30 package.json
-rw-r--r-- 1 root root    59 Oct 15 08:30 README.md
-rw-r--r-- 1 root root   419 Oct 15 08:30 server.js
-rw-r--r-- 1 root root   760 Oct 15 08:30 skaffold.yaml
-rwxr-xr-x 1 root root   179 Oct 15 08:30 watch.sh
[root@gmacario-nodejs node-http-hmi-repository]#
</code></pre>
<!-- FIXME: jx sync returns "ksync version mismatch" -->

<pre><code class="language-shell">cd ~/node-http-hmi-repository
jx sync
</code></pre>
<p>Result:</p>
<pre><code>gmacario@cloudshell:~/node-http-hmi-repository (kubernetes-workshop-218213)$ jx sync
ksync is already available on your PATH at /home/gmacario/.jx/bin/ksync
Looks like &#39;ksync watch&#39; is not running: Command failed &#39;ksync get&#39;: time=&quot;2018-10-15T11:43:28+02:00&quot; level=fatal msg=&quot;Having problems querying status. Are you running watch?&quot; exit status 1
Started the ksync watch
INFO[0000] listening                                     bind=127.0.0.1 port=40322
INFO[0003] syncthing listening                           port=8384 syncthing=localhost
</code></pre>
<h4 id="promote-to-production">Promote to production</h4>
<!-- 2018-10-16 10:30 CEST -->

<p>The promotion to the production environment should be performed by an user with the proper permissions to create and merge Pull Request to repository <a href="https://github.com/gmacario/environment-howlernoon-production">https://github.com/gmacario/environment-howlernoon-production</a></p>
<pre><code class="language-shell">cd ~/node-http-hmi-repository
git status
jx promote --version 0.0.3 --env production
</code></pre>
<p>Result:</p>
<pre><code>gmacario@cloudshell:~/node-http-hmi-repository (kubernetes-workshop-218213)$ jx promote --version 0.0.3 --env production
Using helmBinary helm with feature flag: none
Promoting app node-http-hmi-repository version 0.0.3 to namespace jx-production
pipeline gmacario/node-http-hmi-repository/master
Username for &#39;https://github.com&#39;: gmacario
Password for &#39;https://gmacario@github.com&#39;:
? Do you wish to use gmacario as the user name to submit the Pull Request Yes
Created Pull Request: https://github.com/gmacario/environment-howlernoon-production/pull/2
pipeline gmacario/node-http-hmi-repository/master
Failed to query the Pull Request last commit status for https://github.com/gmacario/environment-howlernoon-production/pull/2 ref 27758a287b0b389a43477f099d8d8d23a6f32e52 Could not find a status for repository gmacario/environment-howlernoon-production with ref 27758a287b0b389a43477f099d8d8d23a6f32e52
Failed to query the Pull Request last commit status for https://github.com/gmacario/environment-howlernoon-production/pull/2 ref 27758a287b0b389a43477f099d8d8d23a6f32e52 Could not find a status for repository gmacario/environment-howlernoon-production with ref 27758a287b0b389a43477f099d8d8d23a6f32e52
Pull Request https://github.com/gmacario/environment-howlernoon-production/pull/2 is merged at sha 9d64dad34d425d90b846b3bfdcf5904f9ed017cd
Merge commit has not yet any statuses on repo gmacario/environment-howlernoon-production merge sha 9d64dad34d425d90b846b3bfdcf5904f9ed017cd
merge status: pending for URL https://api.github.com/repos/gmacario/environment-howlernoon-production/statuses/9d64dad34d425d90b846b3bfdcf5904f9ed017cd with target: http://jenkins.jx.35.195.140.178.nip.io/job/gmacario/job/environment-howlernoon-production/job/master/3/display/redirect description: This commit is being built
merge status: success for URL https://api.github.com/repos/gmacario/environment-howlernoon-production/statuses/9d64dad34d425d90b846b3bfdcf5904f9ed017cd with target: http://jenkins.jx.35.195.140.178.nip.io/job/gmacario/job/environment-howlernoon-production/job/master/3/display/redirect description: This commit looks good
Merge status checks all passed so the promotion worked!
? Do you wish to use gmacario as the user name to comment on issues Yes
Commenting that issue https://github.com/gmacario/node-http-hmi-repository/issues/1 is now in Production
gmacario@cloudshell:~/node-http-hmi-repository (kubernetes-workshop-218213)$
</code></pre>
<p>You may follow the progress of the PR at <a href="https://github.com/gmacario/environment-howlernoon-production/pull/2">https://github.com/gmacario/environment-howlernoon-production/pull/2</a></p>
<p>Verify that release 0.0.3 of <code>node-http-hmi-repository</code> has been deployed in production:</p>
<pre><code>gmacario@cloudshell:~/node-http-hmi-repository (kubernetes-workshop-218213)$ jx get apps -e production
APPLICATION              PRODUCTION PODS URL
node-http-hmi-repository 0.0.3      1/1  http://node-http-hmi-repository.jx-production.35.195.140.178.nip.io
gmacario@cloudshell:~/node-http-hmi-repository (kubernetes-workshop-218213)$
</code></pre>
<p>Browse the production environment of &quot;node-http-hmi-repository&quot; at
<a href="http://node-http-hmi-repository.jx-production.35.195.140.178.nip.io/">http://node-http-hmi-repository.jx-production.35.195.140.178.nip.io/</a></p>
<h3 id="things-which-do-not-yet-work-as-expected">Things which do not yet work as expected</h3>
<!-- FIXME: Browsing theia URL returns "403 Service Unavailable" -->

<h4 id="browse-monocular-instance">Browse Monocular instance</h4>
<pre><code class="language-shell">jx open
</code></pre>
<p>Browse <a href="http://monocular.jx.35.195.140.178.nip.io/">http://monocular.jx.35.195.140.178.nip.io/</a></p>
<p>The page seems to hang after displaying title.
Maybe is this due to <a href="https://github.com/jenkins-x/jx/issues/1417">jx issues/1417</a>?</p>
<!--
TODO TODO TODO

```shell
jx get env
```

```shell
jx env production
```

Result:

```
TODO
```
-->

<!--
#### Run `TODO`

Command

```shell
TODO
```

Result

```
TODO
```

TODO TODO
-->

<h3 id="summary">Summary</h3>
<p>This article explained how to perform CI/CD of a Node.JS web application on a Kubernetes cluster using Jenkins X.</p>
<p>Jenkins X is quite recent and therefore presents a few rough edges as the list of <a href="https://github.com/jenkins-x/jx/issues">issues on GitHub</a> can testify, however it shows great potential to represent a very helpful tool for making the journey of application developers to Kubernetes smoother.</p>
<h3 id="see-also">See also</h3>
<ul>
<li><a href="https://jenkins-x.io/">https://jenkins-x.io/</a></li>
<li><a href="https://jenkins.io/projects/jenkins-x/">https://jenkins.io/projects/jenkins-x/</a></li>
<li><a href="https://youtu.be/UTKIT6STSVM">Jenkins X: Easy CI/CD for Kubernetes - James Strachan, CloudBees (Intermediate Skill Level)</a> (YouTube Video, 34:55)</li>
</ul>
<!--
* [Jenkins X - Automated CI/CD for Kubernetes](https://www.cloudbees.com/resource/webinar-recording/ondemand-webinar-easy-cicd-kubernetes/thank-you)
-->

<!-- markdown-link-check-enable -->
<!-- EOF -->
</div></article></div><footer class="h-auto mt-20 bg-gray-100 justify-between border-t border-gray-200"><div class="pt-6 mx-auto  gap-x-6 w-9/12 flex flex-col prose prose-indigo hover:prose-black md:prose-lg lg:prose-xl"><div class="prose-xl"><p class="">gmacario.github.io</p></div><div class="flex flex-col sm:flex-row flex-wrap justify-between md:justify-start"><p class="mr-12 text-gray-600 prose-sm">gmacario.github.io</p><div class="mr-12 flex flex-col justify-start"><p class="text-gray-600 prose-sm flex flex-row"><svg class="MuiSvgIcon-root mr-2" focusable="false" viewBox="0 0 24 24" aria-hidden="true"><path d="M12 .3a12 12 0 0 0-3.8 23.4c.6.1.8-.3.8-.6v-2c-3.3.7-4-1.6-4-1.6-.6-1.4-1.4-1.8-1.4-1.8-1-.7.1-.7.1-.7 1.2 0 1.9 1.2 1.9 1.2 1 1.8 2.8 1.3 3.5 1 0-.8.4-1.3.7-1.6-2.7-.3-5.5-1.3-5.5-6 0-1.2.5-2.3 1.3-3.1-.2-.4-.6-1.6 0-3.2 0 0 1-.3 3.4 1.2a11.5 11.5 0 0 1 6 0c2.3-1.5 3.3-1.2 3.3-1.2.6 1.6.2 2.8 0 3.2.9.8 1.3 1.9 1.3 3.2 0 4.6-2.8 5.6-5.5 5.9.5.4.9 1 .9 2.2v3.3c0 .3.1.7.8.6A12 12 0 0 0 12 .3"></path></svg><a href="https://github.com/gmacario">gmacario</a></p><p class="text-gray-600 prose-sm flex flex-row"><svg class="MuiSvgIcon-root mr-2" focusable="false" viewBox="0 0 24 24" aria-hidden="true"><path d="M22.46 6c-.77.35-1.6.58-2.46.69.88-.53 1.56-1.37 1.88-2.38-.83.5-1.75.85-2.72 1.05C18.37 4.5 17.26 4 16 4c-2.35 0-4.27 1.92-4.27 4.29 0 .34.04.67.11.98C8.28 9.09 5.11 7.38 3 4.79c-.37.63-.58 1.37-.58 2.15 0 1.49.75 2.81 1.91 3.56-.71 0-1.37-.2-1.95-.5v.03c0 2.08 1.48 3.82 3.44 4.21a4.22 4.22 0 0 1-1.93.07 4.28 4.28 0 0 0 4 2.98 8.521 8.521 0 0 1-5.33 1.84c-.34 0-.68-.02-1.02-.06C3.44 20.29 5.7 21 8.12 21 16 21 20.33 14.46 20.33 8.79c0-.19 0-.37-.01-.56.84-.6 1.56-1.36 2.14-2.23z"></path></svg><a href="https://www.twitter.com/gpmacario">gpmacario</a></p></div><p class="mr-12 text-gray-600 prose-sm">Gianpaolo Macario&#x27;s public rants</p></div></div></footer></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"Deploying a Node.JS application on Kubernetes using Jenkins X","content":"\u003c!-- markdown-link-check-disable --\u003e\n\n\u003ch3 id=\"introduction\"\u003eIntroduction\u003c/h3\u003e\n\u003cp\u003eThis article explains how to deploy a simple \u003ca href=\"https://nodejs.org/\"\u003eNode.JS\u003c/a\u003e application on a \u003ca href=\"https://kubernetes.io/\"\u003eKubernetes\u003c/a\u003e cluster using \u003ca href=\"https://jenkins-x.io/\"\u003eJenkins X\u003c/a\u003e.\u003c/p\u003e\n\u003cp\u003eThis post is the follow-up to my previous article \u003ca href=\"https://gmacario.github.io/howto/kubernetes/gcp/jenkins/2018/10/09/install-jenkinsx-on-gcp.html\"\u003eInstalling Jenkins X on Google Cloud Platform\u003c/a\u003e.\u003c/p\u003e\n\u003cp\u003eThe following instructions have been tested on host \u0026quot;nemo\u0026quot; (Ubuntu 18.04.1 LTS 64-bit).\u003c/p\u003e\n\u003cp\u003eWe will create our sample application using Jenkins X Quickstart. Quickstarts are pre-made applications you can start a project from, instead of starting from scratch.\u003c/p\u003e\n\u003ch3 id=\"references\"\u003eReferences\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://jenkins-x.io/getting-started/\"\u003ehttps://jenkins-x.io/getting-started/\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://gmacario.github.io/howto/kubernetes/gcp/jenkins/2018/10/09/install-jenkinsx-on-gcp.html\"\u003ehttps://gmacario.github.io/howto/kubernetes/gcp/jenkins/2018/10/09/install-jenkinsx-on-gcp.html\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"prerequisites\"\u003ePrerequisites\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eThe \u003ccode\u003ejx\u003c/code\u003e binary is installed and available from your shell\u003c/li\u003e\n\u003cli\u003eJenkins X properly configured\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eBrowse \u003ca href=\"https://console.cloud.google.com/\"\u003ehttps://console.cloud.google.com/\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eSelect the proper GCP project (in our case, \u003ccode\u003ekubernetes-workshop-218213\u003c/code\u003e)\u003c/p\u003e\n\u003cp\u003eClick on the \u0026quot;Activate Cloud Shell\u0026quot; icon.\u003c/p\u003e\n\u003ch4 id=\"reinstalling-the-jx-binary\"\u003eReinstalling the \u003ccode\u003ejx\u003c/code\u003e binary\u003c/h4\u003e\n\u003c!-- 2018-10-15 12:21 CEST --\u003e\n\n\u003cp\u003eType the following commands in case the \u003ccode\u003ejx\u003c/code\u003e command was not properly installed:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-shell\"\u003emkdir -p ~/.jx/bin\ncurl -L \\\n  https://github.com/jenkins-x/jx/releases/download/v1.3.431/jx-linux-amd64.tar.gz \\\n  | tar xzv -C ~/.jx/bin\nexport PATH=$PATH:~/.jx/bin\necho \u0026#39;export PATH=$PATH:~/.jx/bin\u0026#39; \u0026gt;\u0026gt; ~/.bashrc\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch4 id=\"verify-that-jx-is-correctly-configured\"\u003eVerify that jx is correctly configured\u003c/h4\u003e\n\u003c!-- 2018-10-15 16:17 CEST --\u003e\n\n\u003cpre\u003e\u003ccode class=\"language-shell\"\u003ejx status\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eExpected output:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003egmacario@cloudshell:~ (kubernetes-workshop-218213)$ jx status\nJenkins X checks passed for Cluster(gke_kubernetes-workshop-218213_europe-west1-b_howlernoon): 3 nodes, memory 15% of 17354292Ki, cpu 41% of 5790m. Jenkins is running at http://jenkins.jx.35.195.140.178.nip.io\ngmacario@cloudshell:~ (kubernetes-workshop-218213)$\n\u003c/code\u003e\u003c/pre\u003e\n\u003c!-- 2018-10-15 16:18 CEST --\u003e\n\n\u003cpre\u003e\u003ccode class=\"language-shell\"\u003ejx diagnose\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eExpected output:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003egmacario@cloudshell:~ (kubernetes-workshop-218213)$ jx diagnose\nRunning in namespace: jx\nJenkins X Version:\n Using helmBinary helm with feature flag: none\nNAME               VERSION\njx                 1.3.431\njenkins x platform 0.0.2765\nKubernetes cluster v1.9.7-gke.6\nkubectl            v1.10.7\nhelm client        v2.10.0+g9ad53aa\nhelm server        v2.10.0+g9ad53aa\ngit                git version 2.11.0\n\nJenkins X Status:\n Jenkins X checks passed for Cluster(gke_kubernetes-workshop-218213_europe-west1-b_howlernoon): 3 nodes, memory 15% of 17354292Ki, cpu 41% of 5790m. Jenkins is running at http://jenkins.jx.35.195.140.178.nip.io\n\nKubernetes PVCs:\n NAME                        STATUS    VOLUME                                     CAPACITY   ACCESS MODES   STORAGECLASS   AGE\njenkins                     Bound     pvc-59d7abdc-d065-11e8-8172-42010a8401ee   30Gi       RWO            standard       3h\njenkins-x-chartmuseum       Bound     pvc-59d670d0-d065-11e8-8172-42010a8401ee   8Gi        RWO            standard       3h\njenkins-x-docker-registry   Bound     pvc-59d72bce-d065-11e8-8172-42010a8401ee   100Gi      RWO            standard       3h\njenkins-x-mongodb           Bound     pvc-59d90e70-d065-11e8-8172-42010a8401ee   8Gi        RWO            standard       3h\njenkins-x-nexus             Bound     pvc-59da88d9-d065-11e8-8172-42010a8401ee   8Gi        RWO            standard       3h\n\nKubernetes Pods:\n NAME                                            READY     STATUS    RESTARTS   AGE\njenkins-5dcf5bcd85-7xflw                        1/1       Running   0          3h\njenkins-x-chartmuseum-645d78c798-fckz4          1/1       Running   0          3h\njenkins-x-controllerteam-858ff8c6b8-m728p       1/1       Running   0          3h\njenkins-x-controllerworkflow-595d54767-fqvqd    1/1       Running   0          3h\njenkins-x-docker-registry-dcb6d6d44-2xcvn       1/1       Running   0          3h\njenkins-x-heapster-96bd95dcf-kdgjj              2/2       Running   0          3h\njenkins-x-mongodb-968b595dd-ngjpg               1/1       Running   1          3h\njenkins-x-monocular-api-6cff5d65df-9wwgq        1/1       Running   2          3h\njenkins-x-monocular-prerender-6d8897856-dx4kq   1/1       Running   0          3h\njenkins-x-monocular-ui-6b7645b67-w8qt6          1/1       Running   0          3h\njenkins-x-nexus-55f87888dc-b5l59                1/1       Running   0          3h\n\nKubernetes Ingresses:\n NAME              HOSTS                                      ADDRESS          PORTS     AGE\nchartmuseum       chartmuseum.jx.35.195.140.178.nip.io       35.233.119.214   80        3h\ndocker-registry   docker-registry.jx.35.195.140.178.nip.io   35.233.119.214   80        3h\njenkins           jenkins.jx.35.195.140.178.nip.io           35.233.119.214   80        3h\nmonocular         monocular.jx.35.195.140.178.nip.io         35.233.119.214   80        3h\nnexus             nexus.jx.35.195.140.178.nip.io             35.233.119.214   80        3h\n\nKubernetes Secrets:\n NAME                                       TYPE                                  DATA      AGE\ncleanup-token-bql7k                        kubernetes.io/service-account-token   3         3h\ndefault-token-g42q9                        kubernetes.io/service-account-token   3         3h\nexpose-token-6dlll                         kubernetes.io/service-account-token   3         3h\njenkins                                    Opaque                                3         3h\njenkins-docker-cfg                         Opaque                                1         3h\njenkins-git-credentials                    Opaque                                1         3h\njenkins-git-ssh                            Opaque                                2         3h\njenkins-hub-api-token                      Opaque                                1         3h\njenkins-maven-settings                     Opaque                                1         3h\njenkins-npm-token                          Opaque                                1         3h\njenkins-release-gpg                        Opaque                                4         3h\njenkins-ssh-config                         Opaque                                1         3h\njenkins-token-929mw                        kubernetes.io/service-account-token   3         3h\njenkins-x-chartmuseum                      Opaque                                2         3h\njenkins-x-controllerteam-token-m4dsz       kubernetes.io/service-account-token   3         3h\njenkins-x-controllerworkflow-token-vbzsm   kubernetes.io/service-account-token   3         3h\njenkins-x-docker-registry-secret           Opaque                                1         3h\njenkins-x-mongodb                          Opaque                                1         3h\njx-basic-auth                              Opaque                                1         3h\njx-install-config                          Opaque                                3         3h\njx-pipeline-git-github-github              Opaque                                2         3h\nnexus                                      Opaque                                1         3h\n\nPlease visit https://jenkins-x.io/faq/issues/ for any known issues.\nFinished printing diagnostic information.\ngmacario@cloudshell:~ (kubernetes-workshop-218213)$\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"create-quickstart-application-node-http-hmi-repository\"\u003eCreate quickstart application \u003ccode\u003enode-http-hmi-repository\u003c/code\u003e\u003c/h3\u003e\n\u003c!-- 2018-10-12 16:51CEST --\u003e\n\n\u003cp\u003eReference: \u003ca href=\"https://jenkins-x.io/developing/create-quickstart/\"\u003ehttps://jenkins-x.io/developing/create-quickstart/\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eLogged as \u003ccode\u003egmacario@cloudshell\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-shell\"\u003ejx create quickstart\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eResult\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003egmacario@cloudshell:~ (kubernetes-workshop-218213)$ jx create quickstart\n? select the quickstart you wish to create  [Use arrows to move, type to filter]\n\u0026gt; android-quickstart\n  angular-io-quickstart\n  aspnet-app\n  dlang-http\n  golang-http\n  jenkins-cwp-quickstart\n  jenkins-quickstart\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eSelect \u003ccode\u003enode-http\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e? select the quickstart you wish to create node-http\n? Project name (node-http)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eType \u003ccode\u003enode-http-hmi-repository\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e? Project name node-http-hmi-repository\nGenerated quickstart at /home/gmacario/node-http-hmi-repository\n ### NO charts folder /home/gmacario/node-http-hmi-repository/charts/node-http\nCreated project at /home/gmacario/node-http-hmi-repository\n\nNo username defined for the current Git server!\n? Do you wish to use gmacario as the Git user name: (Y/n)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eType \u003ccode\u003eY\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e? Do you wish to use gmacario as the Git user name: Yes\nThe directory /home/gmacario/node-http-hmi-repository is not yet using git\n? Would you like to initialise git now? (Y/n)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eType \u003ccode\u003eY\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e? Would you like to initialise git now? Yes\n? Commit message:  (Initial import)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eAccept default\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e? Commit message:  Initial import\n\nGit repository created\nperforming pack detection in folder /home/gmacario/node-http-hmi-repository\n--\u0026gt; Draft detected JavaScript (36.530078%)\nselected pack: /home/gmacario/.jx/draft/packs/github.com/jenkins-x/draft-packs/packs/javascript\nreplacing placeholders in directory /home/gmacario/node-http-hmi-repository\napp name: node-http-hmi-repository, git server: github.com, org: gmacario, Docker registry org: gmacario\nskipping directory \u0026quot;/home/gmacario/node-http-hmi-repository/.git\u0026quot;\nUsing Git provider GitHub at https://github.com\n\n\nAbout to create repository node-http-hmi-repository on server https://github.com with user gmacario\n? Which organisation do you want to use?  [Use arrows to move, type to filter]\n  SOLARMA\n  TorinoTech\n  arolgroup\n\u0026gt; gmacario\n  hackafake\n  kuruho\n  robotrokers\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eSelect gmacario\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e? Which organisation do you want to use? gmacario\n? Enter the new repository name:  (node-http-hmi-repository)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eAccept default\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e? Enter the new repository name:  node-http-hmi-repository\n\n\nCreating repository gmacario/node-http-hmi-repository\nPushed Git repository to https://github.com/gmacario/node-http-hmi-repository\n\nCreated Jenkins Project: http://jenkins.jx.35.195.52.165.nip.io/job/gmacario/job/node-http-hmi-repository/\n\nWatch pipeline activity via:    jx get activity -f node-http-hmi-repository -w\nBrowse the pipeline log via:    jx get build logs gmacario/node-http-hmi-repository/master\nOpen the Jenkins console via    jx console\nYou can list the pipelines via: jx get pipelines\nWhen the pipeline is complete:  jx get applications\n\nFor more help on available commands see: https://jenkins-x.io/developing/browsing/\n\nNote that your first pipeline may take a few minutes to start while the necessary images get downloaded!\n\nCreating GitHub webhook for gmacario/node-http-hmi-repository for url http://jenkins.jx.35.195.52.165.nip.io/github-webhook/\ngmacario@cloudshell:~ (kubernetes-workshop-218213)$\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch4 id=\"run-jx-status\"\u003eRun \u003ccode\u003ejx status\u003c/code\u003e\u003c/h4\u003e\n\u003c!-- 2018-10-15 16:21 CEST --\u003e\n\n\u003cp\u003eCommand\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-shell\"\u003ejx status\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eResult\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003egmacario@cloudshell:~ (kubernetes-workshop-218213)$ jx status\nJenkins X checks passed for Cluster(gke_kubernetes-workshop-218213_europe-west1-b_howlernoon): 3 nodes, memory 15% of 17354292Ki, cpu 41% of 5790m. Jenkins is running at http://jenkins.jx.35.195.140.178.nip.io\ngmacario@cloudshell:~ (kubernetes-workshop-218213)$\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch4 id=\"run-jx-console\"\u003eRun \u003ccode\u003ejx console\u003c/code\u003e\u003c/h4\u003e\n\u003c!-- 2018-10-15 16:21 CEST --\u003e\n\n\u003cp\u003eTo know the URL of the Jenkins Dashboard, use the \u003ccode\u003ejx console\u003c/code\u003e command:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003egmacario@cloudshell:~ (kubernetes-workshop-218213)$ jx console\nJenkins Console: http://jenkins.jx.35.195.140.178.nip.io/blue\ngmacario@cloudshell:~ (kubernetes-workshop-218213)$\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eIn our example, browse \u003ca href=\"http://jenkins.jx.35.195.140.178.nip.io/blue\"\u003ehttp://jenkins.jx.35.195.140.178.nip.io/blue\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eNOTE\u003c/strong\u003e: Jenkins login credentials (username: \u003ccode\u003eadmin\u003c/code\u003e, password: \u003ccode\u003e****\u003c/code\u003e) were displayed during the installation of Jenkins X, and are stored in file \u003ccode\u003e~/.jx/jenkinsAuth.yaml\u003c/code\u003e.\u003c/p\u003e\n\u003cp\u003eYou should find three pipelines:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003egmacario/environment-howlernoon-production\u003c/li\u003e\n\u003cli\u003egmacario/environment-howlernoon-staging\u003c/li\u003e\n\u003cli\u003egmacario/node-http-hmi-repository\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"run-jx-get-build-logs\"\u003eRun \u003ccode\u003ejx get build logs\u003c/code\u003e\u003c/h4\u003e\n\u003c!-- 2018-10-15 16:23 CEST --\u003e\n\n\u003cp\u003eYou may also inspect the logs of the Jenkins pipelines\nwith the \u003ccode\u003ejx build logs\u003c/code\u003e command:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003egmacario@cloudshell:~ (kubernetes-workshop-218213)$ jx get build logs\n? Which pipeline do you want to view the logs of?:   [Use arrows to move, type to filter]\n\u0026gt; gmacario/environment-howlernoon-production/master\n  gmacario/environment-howlernoon-staging/master\n  gmacario/node-http-hmi-repository/master\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eInspect each of the above pipelines and make sure that all of them\nhave completed successfully.\u003c/p\u003e\n\u003ch3 id=\"preview-the-application\"\u003ePreview the application\u003c/h3\u003e\n\u003c!-- 2018-10-15 16:23 CEST --\u003e\n\n\u003cp\u003eUse the \u003ccode\u003ejx get environment\u003c/code\u003e command to display the configured Jenkins X environments:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003egmacario@cloudshell:~ (kubernetes-workshop-218213)$ jx get environment\nNAME       LABEL       KIND        PROMOTE NAMESPACE     ORDER CLUSTER SOURCE                                                            REF PR\ndev        Development Development Never   jx            0                                                              \nstaging    Staging     Permanent   Auto    jx-staging    100           https://github.com/gmacario/environment-howlernoon-staging.git\nproduction Production  Permanent   Manual  jx-production 200           https://github.com/gmacario/environment-howlernoon-production.git\ngmacario@cloudshell:~ (kubernetes-workshop-218213)$\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch4 id=\"preview-the-staging-environment\"\u003ePreview the staging environment\u003c/h4\u003e\n\u003c!-- 2018-10-15 16:23 CEST --\u003e\n\n\u003cpre\u003e\u003ccode\u003egmacario@cloudshell:~ (kubernetes-workshop-218213)$ jx open --env staging\nName                     URL\nnode-http-hmi-repository http://node-http-hmi-repository.jx-staging.35.195.140.178.nip.io\ngmacario@cloudshell:~ (kubernetes-workshop-218213)$\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003ethen browse the URL corresponding to service \u003ccode\u003enode-http-hmi-repository\u003c/code\u003e -\nin our case, \u003ca href=\"http://node-http-hmi-repository.jx-staging.35.195.140.178.nip.io\"\u003ehttp://node-http-hmi-repository.jx-staging.35.195.140.178.nip.io\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eAlternatively:\u003c/p\u003e\n\u003cp\u003eBrowse GCP Console \u0026gt; Kubernetes Engine \u0026gt; Services\u003c/p\u003e\n\u003cp\u003eIn tab \u0026quot;Kubernetes services\u0026quot;, filter by \u0026quot;Service Type: Ingress\u0026quot;\u003c/p\u003e\n\u003cp\u003eBrowse the staging environment of \u0026quot;node-http-hmi-repository\u0026quot; at\n\u003ca href=\"http://node-http-hmi-repository.jx-staging.35.195.140.178.nip.io/\"\u003ehttp://node-http-hmi-repository.jx-staging.35.195.140.178.nip.io/\u003c/a\u003e\u003c/p\u003e\n\u003ch4 id=\"preview-the-production-environment\"\u003ePreview the production environment\u003c/h4\u003e\n\u003cp\u003eFor the time being no applications have been deployed to the production environment:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003egmacario@cloudshell:~ (kubernetes-workshop-218213)$ jx open --env production\nName URL\ngmacario@cloudshell:~ (kubernetes-workshop-218213)$\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eAs demonstrated by the \u003ccode\u003ejx get environment\u003c/code\u003e command above,\nthe deployment to the production environment is configured to be performed manually.\u003c/p\u003e\n\u003ch3 id=\"typical-application-development-workflow\"\u003eTypical application development workflow\u003c/h3\u003e\n\u003ch4 id=\"create-an-issue-to-node-http-hmi-repository\"\u003eCreate an issue to node-http-hmi-repository\u003c/h4\u003e\n\u003c!-- 2018-10-12 17:21 CEST --\u003e\n\n\u003cp\u003eLogged as gmacario@cloudshell\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-shell\"\u003ecd ~/node-http-hmi-repository\njx create issue -t \u0026quot;Change message on the homepage\u0026quot;\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode\u003egmacario@cloudshell:~ (kubernetes-workshop-218213)$ cd node-http-hmi-repository/\ngmacario@cloudshell:~/node-http-hmi-repository (kubernetes-workshop-218213)$ jx create issue -t \u0026quot;Change message on the homepage\u0026quot;\n? Do you wish to use gmacario as the user name to use for authenticating with git issues Yes\n\nCreated issue #1 at https://github.com/gmacario/node-http-hmi-repository/issues/1\ngmacario@cloudshell:~/node-http-hmi-repository (kubernetes-workshop-218213)$\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eDouble check: \u003ca href=\"https://github.com/gmacario/node-http-hmi-repository/issues\"\u003ehttps://github.com/gmacario/node-http-hmi-repository/issues\u003c/a\u003e\u003c/p\u003e\n\u003ch4 id=\"create-a-development-branch\"\u003eCreate a development branch\u003c/h4\u003e\n\u003c!-- 2018-10-12 17:23 CEST --\u003e\n\n\u003cp\u003eNow let us switch to a branch where we can work on fixing the issue\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-shell\"\u003egit checkout -b feature/update-index\nvi index.html\ngit add index.html\ngit commit -a -m \u0026quot;index.html: Update text - fixes #1\u0026quot;\ngit push -u origin feature/update-index\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eNow if we installed the \u0026quot;\u003ca href=\"https://hub.github.com/\"\u003ehub\u003c/a\u003e\u0026quot; tool,\nwe could create a Pull Request directly from the Command Line.\nOtherwise we can just do it from the GitHub web interface.\u003c/p\u003e\n\u003ch4 id=\"create-a-pull-request-to-node-http-hmi-repository\"\u003eCreate a Pull Request to node-http-hmi-repository\u003c/h4\u003e\n\u003cp\u003eBrowse \u003ca href=\"https://github.com/gmacario/node-http-hmi-repository\"\u003ehttps://github.com/gmacario/node-http-hmi-repository\u003c/a\u003e\nand create a Pull Request from the branch you have just pushed\u003c/p\u003e\n\u003cp\u003eFrom \u003ca href=\"https://github.com/gmacario/node-http-hmi-repository/pull/2\"\u003ehttps://github.com/gmacario/node-http-hmi-repository/pull/2\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003ePR built and available in a preview environment \u003cstrong\u003egmacario-node-http-hmi-repository-pr-2\u003c/strong\u003e \u003ca href=\"http://node-http-hmi-repository.jx-gmacario-node-http-hmi-repository-pr-2.35.195.52.165.nip.io/\"\u003ehere\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eAfter the PR is merged to master, the change will be deployed to the staging environment.\u003c/p\u003e\n\u003cp\u003eYou may verify the progress of the pipelines with the following command\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-shell\"\u003ejx get build logs\n\u003c/code\u003e\u003c/pre\u003e\n\u003c!-- 2018-10-15 09:26 CEST --\u003e\n\n\u003cp\u003eIf we run the \u003ccode\u003ejx get apps\u003c/code\u003e command, we can see that version 0.0.2 has been deployed to the staging environment:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003egmacario@cloudshell:~ (kubernetes-workshop-218213)$ jx get apps\nAPPLICATION              STAGING PODS URL                                                             PRODUCTION PODS URL\nnode-http-hmi-repository 0.0.2   1/1  http://node-http-hmi-repository.jx-staging.35.195.52.165.nip.io\ngmacario@cloudshell:~ (kubernetes-workshop-218213)$\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eList the services in the development environment:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003egmacario@cloudshell:~ (kubernetes-workshop-218213)$ jx open\nName                      URL\njenkins                   http://jenkins.jx.35.195.52.165.nip.io\njenkins-x-chartmuseum     http://chartmuseum.jx.35.195.52.165.nip.io\njenkins-x-docker-registry http://docker-registry.jx.35.195.52.165.nip.io\njenkins-x-monocular-api   http://monocular.jx.35.195.52.165.nip.io\njenkins-x-monocular-ui    http://monocular.jx.35.195.52.165.nip.io\nnexus                     http://nexus.jx.35.195.52.165.nip.io\ngmacario@cloudshell:~ (kubernetes-workshop-218213)$\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eList the services in the staging environment:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003egmacario@cloudshell:~ (kubernetes-workshop-218213)$ jx open --env staging\nName                     URL\nnode-http-hmi-repository http://node-http-hmi-repository.jx-staging.35.195.52.165.nip.io\ngmacario@cloudshell:~ (kubernetes-workshop-218213)$\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eList the services in the production environment:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003egmacario@cloudshell:~ (kubernetes-workshop-218213)$ jx open --env production\nName URL\ngmacario@cloudshell:~ (kubernetes-workshop-218213)$\n\u003c/code\u003e\u003c/pre\u003e\n\u003c!-- 2018-10-15 09:58 CEST --\u003e\n\n\u003cp\u003eDisplay the activities for application \u0026quot;node-http-hmi-repository\u0026quot;\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-shell\"\u003ejx get activity -f node-http-hmi-repository\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eResult:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003egmacario@cloudshell:~/node-http-hmi-repository (kubernetes-workshop-218213)$ jx get activity -f node-http-hmi-repository\nSTEP                                                        STARTED AGO DURATION STATUS\ngmacario/node-http-hmi-repository/master #1                    65h2m37s    6m19s Succeeded Version: 0.0.1\n  Checkout Source                                              65h1m46s      11s Succeeded\n  CI Build and push snapshot                                   65h1m35s          NotExecuted\n  Build Release                                                65h1m34s    1m11s Succeeded\n  Promote to Environments                                      65h0m23s     4m4s Succeeded\n  Promote: staging                                            64h59m55s    3m29s Succeeded\n    PullRequest                                               64h59m55s     2m7s Succeeded  PullRequest: https://github.com/gmacario/environment-craftersaber-staging/pull/1 Merge SHA: f6c065ce56e1eb0e9f63def06b3cea2f9934c15a\n    Update                                                    64h57m48s    1m22s Succeeded  Status: Success at: http://jenkins.jx.35.195.52.165.nip.io/job/gmacario/job/environment-craftersaber-staging/job/master/4/display/redirect\n    Promoted                                                  64h57m48s    1m22s Succeeded  Application is at: http://node-http-hmi-repository.jx-staging.35.195.52.165.nip.io\n  Clean up                                                    64h56m19s       1s Succeeded\ngmacario/node-http-hmi-repository/master #2                    64h28m3s    4m25s Succeeded Version: 0.0.2\n  Checkout Source                                             64h27m35s       8s Succeeded\n  CI Build and push snapshot                                  64h27m27s          NotExecuted\n  Build Release                                               64h27m26s      47s Succeeded\n  Promote to Environments                                     64h26m39s     3m1s Succeeded\n  Promote: staging                                            64h26m12s    2m28s Succeeded\n    PullRequest                                               64h26m12s    1m26s Succeeded  PullRequest: https://github.com/gmacario/environment-craftersaber-staging/pull/2 Merge SHA: 032d965749c9abb38a1a17da94e71e0530413848\n    Update                                                    64h24m46s     1m2s Succeeded  Status: Success at: http://jenkins.jx.35.195.52.165.nip.io/job/gmacario/job/environment-craftersaber-staging/job/master/5/display/redirect\n    Promoted                                                  64h24m46s     1m2s Succeeded  Application is at: http://node-http-hmi-repository.jx-staging.35.195.52.165.nip.io\n  Clean up                                                    64h23m38s       0s Succeeded\ngmacario/node-http-hmi-repository/PR-2 #1                     64h31m13s    1m43s Succeeded\n  Checkout Source                                             64h30m45s       8s Succeeded\n  CI Build and push snapshot                                  64h30m37s     1m7s Succeeded\n  Preview                                                     64h29m31s           https://github.com/gmacario/node-http-hmi-repository/pull/2\n    Preview Application                                       64h29m31s           http://node-http-hmi-repository.jx-gmacario-node-http-hmi-repository-pr-2.35.195.52.165.nip.io\n  Build Release                                               64h29m30s          NotExecuted\n  Promote to Environments                                     64h29m30s          NotExecuted\n  Clean up                                                    64h29m30s       0s Succeeded\ngmacario@cloudshell:~/node-http-hmi-repository (kubernetes-workshop-218213)$\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch4 id=\"creating-a-devpod\"\u003eCreating a devpod\u003c/h4\u003e\n\u003c!-- 2018-10-15 10:18 CEST --\u003e\n\n\u003cpre\u003e\u003ccode class=\"language-shell\"\u003ejx create devpod\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eResult:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003egmacario@cloudshell:~/node-http-hmi-repository (kubernetes-workshop-218213)$ jx create devpod\nInstalling the ExposecontrollerService in the namespace: jx-edit-gmacario\nUpdating Helm repository...\nUsing helmBinary helm with feature flag: none\nHelm repository update done.\nCreating a DevPod of label: nodejs\nCreated pod gmacario-nodejs - waiting for it to be ready...\nUpdating Helm repository...\nHelm repository update done.\nPod gmacario-nodejs is now ready!\nYou can open other shells into this DevPod via jx create devpod\nYou can edit your app using Theia (a browser based IDE) at http://gmacario-nodejs-theia.jx.35.195.52.165.nip.io\nPort 80 is open on [http://gmacario-nodejs-port-3000.jx.35.195.52.165.nip.io http://gmacario-nodejs-port-9229.jx.35.195.52.165.nip.io] and forwarded to the devpod\nInstalling Bash Completion into DevPod\nDefaulting container name to nodejs.\nUse \u0026#39;kubectl describe pod/gmacario-nodejs -n jx\u0026#39; to see all of the containers in this pod.\nGenerated Git credentials file /home/jenkins/git/credentials\nCloning into \u0026#39;node-http-hmi-repository\u0026#39;...\nremote: Enumerating objects: 62, done.\nremote: Counting objects: 100% (62/62), done.\nremote: Compressing objects: 100% (40/40), done.\nremote: Total 62 (delta 15), reused 60 (delta 14), pack-reused 0\nUnpacking objects: 100% (62/62), done.\nChecking connectivity... done.\n[root@gmacario-nodejs node-http-hmi-repository]#\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThe command has now opened a devshell in my devpod.\nIt\u0026#39;s a bit like ssh-ing into my devpod.\u003c/p\u003e\n\u003cp\u003eIf I now type \u003ccode\u003edocker ps\u003c/code\u003e I will list the containers running on my Kubernetes cluster:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e[root@gmacario-nodejs node-http-hmi-repository]# docker ps\nCONTAINER ID        IMAGE                                                 COMMAND                  CREATED             STATUS              PORTS               NAMES\n4879c689cac6        jenkinsxio/builder-nodejs                             \u0026quot;/bin/sh -c cat\u0026quot;         10 minutes ago      Up 10 minutes                           k8s_nodejs_gmacario-nodejs_jx_1292aab6-d053-11e8-a13f-42010a84007c_0\n46c0a72de1a3        jenkinsxio/exposecontroller                           \u0026quot;/exposecontroller -…\u0026quot;   12 minutes ago      Up 12 minutes                           k8s_exposecontroller-service_exposecontroller-service-6b5bf9cc68-h47br_jx-edit-gmacario_127c8a9b-d053-11e8-a13f-42010a84007c_0\n6a3012ffa069        k8s.gcr.io/pause-amd64:3.1                            \u0026quot;/pause\u0026quot;                 12 minutes ago      Up 12 minutes                           k8s_POD_gmacario-nodejs_jx_1292aab6-d053-11e8-a13f-42010a84007c_0\n019cba949c7b        k8s.gcr.io/pause-amd64:3.1                            \u0026quot;/pause\u0026quot;                 12 minutes ago      Up 12 minutes                           k8s_POD_exposecontroller-service-6b5bf9cc68-h47br_jx-edit-gmacario_127c8a9b-d053-11e8-a13f-42010a84007c_0\na5349f2f3e1e        055e8e6ae33a                                          \u0026quot;/monitor --stackdri…\u0026quot;   2 days ago          Up 2 days                               k8s_prometheus-to-sd-exporter_fluentd-gcp-v3.1.0-l9swq_kube-system_1f1ac6d2-ceab-11e8-a13f-42010a84007c_0\n6952d5766cc4        gcr.io/stackdriver-agents/stackdriver-logging-agent   \u0026quot;/entrypoint.sh /usr…\u0026quot;   2 days ago          Up 2 days                               k8s_fluentd-gcp_fluentd-gcp-v3.1.0-l9swq_kube-system_1f1ac6d2-ceab-11e8-a13f-42010a84007c_0\n06794ae76980        k8s.gcr.io/pause-amd64:3.1                            \u0026quot;/pause\u0026quot;                 2 days ago          Up 2 days                               k8s_POD_fluentd-gcp-v3.1.0-l9swq_kube-system_1f1ac6d2-ceab-11e8-a13f-42010a84007c_0\n4919cf79de07        380b233f1574                                          \u0026quot;/bin/sh -c \u0026#39;exec ku…\u0026quot;   2 days ago          Up 2 days                               k8s_kube-proxy_kube-proxy-gke-craftersaber-default-pool-9203d5e5-xkws_kube-system_0cfe54e72c47cb3c4efc7f396ebbda85_0\nd0543cb37dfa        k8s.gcr.io/pause-amd64:3.1                            \u0026quot;/pause\u0026quot;                 2 days ago          Up 2 days                               k8s_POD_kube-proxy-gke-craftersaber-default-pool-9203d5e5-xkws_kube-system_0cfe54e72c47cb3c4efc7f396ebbda85_0\n[root@gmacario-nodejs node-http-hmi-repository]#\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThis command has also run the \u003ccode\u003eksync\u003c/code\u003e command.\n\u003ca href=\"https://vapor-ware.github.io/ksync\"\u003eKsync\u003c/a\u003e is an open source tool which syncs files from your local system to a specific container running in a Kubernetes cluster.\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e[root@gmacario-nodejs node-http-hmi-repository]# pwd\n/workspace/node-http-hmi-repository\n[root@gmacario-nodejs node-http-hmi-repository]# ls -la\ntotal 84\ndrwxr-xr-x 4 root root  4096 Oct 15 08:30 .\ndrwxrwxrwx 3 root root  4096 Oct 15 08:30 ..\ndrwxr-xr-x 4 root root  4096 Oct 15 08:30 charts\n-rwxr-xr-x 1 root root   122 Oct 15 08:30 curlloop.sh\n-rw-r--r-- 1 root root    93 Oct 15 08:30 Dockerfile\n-rw-r--r-- 1 root root    43 Oct 15 08:30 .dockerignore\ndrwxr-xr-x 8 root root  4096 Oct 15 08:30 .git\n-rw-r--r-- 1 root root   884 Oct 15 08:30 .gitignore\n-rw-r--r-- 1 root root   398 Oct 15 08:30 .helmignore\n-rw-r--r-- 1 root root   193 Oct 15 08:30 index.html\n-rw-r--r-- 1 root root  2620 Oct 15 08:30 Jenkinsfile\n-rw-r--r-- 1 root root 11357 Oct 15 08:30 LICENSE\n-rw-r--r-- 1 root root    44 Oct 15 08:30 OWNERS\n-rw-r--r-- 1 root root    74 Oct 15 08:30 OWNERS_ALIASES\n-rw-r--r-- 1 root root   244 Oct 15 08:30 package.json\n-rw-r--r-- 1 root root    59 Oct 15 08:30 README.md\n-rw-r--r-- 1 root root   419 Oct 15 08:30 server.js\n-rw-r--r-- 1 root root   760 Oct 15 08:30 skaffold.yaml\n-rwxr-xr-x 1 root root   179 Oct 15 08:30 watch.sh\n[root@gmacario-nodejs node-http-hmi-repository]#\n\u003c/code\u003e\u003c/pre\u003e\n\u003c!-- FIXME: jx sync returns \"ksync version mismatch\" --\u003e\n\n\u003cpre\u003e\u003ccode class=\"language-shell\"\u003ecd ~/node-http-hmi-repository\njx sync\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eResult:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003egmacario@cloudshell:~/node-http-hmi-repository (kubernetes-workshop-218213)$ jx sync\nksync is already available on your PATH at /home/gmacario/.jx/bin/ksync\nLooks like \u0026#39;ksync watch\u0026#39; is not running: Command failed \u0026#39;ksync get\u0026#39;: time=\u0026quot;2018-10-15T11:43:28+02:00\u0026quot; level=fatal msg=\u0026quot;Having problems querying status. Are you running watch?\u0026quot; exit status 1\nStarted the ksync watch\nINFO[0000] listening                                     bind=127.0.0.1 port=40322\nINFO[0003] syncthing listening                           port=8384 syncthing=localhost\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch4 id=\"promote-to-production\"\u003ePromote to production\u003c/h4\u003e\n\u003c!-- 2018-10-16 10:30 CEST --\u003e\n\n\u003cp\u003eThe promotion to the production environment should be performed by an user with the proper permissions to create and merge Pull Request to repository \u003ca href=\"https://github.com/gmacario/environment-howlernoon-production\"\u003ehttps://github.com/gmacario/environment-howlernoon-production\u003c/a\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-shell\"\u003ecd ~/node-http-hmi-repository\ngit status\njx promote --version 0.0.3 --env production\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eResult:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003egmacario@cloudshell:~/node-http-hmi-repository (kubernetes-workshop-218213)$ jx promote --version 0.0.3 --env production\nUsing helmBinary helm with feature flag: none\nPromoting app node-http-hmi-repository version 0.0.3 to namespace jx-production\npipeline gmacario/node-http-hmi-repository/master\nUsername for \u0026#39;https://github.com\u0026#39;: gmacario\nPassword for \u0026#39;https://gmacario@github.com\u0026#39;:\n? Do you wish to use gmacario as the user name to submit the Pull Request Yes\nCreated Pull Request: https://github.com/gmacario/environment-howlernoon-production/pull/2\npipeline gmacario/node-http-hmi-repository/master\nFailed to query the Pull Request last commit status for https://github.com/gmacario/environment-howlernoon-production/pull/2 ref 27758a287b0b389a43477f099d8d8d23a6f32e52 Could not find a status for repository gmacario/environment-howlernoon-production with ref 27758a287b0b389a43477f099d8d8d23a6f32e52\nFailed to query the Pull Request last commit status for https://github.com/gmacario/environment-howlernoon-production/pull/2 ref 27758a287b0b389a43477f099d8d8d23a6f32e52 Could not find a status for repository gmacario/environment-howlernoon-production with ref 27758a287b0b389a43477f099d8d8d23a6f32e52\nPull Request https://github.com/gmacario/environment-howlernoon-production/pull/2 is merged at sha 9d64dad34d425d90b846b3bfdcf5904f9ed017cd\nMerge commit has not yet any statuses on repo gmacario/environment-howlernoon-production merge sha 9d64dad34d425d90b846b3bfdcf5904f9ed017cd\nmerge status: pending for URL https://api.github.com/repos/gmacario/environment-howlernoon-production/statuses/9d64dad34d425d90b846b3bfdcf5904f9ed017cd with target: http://jenkins.jx.35.195.140.178.nip.io/job/gmacario/job/environment-howlernoon-production/job/master/3/display/redirect description: This commit is being built\nmerge status: success for URL https://api.github.com/repos/gmacario/environment-howlernoon-production/statuses/9d64dad34d425d90b846b3bfdcf5904f9ed017cd with target: http://jenkins.jx.35.195.140.178.nip.io/job/gmacario/job/environment-howlernoon-production/job/master/3/display/redirect description: This commit looks good\nMerge status checks all passed so the promotion worked!\n? Do you wish to use gmacario as the user name to comment on issues Yes\nCommenting that issue https://github.com/gmacario/node-http-hmi-repository/issues/1 is now in Production\ngmacario@cloudshell:~/node-http-hmi-repository (kubernetes-workshop-218213)$\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eYou may follow the progress of the PR at \u003ca href=\"https://github.com/gmacario/environment-howlernoon-production/pull/2\"\u003ehttps://github.com/gmacario/environment-howlernoon-production/pull/2\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eVerify that release 0.0.3 of \u003ccode\u003enode-http-hmi-repository\u003c/code\u003e has been deployed in production:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003egmacario@cloudshell:~/node-http-hmi-repository (kubernetes-workshop-218213)$ jx get apps -e production\nAPPLICATION              PRODUCTION PODS URL\nnode-http-hmi-repository 0.0.3      1/1  http://node-http-hmi-repository.jx-production.35.195.140.178.nip.io\ngmacario@cloudshell:~/node-http-hmi-repository (kubernetes-workshop-218213)$\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eBrowse the production environment of \u0026quot;node-http-hmi-repository\u0026quot; at\n\u003ca href=\"http://node-http-hmi-repository.jx-production.35.195.140.178.nip.io/\"\u003ehttp://node-http-hmi-repository.jx-production.35.195.140.178.nip.io/\u003c/a\u003e\u003c/p\u003e\n\u003ch3 id=\"things-which-do-not-yet-work-as-expected\"\u003eThings which do not yet work as expected\u003c/h3\u003e\n\u003c!-- FIXME: Browsing theia URL returns \"403 Service Unavailable\" --\u003e\n\n\u003ch4 id=\"browse-monocular-instance\"\u003eBrowse Monocular instance\u003c/h4\u003e\n\u003cpre\u003e\u003ccode class=\"language-shell\"\u003ejx open\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eBrowse \u003ca href=\"http://monocular.jx.35.195.140.178.nip.io/\"\u003ehttp://monocular.jx.35.195.140.178.nip.io/\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eThe page seems to hang after displaying title.\nMaybe is this due to \u003ca href=\"https://github.com/jenkins-x/jx/issues/1417\"\u003ejx issues/1417\u003c/a\u003e?\u003c/p\u003e\n\u003c!--\nTODO TODO TODO\n\n```shell\njx get env\n```\n\n```shell\njx env production\n```\n\nResult:\n\n```\nTODO\n```\n--\u003e\n\n\u003c!--\n#### Run `TODO`\n\nCommand\n\n```shell\nTODO\n```\n\nResult\n\n```\nTODO\n```\n\nTODO TODO\n--\u003e\n\n\u003ch3 id=\"summary\"\u003eSummary\u003c/h3\u003e\n\u003cp\u003eThis article explained how to perform CI/CD of a Node.JS web application on a Kubernetes cluster using Jenkins X.\u003c/p\u003e\n\u003cp\u003eJenkins X is quite recent and therefore presents a few rough edges as the list of \u003ca href=\"https://github.com/jenkins-x/jx/issues\"\u003eissues on GitHub\u003c/a\u003e can testify, however it shows great potential to represent a very helpful tool for making the journey of application developers to Kubernetes smoother.\u003c/p\u003e\n\u003ch3 id=\"see-also\"\u003eSee also\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://jenkins-x.io/\"\u003ehttps://jenkins-x.io/\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://jenkins.io/projects/jenkins-x/\"\u003ehttps://jenkins.io/projects/jenkins-x/\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://youtu.be/UTKIT6STSVM\"\u003eJenkins X: Easy CI/CD for Kubernetes - James Strachan, CloudBees (Intermediate Skill Level)\u003c/a\u003e (YouTube Video, 34:55)\u003c/li\u003e\n\u003c/ul\u003e\n\u003c!--\n* [Jenkins X - Automated CI/CD for Kubernetes](https://www.cloudbees.com/resource/webinar-recording/ondemand-webinar-easy-cicd-kubernetes/thank-you)\n--\u003e\n\n\u003c!-- markdown-link-check-enable --\u003e\n\u003c!-- EOF --\u003e\n"},"config":{"title":"gmacario.github.io","description":"Gianpaolo Macario's public rants","social":{"github":{"name":"gmacario","link":"https://github.com/gmacario"},"twitter":{"name":"gpmacario","link":"https://www.twitter.com/gpmacario"}}}},"__N_SSG":true},"page":"/posts/[slug]","query":{"slug":"2018-10-16-test-hello-node-on-jx"},"buildId":"9LgOlgVgpDkRFKODy_W2s","runtimeConfig":{},"isFallback":false,"gsp":true}</script><script nomodule="" src="/_next/static/chunks/polyfills-144e5fa6fafab6397d9c.js"></script><script src="/_next/static/chunks/webpack-50bee04d1dc61f8adf5b.js" async=""></script><script src="/_next/static/chunks/framework.1a5e6c0bcaecf178eee2.js" async=""></script><script src="/_next/static/chunks/commons.a817edd9b2693fcc6af8.js" async=""></script><script src="/_next/static/chunks/main-daaff4f95c13923f49a5.js" async=""></script><script src="/_next/static/chunks/pages/_app-041b1432faef8bf5f62a.js" async=""></script><script src="/_next/static/chunks/b38cc82cec06c0ea8b096def674947a423bb2764.260eb1ac110a53311620.js" async=""></script><script src="/_next/static/chunks/pages/posts/%5Bslug%5D-1c9a30b06d2f3be2ac9c.js" async=""></script><script src="/_next/static/9LgOlgVgpDkRFKODy_W2s/_buildManifest.js" async=""></script><script src="/_next/static/9LgOlgVgpDkRFKODy_W2s/_ssgManifest.js" async=""></script></body></html>