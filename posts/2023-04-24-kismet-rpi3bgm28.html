<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><meta name="description" content="Gianpaolo Macario&#x27;s public rants"/><title>Running Kismet on a Raspberry Pi</title><meta name="next-head-count" content="4"/><link rel="preload" href="/_next/static/css/08fafe92abad983f984c.css" as="style"/><link rel="stylesheet" href="/_next/static/css/08fafe92abad983f984c.css" data-n-g=""/><noscript data-n-css=""></noscript><link rel="preload" href="/_next/static/chunks/webpack-50bee04d1dc61f8adf5b.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework.1a5e6c0bcaecf178eee2.js" as="script"/><link rel="preload" href="/_next/static/chunks/commons.a817edd9b2693fcc6af8.js" as="script"/><link rel="preload" href="/_next/static/chunks/main-daaff4f95c13923f49a5.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/_app-041b1432faef8bf5f62a.js" as="script"/><link rel="preload" href="/_next/static/chunks/b38cc82cec06c0ea8b096def674947a423bb2764.260eb1ac110a53311620.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/posts/%5Bslug%5D-1c9a30b06d2f3be2ac9c.js" as="script"/></head><body><div id="__next"><main class="h-screen flex flex-col"><header class="py-3 fixed top-0 z-50 flex flex-wrap justify-between w-screen bg-white border-b border-gray-200"><div class="mx-3 py-2 px-4  font-bold text-indigo-500">Gianpaolo Macario&#x27;s blog</div><div class="justify-end"><a class="mr-6 py-2 px-4 inline-block rounded h-full text-indigo-500 hover:text-white hover:bg-indigo-500" href="/">Home</a><a class="mr-6 py-2 px-4 inline-block rounded h-full text-indigo-500 hover:text-white hover:bg-indigo-500" href="/posts">Posts</a></div></header><div class="pt-28 mx-auto w-5/6 break-words flex flex-grow prose prose-indigo hover:prose-black md:prose-lg lg:prose-xl"><article><h1>Running Kismet on a Raspberry Pi</h1><div class="prose prose-indigo hover:prose-black md:prose-lg lg:prose-xl"><h2 id="introduction">Introduction</h2>
<p>This post describes how to install <a href="https://www.kismetwireless.net/">Kismet</a> on a Linux host, then use the program to perform some &quot;network intelligence&quot;.</p>
<p><img src="https://user-images.githubusercontent.com/75182/236668176-cfafef6f-2652-422e-a7a6-5c06e84555cc.png" alt="image"></p>
<h2 id="requirements">Requirements</h2>
<ul>
<li>A host running a recent Debian-based distribution.
Tested on <code>rpi3bgm28</code> - a <a href="https://www.raspberrypi.com/products/raspberry-pi-3-model-b/">Raspberry Pi 3 Model B</a> running <a href="https://www.raspberrypi.com/software/">Raspberry Pi OS Lite</a> 64-bit (bullseye)</li>
<li>A Wi-Fi adapter which supports monitor mode. Tested with a <a href="https://support.dlink.com/ProductInfo.aspx?m=DWL-G122">D-Link DWL-G122</a> Wireless-G USB Dongle</li>
</ul>
<h2 id="step-by-step-instructions">Step-by-step instructions</h2>
<p>Login to the Raspberry Pi via SSH:</p>
<pre><code class="language-bash">ssh rpi3bgm28
</code></pre>
<p>Check the version of the installed OS</p>
<pre><code class="language-bash">uname -a
lsb_release -a
</code></pre>
<p>Result</p>
<pre><code class="language-text">gmacario@rpi3bgm28:~ $ uname -a
Linux rpi3bgm28 6.1.21-v8+ #1642 SMP PREEMPT Mon Apr  3 17:24:16 BST 2023 aarch64 GNU/Linux
gmacario@rpi3bgm28:~ $ lsb_release -a
No LSB modules are available.
Distributor ID: Debian
Description:    Debian GNU/Linux 11 (bullseye)
Release:        11
Codename:       bullseye
gmacario@rpi3bgm28:~ $
</code></pre>
<p>In our case we are running <a href="https://www.raspberrypi.com/software/">Raspberry Pi OS Lite</a>:</p>
<ul>
<li>System: 64-bit (arch=<code>aarch64</code>)</li>
<li>Debian Release: 11 (bullseye)</li>
</ul>
<p>Make sure the distribution is up-to-date</p>
<pre><code class="language-bash">sudo apt-get update \
  &amp;&amp; sudo apt-get -y dist-upgrade \
  &amp;&amp; sudo apt-get -y autoremove --purge
</code></pre>
<p>Install Kismet following the instructions at <a href="https://www.kismetwireless.net/packages/">https://www.kismetwireless.net/packages/</a> (use the one which corresponds to the installed OS)</p>
<pre><code class="language-bash">wget -O - https://www.kismetwireless.net/repos/kismet-release.gpg.key --quiet | gpg --dearmor | sudo tee /usr/share/keyrings/kismet-archive-keyring.gpg &gt;/dev/null
echo &#39;deb [signed-by=/usr/share/keyrings/kismet-archive-keyring.gpg] https://www.kismetwireless.net/repos/apt/release/bullseye bullseye main&#39; | sudo tee /etc/apt/sources.list.d/kismet.list &gt;/dev/null
sudo apt update
sudo apt install kismet
</code></pre>
<p>Provide the following answers when requested:</p>
<ul>
<li>Do you want to continue? Y</li>
<li>Should Kismet be installed with suid-root helpers? Yes</li>
</ul>
<p>Verify that Kismet has been installed correctly:</p>
<pre><code class="language-text">gmacario@rpi3bgm28:~ $ kismet --version
Kismet 2022-08-R1
gmacario@rpi3bgm28:~ $
</code></pre>
<p>Add current user to group <code>kismet</code>:</p>
<pre><code class="language-bash">sudo usermod -aG kismet $USER
newgrp kismet
</code></pre>
<p>Logged in as <code>gmacario@rpi3bgm28</code>, type <code>iwconfig</code> to list the existing Wireless interfaces.</p>
<pre><code class="language-text">gmacario@rpi3bgm28:~ $ iwconfig
lo        no wireless extensions.

eth0      no wireless extensions.

wlan0     IEEE 802.11  ESSID:&quot;Galaxy A32 gpmacario&quot;
          Mode:Managed  Frequency:2.437 GHz  Access Point: A6:B5:89:FE:22:0D
          Bit Rate=65 Mb/s   Tx-Power=31 dBm
          Retry short limit:7   RTS thr:off   Fragment thr:off
          Power Management:on
          Link Quality=57/70  Signal level=-53 dBm
          Rx invalid nwid:0  Rx invalid crypt:0  Rx invalid frag:0
          Tx excessive retries:0  Invalid misc:0   Missed beacon:0

tailscale0  no wireless extensions.

docker0   no wireless extensions.

gmacario@rpi3bgm28:~ $
</code></pre>
<p>Now insert the <a href="https://support.dlink.com/ProductInfo.aspx?m=DWL-G122">D-Link DWL-G122</a>
into one USB port of the Raspberry Pi.</p>
<p>Execute the <code>iwconfig</code> command again and verify that the Wi-Fi USB dongle gets recognized.
Take note of the new interface name (in our case, this is <code>wlan1</code>):</p>
<pre><code class="language-text">gmacario@rpi3bgm28:~ $ iwconfig
lo        no wireless extensions.

eth0      no wireless extensions.

wlan0     IEEE 802.11  ESSID:&quot;Galaxy A32 gpmacario&quot;
          Mode:Managed  Frequency:2.437 GHz  Access Point: A6:B5:89:FE:22:0D
          Bit Rate=72.2 Mb/s   Tx-Power=31 dBm
          Retry short limit:7   RTS thr:off   Fragment thr:off
          Power Management:on
          Link Quality=56/70  Signal level=-54 dBm
          Rx invalid nwid:0  Rx invalid crypt:0  Rx invalid frag:0
          Tx excessive retries:0  Invalid misc:0   Missed beacon:0

tailscale0  no wireless extensions.

docker0   no wireless extensions.

wlan1     IEEE 802.11  ESSID:&quot;Galaxy A32 gpmacario&quot;
          Mode:Managed  Frequency:2.437 GHz  Access Point: A6:B5:89:FE:22:0D
          Bit Rate=54 Mb/s   Tx-Power=20 dBm
          Retry short limit:7   RTS thr:off   Fragment thr:off
          Power Management:on
          Link Quality=62/70  Signal level=-48 dBm
          Rx invalid nwid:0  Rx invalid crypt:0  Rx invalid frag:0
          Tx excessive retries:0  Invalid misc:21   Missed beacon:0

gmacario@rpi3bgm28:~ $
</code></pre>
<p>Launch Kismet and configure it to use new Wi-Fi interface as datasource:</p>
<pre><code class="language-bash">kismet -c wlan1
</code></pre>
<p>Result:</p>
<pre><code class="language-text">gmacario@rpi3bgm28:~ $ kismet -c wlan1
INFO: Including sub-config file: /etc/kismet/kismet_httpd.conf
INFO: Including sub-config file: /etc/kismet/kismet_memory.conf
INFO: Including sub-config file: /etc/kismet/kismet_alerts.conf
INFO: Including sub-config file: /etc/kismet/kismet_80211.conf
INFO: Including sub-config file: /etc/kismet/kismet_logging.conf
INFO: Including sub-config file: /etc/kismet/kismet_filter.conf
INFO: Including sub-config file: /etc/kismet/kismet_uav.conf
INFO: Loading config override file &#39;/etc/kismet/kismet_package.conf&#39;
INFO: Optional sub-config file not present: /etc/kismet/kismet_package.conf
INFO: Loading config override file &#39;/etc/kismet/kismet_site.conf&#39;
INFO: Optional sub-config file not present: /etc/kismet/kismet_site.conf
KISMET - Point your browser to http://localhost:2501 (or the address of this system) for the INFO: Keeping EAPOL packets in memory for easy download and WIDS
      functionality; this can use more RAM.
INFO: Registered PHY handler &#39;IEEE802.11&#39; as ID 0
INFO: Registered PHY handler &#39;RTL433&#39; as ID 1
INFO: Registered PHY handler &#39;Z-Wave&#39; as ID 2
INFO: Registered PHY handler &#39;Bluetooth&#39; as ID 3
INFO: Registered PHY handler &#39;UAV&#39; as ID 4
INFO: Registered PHY handler &#39;NrfMousejack&#39; as ID 5
INFO: Using default rates of 10/min, 1/sec for alert &#39;BLEEDINGTOOTH&#39;
INFO: Registered PHY handler &#39;BTLE&#39; as ID 6
INFO: Registered PHY handler &#39;METER&#39; as ID 7
INFO: Indexing ADSB ICAO db
INFO: Completed indexing ADSB ICAO db, 322278 lines 6446 indexes
INFO: Registered PHY handler &#39;ADSB&#39; as ID 8
INFO: Registered PHY handler &#39;802.15.4&#39; as ID 9
INFO: Registered PHY handler &#39;RADIATION&#39; as ID 10
INFO: Serving static file content from /usr/share/kismet/httpd/
INFO: Enabling channel hopping by default on sources which support channel
      control.
INFO: Setting default channel hop rate to 5/sec
INFO: Enabling channel list splitting on sources which share the same list
      of channels
INFO: Enabling channel list shuffling to optimize overlaps
INFO: Sources will be re-opened if they encounter an error
INFO: Saving datasources to the Kismet database log every 30 seconds.
INFO: Launching remote capture server on 127.0.0.1 3501
INFO: Data sources passed on the command line (via -c source), ignoring
      source= definitions in the Kismet config file.
INFO: Probing interface &#39;wlan1&#39; to find datasource type
INFO: Opened kismetdb log file &#39;.//Kismet-20230424-12-35-40-1.kismet&#39;
INFO: Saving packets to the Kismet database log.
INFO: GPS track will be logged to the Kismet logfile
INFO: Starting Kismet web server...
INFO: HTTP server listening on 0.0.0.0:2501
INFO: Could not open system plugin directory (/usr/lib/kismet/), skipping:
      No such file or directory
INFO: Did not find a user plugin directory (/home/gmacario/.kismet//plugins
      /), skipping: No such file or directory
INFO: Found type &#39;linuxwifi&#39; for &#39;wlan1&#39;
INFO: wlan1 bringing down parent interface &#39;wlan1&#39;
INFO: wlan1 finished configuring wlan1mon, ready to capture
INFO: Data source &#39;wlan1&#39; launched successfully
</code></pre>
<p>Browse <a href="http://rpi3bgm28:2501">http://rpi3bgm28:2501</a> to access Kismet web UI.</p>
<p>The first time you access the web UI, the following questions will be displayed:</p>
<blockquote>
<p><strong>Set Login</strong></p>
<p>To finish setting up Kismet, you need to configure a login.</p>
<p>This login will be stored in <code>.kismet/kismet_httpd.conf</code> in the
<em>home directory of the user who launched Kismet</em>;
This server is running as gmacario, and the login will be saved
in <code>~gmacario/.kismet/kismet_httpd.conf</code>.</p>
<p>Set Login</p>
<ul>
<li>User name: ...</li>
<li>Password: ...</li>
<li>Confirm: ...</li>
</ul>
</blockquote>
<p>Fill in the requested information, then click &quot;Save&quot;.</p>
<blockquote>
<p><strong>Welcome</strong></p>
<p>Welcome!</p>
<p>This is the first time you&#39;ve used this Kismet server in this browser.</p>
<p>Kismet stores local settings in the HTML5 storage of your browser.</p>
<p>You should configure your preferences and login settings in the settings panel!</p>
<p>Settings | Continue</p>
</blockquote>
<!-- TODO -->

<h3 id="runtime-censorship">Runtime censorship</h3>
<p>Kismet can be configured to censor some information - such as the last digits of MAC address or SSID - displayed in the web UI, in order to make it easier to share screenshots or demos without revealing sensitive data.</p>
<p>Censorship mode can be enabled by adding <code>?censor=1</code> to Kismet URL, for instance
<a href="http://localhost:2501/?censor=1">http://localhost:2501/?censor=1</a> or <a href="http://rpi3bgm28:2501/?censor=1">http://rpi3bgm28:2501/?censor=1</a></p>
<!-- TODO: Screenshot -->

<p>Reference: <a href="https://www.kismetwireless.net/docs/readme/configuring/webserver/">https://www.kismetwireless.net/docs/readme/configuring/webserver/</a></p>
<!--
TODO: Try enabling Data Source hci0
(should not be connected via wlab0, though)

See also:
- <https://www.kismetwireless.net/docs/readme/datasources/datasources/>
- <https://www.kismetwireless.net/docs/readme/datasources/bluetooth-hci-bluetooth/>

Kismet web UI: Data Sources > TODO

kismet -c hci0
-->

<h3 id="export-kismet-files-to-pcap">Export <code>*.kismet</code> files to <code>*.pcap</code></h3>
<pre><code class="language-bash">gmacario@rpi3bgm28:~ $ kismetdb_to_pcap \
    --in Kismet-20230424-12-57-23-1.kismet \
    --out Kismet-20230424-12-57-23-1.kismet.pcap
Done...
gmacario@rpi3bgm28:~ $ ls -la Kismet-20230424-12-57-23-1.kismet*
-rw-r--r-- 1 gmacario gmacario 9347072 Apr 24 15:17 Kismet-20230424-12-57-23-1.kismet
-rw-r--r-- 1 gmacario gmacario 3575696 Apr 24 15:17 Kismet-20230424-12-57-23-1.kismet.pcap
gmacario@rpi3bgm28:~ $
</code></pre>
<p>You may then open the generated <code>*.pcap</code> file using a suitable tool, for instance <a href="https://www.wireshark.org/">Wireshark</a>.</p>
<!-- TODO: Screenshot -->

<h3 id="recovering-lost-passwords">Recovering lost passwords</h3>
<p>After converting <code>*.kismet</code> to <code>*.pcap</code> using the <code>kismetdb_to_pcap</code> tool,
browse <a href="https://hashcat.net/cap2hashcat/">https://hashcat.net/cap2hashcat/</a> and upload the <code>*.pcap</code> file.</p>
<p>The tool will verify the <code>*.pcap</code> file and convert it to a format
suitable for the <a href="https://hashcat.net/hashcat/">hashcat</a> tool.</p>
<!-- TODO -->

<h3 id="optional-add-location-data-to-kismet-reports">(Optional) Add location data to Kismet reports</h3>
<p>Reference: <a href="https://www.kismetwireless.net/docs/readme/gps/gps_gpsd/">https://www.kismetwireless.net/docs/readme/gps/gps_gpsd/</a></p>
<p>If you have a GPS (for instance, <a href="https://www.amazon.com/Receiver-Antenna-Gmouse-Laptop-Navigation/dp/B073P3Y48Q">this one</a>) available and follow the instruction in this section, you will be able to augment Kismet reports with actual location information.</p>
<p><strong>NOTE</strong>: WORK-IN-PROGRESS</p>
<h4 id="install-gpsd">Install GPSD</h4>
<p>Following the instructions at <a href="https://gpsd.gitlab.io/gpsd/installation.html">https://gpsd.gitlab.io/gpsd/installation.html</a>,
connect a USB GPS into an empty USB port of the Raspberry Pi.</p>
<p>Verify with <code>sudo dmesg -w</code> that the GPS is correctly recognized:</p>
<pre><code class="language-text">[494743.803508] usb 1-1.2: new full-speed USB device number 5 using dwc_otg
[494743.905774] usb 1-1.2: New USB device found, idVendor=067b, idProduct=2303, bcdDevice= 3.00
[494743.905806] usb 1-1.2: New USB device strings: Mfr=1, Product=2, SerialNumber=0
[494743.905820] usb 1-1.2: Product: USB-Serial Controller
[494743.905831] usb 1-1.2: Manufacturer: Prolific Technology Inc.
[494744.259635] usbcore: registered new interface driver usbserial_generic
[494744.259789] usbserial: USB Serial support registered for generic
[494744.270315] usbcore: registered new interface driver pl2303
[494744.270427] usbserial: USB Serial support registered for pl2303
[494744.270591] pl2303 1-1.2:1.0: pl2303 converter detected
[494744.277325] usb 1-1.2: pl2303 converter now attached to ttyUSB0
</code></pre>
<p>Verify that the character device has been created correctly:</p>
<pre><code class="language-text">gmacario@rpi3bgm28:~ $ ls -la /dev/ttyUSB0
crw-rw---- 1 root dialout 188, 0 May  7 15:15 /dev/ttyUSB0
gmacario@rpi3bgm28:~ $
</code></pre>
<p>If you are not running as root ensure that the user is of the group owning the device:</p>
<pre><code class="language-bash">sudo usermod -aG dialout $USER
newgrp dialout
</code></pre>
<p>Make sure you can get data from your GPS (replace <code>ttyXXX</code> with the filename of the port detected by <code>dmesg</code>):</p>
<pre><code class="language-bash">stty -F /dev/ttyXXX ispeed 4800 &amp;&amp; cat &lt;/dev/ttyXXX
</code></pre>
<p>Example:</p>
<pre><code class="language-text">gmacario@rpi3bgm28:~ $ stty -F /dev/ttyUSB0 ispeed 4800 &amp;&amp; cat &lt;/dev/ttyUSB0
3▒F▒▒f▒▒▒f▒▒▒▒SF6k
$GPVTG,,T,,M,,N,,K,N*2C

$GPGGA,001012.039,,,,,0,00,,,M,0.0,M,,0000*5E

$GPGSA,A,1,,,,,,,,,,,,,,,*1E

$GPRMC,001012.039,V,,,,,,,291006,,,N*49

$GPVTG,,T,,M,,N,,K,N*2C

$GPGGA,001013.039,,,,,0,00,,,M,0.0,M,,0000*5F

$GPGSA,A,1,,,,,,,,,,,,,,,*1E

$GPRMC,001013.039,V,,,,,,,291006,,,N*48

$GPVTG,,T,,M,,N,,K,N*2C

^C
gmacario@rpi3bgm28:~ $
</code></pre>
<p>Install <code>gpsd</code> and <code>gpsd-clients</code> (the second package is optional but will make troubleshooting easier):</p>
<pre><code class="language-bash">sudo apt install gpsd
sudo apt install gpsd-clients
</code></pre>
<p>Reboot the Raspberry Pi to verify that the GPSD service automatically starts at boot.</p>
<h4 id="test-gpsd">Test GPSD</h4>
<p>Connect to port 2947 on localhost. You should be greeted with a JSON message returning the version of GPSD which is correctly running:</p>
<pre><code class="language-text">gmacario@rpi3bgm28:~ $ tailscale nc localhost 2947
{&quot;class&quot;:&quot;VERSION&quot;,&quot;release&quot;:&quot;3.22&quot;,&quot;rev&quot;:&quot;3.22&quot;,&quot;proto_major&quot;:3,&quot;proto_minor&quot;:14}
</code></pre>
<p>Now start raw and watcher modes. After a few minutes you should start receiving GPS reports:</p>
<pre><code class="language-text">?WATCH={&quot;enable&quot;:true,&quot;json&quot;:true};
{&quot;class&quot;:&quot;DEVICES&quot;,&quot;devices&quot;:[{&quot;class&quot;:&quot;DEVICE&quot;,&quot;path&quot;:&quot;/dev/ttyUSB0&quot;,&quot;activated&quot;:&quot;2023-05-07T13:34:29.463Z&quot;,&quot;native&quot;:0,&quot;bps&quot;:9600,&quot;parity&quot;:&quot;N&quot;,&quot;stopbits&quot;:1,&quot;cycle&quot;:1.00}]}
{&quot;class&quot;:&quot;WATCH&quot;,&quot;enable&quot;:true,&quot;json&quot;:true,&quot;nmea&quot;:false,&quot;raw&quot;:0,&quot;scaled&quot;:false,&quot;timing&quot;:false,&quot;split24&quot;:false,&quot;pps&quot;:false}
{&quot;class&quot;:&quot;DEVICE&quot;,&quot;path&quot;:&quot;/dev/ttyUSB0&quot;,&quot;driver&quot;:&quot;NMEA0183&quot;,&quot;activated&quot;:&quot;2023-05-07T13:35:03.168Z&quot;,&quot;native&quot;:0,&quot;bps&quot;:4800,&quot;parity&quot;:&quot;N&quot;,&quot;stopbits&quot;:1,&quot;cycle&quot;:1.00}
{&quot;class&quot;:&quot;TPV&quot;,&quot;device&quot;:&quot;/dev/ttyUSB0&quot;,&quot;mode&quot;:1}
{&quot;class&quot;:&quot;TPV&quot;,&quot;device&quot;:&quot;/dev/ttyUSB0&quot;,&quot;mode&quot;:1}
{&quot;class&quot;:&quot;TPV&quot;,&quot;device&quot;:&quot;/dev/ttyUSB0&quot;,&quot;mode&quot;:1}
{&quot;class&quot;:&quot;DEVICE&quot;,&quot;path&quot;:&quot;/dev/ttyUSB0&quot;,&quot;driver&quot;:&quot;SiRF&quot;,&quot;activated&quot;:&quot;2023-05-07T13:35:04.277Z&quot;,&quot;flags&quot;:1,&quot;native&quot;:1,&quot;bps&quot;:4800,&quot;parity&quot;:&quot;N&quot;,&quot;stopbits&quot;:1,&quot;cycle&quot;:1.00}
{&quot;class&quot;:&quot;SKY&quot;,&quot;device&quot;:&quot;/dev/ttyUSB0&quot;,&quot;time&quot;:&quot;2026-06-14T00:04:20.040Z&quot;,&quot;nSat&quot;:0,&quot;uSat&quot;:0}
{&quot;class&quot;:&quot;TPV&quot;,&quot;device&quot;:&quot;/dev/ttyUSB0&quot;,&quot;mode&quot;:1,&quot;time&quot;:&quot;2026-06-14T00:04:20.040Z&quot;,&quot;ept&quot;:0.005}
{&quot;class&quot;:&quot;DEVICE&quot;,&quot;path&quot;:&quot;/dev/ttyUSB0&quot;,&quot;driver&quot;:&quot;SiRF&quot;,&quot;subtype&quot;:&quot;GSW3.2.4-SDK_3.1.00.12-SDK001P1.00 &quot;,&quot;activated&quot;:&quot;2023-05-07T13:35:05.183Z&quot;,&quot;flags&quot;:1,&quot;native&quot;:1,&quot;bps&quot;:4800,&quot;parity&quot;:&quot;N&quot;,&quot;stopbits&quot;:1,&quot;cycle&quot;:1.00}
{&quot;class&quot;:&quot;DEVICE&quot;,&quot;path&quot;:&quot;/dev/ttyUSB0&quot;,&quot;driver&quot;:&quot;SiRF&quot;,&quot;subtype&quot;:&quot;GSW3.2.4-SDK_3.1.00.12-SDK001P1.00 &quot;,&quot;activated&quot;:&quot;2023-05-07T13:35:05.309Z&quot;,&quot;flags&quot;:1,&quot;native&quot;:1,&quot;bps&quot;:4800,&quot;parity&quot;:&quot;N&quot;,&quot;stopbits&quot;:1,&quot;cycle&quot;:1.00}
{&quot;class&quot;:&quot;SKY&quot;,&quot;device&quot;:&quot;/dev/ttyUSB0&quot;,&quot;time&quot;:&quot;2026-06-14T00:04:21.040Z&quot;,&quot;hdop&quot;:0.00,&quot;nSat&quot;:0,&quot;uSat&quot;:0}
{&quot;class&quot;:&quot;TPV&quot;,&quot;device&quot;:&quot;/dev/ttyUSB0&quot;,&quot;mode&quot;:1,&quot;time&quot;:&quot;2026-06-14T00:04:21.040Z&quot;,&quot;ept&quot;:0.005}
{&quot;class&quot;:&quot;DEVICE&quot;,&quot;path&quot;:&quot;/dev/ttyUSB0&quot;,&quot;driver&quot;:&quot;SiRF&quot;,&quot;subtype&quot;:&quot;GSW3.2.4-SDK_3.1.00.12-SDK001P1.00 &quot;,&quot;activated&quot;:&quot;2023-05-07T13:35:06.463Z&quot;,&quot;flags&quot;:1,&quot;native&quot;:1,&quot;bps&quot;:4800,&quot;parity&quot;:&quot;N&quot;,&quot;stopbits&quot;:1,&quot;cycle&quot;:1.00}
{&quot;class&quot;:&quot;SKY&quot;,&quot;device&quot;:&quot;/dev/ttyUSB0&quot;,&quot;time&quot;:&quot;2026-06-14T00:04:22.050Z&quot;,&quot;hdop&quot;:0.00,&quot;nSat&quot;:0,&quot;uSat&quot;:0}
{&quot;class&quot;:&quot;TPV&quot;,&quot;device&quot;:&quot;/dev/ttyUSB0&quot;,&quot;mode&quot;:1,&quot;time&quot;:&quot;2026-06-14T00:04:22.050Z&quot;,&quot;ept&quot;:0.005}
{&quot;class&quot;:&quot;SKY&quot;,&quot;device&quot;:&quot;/dev/ttyUSB0&quot;,&quot;time&quot;:&quot;2026-06-14T00:04:23.040Z&quot;,&quot;hdop&quot;:0.00,&quot;nSat&quot;:0,&quot;uSat&quot;:0}
{&quot;class&quot;:&quot;TPV&quot;,&quot;device&quot;:&quot;/dev/ttyUSB0&quot;,&quot;mode&quot;:1,&quot;time&quot;:&quot;2026-06-14T00:04:23.040Z&quot;,&quot;ept&quot;:0.005}
</code></pre>
<p>Type &quot;Ctrl-C&quot; to close the socket.</p>
<p>If you have installed <code>gpsd-clients</code>, start the xgps or cgps client.</p>
<p><img src="https://user-images.githubusercontent.com/75182/236681456-e13aba0d-6c98-4dd8-bb66-4b0c07d906fc.png" alt="image"></p>
<h3 id="configure-kismet-to-use-gpsd">Configure Kismet to use GPSD</h3>
<p>Edit file <code>/etc/kismet/kismet_site.conf</code> and add the following lines:</p>
<pre><code class="language-text"># See https://www.kismetwireless.net/docs/readme/gps/gps_gpsd/
gps=gpsd:host=localhost,port=2947
</code></pre>
<pre><code class="language-bash">sudo service kismet restart
</code></pre>
<p>You should then have location information on the top right of the web interface:</p>
<p><img src="https://user-images.githubusercontent.com/75182/236682589-2af05653-50df-4e68-aa17-0327b4eef1b8.png" alt="image"></p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="https://www.linkielist.com/hacks/wpa-cracking-from-kismet-sensors/">WPA Cracking from Kismet sensors</a> - Linkielist.com, 2020-03-25</li>
<li><a href="https://www.freecodecamp.org/news/wireless-security-using-raspberry-pi-4-kismet-and-python/">How to Secure Your Home Wireless Infrastructure with Kismet and Python</a> - Jose Vicente Nunez on freeCodeCamp, 2022-03-02</li>
</ul>
<!-- EOF -->
</div></article></div><footer class="h-auto mt-20 bg-gray-100 justify-between border-t border-gray-200"><div class="pt-6 mx-auto  gap-x-6 w-9/12 flex flex-col prose prose-indigo hover:prose-black md:prose-lg lg:prose-xl"><div class="prose-xl"><p class="">gmacario.github.io</p></div><div class="flex flex-col sm:flex-row flex-wrap justify-between md:justify-start"><p class="mr-12 text-gray-600 prose-sm">gmacario.github.io</p><div class="mr-12 flex flex-col justify-start"><p class="text-gray-600 prose-sm flex flex-row"><svg class="MuiSvgIcon-root mr-2" focusable="false" viewBox="0 0 24 24" aria-hidden="true"><path d="M12 .3a12 12 0 0 0-3.8 23.4c.6.1.8-.3.8-.6v-2c-3.3.7-4-1.6-4-1.6-.6-1.4-1.4-1.8-1.4-1.8-1-.7.1-.7.1-.7 1.2 0 1.9 1.2 1.9 1.2 1 1.8 2.8 1.3 3.5 1 0-.8.4-1.3.7-1.6-2.7-.3-5.5-1.3-5.5-6 0-1.2.5-2.3 1.3-3.1-.2-.4-.6-1.6 0-3.2 0 0 1-.3 3.4 1.2a11.5 11.5 0 0 1 6 0c2.3-1.5 3.3-1.2 3.3-1.2.6 1.6.2 2.8 0 3.2.9.8 1.3 1.9 1.3 3.2 0 4.6-2.8 5.6-5.5 5.9.5.4.9 1 .9 2.2v3.3c0 .3.1.7.8.6A12 12 0 0 0 12 .3"></path></svg><a href="https://github.com/gmacario">gmacario</a></p><p class="text-gray-600 prose-sm flex flex-row"><svg class="MuiSvgIcon-root mr-2" focusable="false" viewBox="0 0 24 24" aria-hidden="true"><path d="M22.46 6c-.77.35-1.6.58-2.46.69.88-.53 1.56-1.37 1.88-2.38-.83.5-1.75.85-2.72 1.05C18.37 4.5 17.26 4 16 4c-2.35 0-4.27 1.92-4.27 4.29 0 .34.04.67.11.98C8.28 9.09 5.11 7.38 3 4.79c-.37.63-.58 1.37-.58 2.15 0 1.49.75 2.81 1.91 3.56-.71 0-1.37-.2-1.95-.5v.03c0 2.08 1.48 3.82 3.44 4.21a4.22 4.22 0 0 1-1.93.07 4.28 4.28 0 0 0 4 2.98 8.521 8.521 0 0 1-5.33 1.84c-.34 0-.68-.02-1.02-.06C3.44 20.29 5.7 21 8.12 21 16 21 20.33 14.46 20.33 8.79c0-.19 0-.37-.01-.56.84-.6 1.56-1.36 2.14-2.23z"></path></svg><a href="https://www.twitter.com/gpmacario">gpmacario</a></p></div><p class="mr-12 text-gray-600 prose-sm">Gianpaolo Macario&#x27;s public rants</p></div></div></footer></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"Running Kismet on a Raspberry Pi","content":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eThis post describes how to install \u003ca href=\"https://www.kismetwireless.net/\"\u003eKismet\u003c/a\u003e on a Linux host, then use the program to perform some \u0026quot;network intelligence\u0026quot;.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://user-images.githubusercontent.com/75182/236668176-cfafef6f-2652-422e-a7a6-5c06e84555cc.png\" alt=\"image\"\u003e\u003c/p\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eA host running a recent Debian-based distribution.\nTested on \u003ccode\u003erpi3bgm28\u003c/code\u003e - a \u003ca href=\"https://www.raspberrypi.com/products/raspberry-pi-3-model-b/\"\u003eRaspberry Pi 3 Model B\u003c/a\u003e running \u003ca href=\"https://www.raspberrypi.com/software/\"\u003eRaspberry Pi OS Lite\u003c/a\u003e 64-bit (bullseye)\u003c/li\u003e\n\u003cli\u003eA Wi-Fi adapter which supports monitor mode. Tested with a \u003ca href=\"https://support.dlink.com/ProductInfo.aspx?m=DWL-G122\"\u003eD-Link DWL-G122\u003c/a\u003e Wireless-G USB Dongle\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"step-by-step-instructions\"\u003eStep-by-step instructions\u003c/h2\u003e\n\u003cp\u003eLogin to the Raspberry Pi via SSH:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-bash\"\u003essh rpi3bgm28\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eCheck the version of the installed OS\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-bash\"\u003euname -a\nlsb_release -a\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eResult\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-text\"\u003egmacario@rpi3bgm28:~ $ uname -a\nLinux rpi3bgm28 6.1.21-v8+ #1642 SMP PREEMPT Mon Apr  3 17:24:16 BST 2023 aarch64 GNU/Linux\ngmacario@rpi3bgm28:~ $ lsb_release -a\nNo LSB modules are available.\nDistributor ID: Debian\nDescription:    Debian GNU/Linux 11 (bullseye)\nRelease:        11\nCodename:       bullseye\ngmacario@rpi3bgm28:~ $\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eIn our case we are running \u003ca href=\"https://www.raspberrypi.com/software/\"\u003eRaspberry Pi OS Lite\u003c/a\u003e:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eSystem: 64-bit (arch=\u003ccode\u003eaarch64\u003c/code\u003e)\u003c/li\u003e\n\u003cli\u003eDebian Release: 11 (bullseye)\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eMake sure the distribution is up-to-date\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-bash\"\u003esudo apt-get update \\\n  \u0026amp;\u0026amp; sudo apt-get -y dist-upgrade \\\n  \u0026amp;\u0026amp; sudo apt-get -y autoremove --purge\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eInstall Kismet following the instructions at \u003ca href=\"https://www.kismetwireless.net/packages/\"\u003ehttps://www.kismetwireless.net/packages/\u003c/a\u003e (use the one which corresponds to the installed OS)\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-bash\"\u003ewget -O - https://www.kismetwireless.net/repos/kismet-release.gpg.key --quiet | gpg --dearmor | sudo tee /usr/share/keyrings/kismet-archive-keyring.gpg \u0026gt;/dev/null\necho \u0026#39;deb [signed-by=/usr/share/keyrings/kismet-archive-keyring.gpg] https://www.kismetwireless.net/repos/apt/release/bullseye bullseye main\u0026#39; | sudo tee /etc/apt/sources.list.d/kismet.list \u0026gt;/dev/null\nsudo apt update\nsudo apt install kismet\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eProvide the following answers when requested:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eDo you want to continue? Y\u003c/li\u003e\n\u003cli\u003eShould Kismet be installed with suid-root helpers? Yes\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eVerify that Kismet has been installed correctly:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-text\"\u003egmacario@rpi3bgm28:~ $ kismet --version\nKismet 2022-08-R1\ngmacario@rpi3bgm28:~ $\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eAdd current user to group \u003ccode\u003ekismet\u003c/code\u003e:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-bash\"\u003esudo usermod -aG kismet $USER\nnewgrp kismet\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eLogged in as \u003ccode\u003egmacario@rpi3bgm28\u003c/code\u003e, type \u003ccode\u003eiwconfig\u003c/code\u003e to list the existing Wireless interfaces.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-text\"\u003egmacario@rpi3bgm28:~ $ iwconfig\nlo        no wireless extensions.\n\neth0      no wireless extensions.\n\nwlan0     IEEE 802.11  ESSID:\u0026quot;Galaxy A32 gpmacario\u0026quot;\n          Mode:Managed  Frequency:2.437 GHz  Access Point: A6:B5:89:FE:22:0D\n          Bit Rate=65 Mb/s   Tx-Power=31 dBm\n          Retry short limit:7   RTS thr:off   Fragment thr:off\n          Power Management:on\n          Link Quality=57/70  Signal level=-53 dBm\n          Rx invalid nwid:0  Rx invalid crypt:0  Rx invalid frag:0\n          Tx excessive retries:0  Invalid misc:0   Missed beacon:0\n\ntailscale0  no wireless extensions.\n\ndocker0   no wireless extensions.\n\ngmacario@rpi3bgm28:~ $\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eNow insert the \u003ca href=\"https://support.dlink.com/ProductInfo.aspx?m=DWL-G122\"\u003eD-Link DWL-G122\u003c/a\u003e\ninto one USB port of the Raspberry Pi.\u003c/p\u003e\n\u003cp\u003eExecute the \u003ccode\u003eiwconfig\u003c/code\u003e command again and verify that the Wi-Fi USB dongle gets recognized.\nTake note of the new interface name (in our case, this is \u003ccode\u003ewlan1\u003c/code\u003e):\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-text\"\u003egmacario@rpi3bgm28:~ $ iwconfig\nlo        no wireless extensions.\n\neth0      no wireless extensions.\n\nwlan0     IEEE 802.11  ESSID:\u0026quot;Galaxy A32 gpmacario\u0026quot;\n          Mode:Managed  Frequency:2.437 GHz  Access Point: A6:B5:89:FE:22:0D\n          Bit Rate=72.2 Mb/s   Tx-Power=31 dBm\n          Retry short limit:7   RTS thr:off   Fragment thr:off\n          Power Management:on\n          Link Quality=56/70  Signal level=-54 dBm\n          Rx invalid nwid:0  Rx invalid crypt:0  Rx invalid frag:0\n          Tx excessive retries:0  Invalid misc:0   Missed beacon:0\n\ntailscale0  no wireless extensions.\n\ndocker0   no wireless extensions.\n\nwlan1     IEEE 802.11  ESSID:\u0026quot;Galaxy A32 gpmacario\u0026quot;\n          Mode:Managed  Frequency:2.437 GHz  Access Point: A6:B5:89:FE:22:0D\n          Bit Rate=54 Mb/s   Tx-Power=20 dBm\n          Retry short limit:7   RTS thr:off   Fragment thr:off\n          Power Management:on\n          Link Quality=62/70  Signal level=-48 dBm\n          Rx invalid nwid:0  Rx invalid crypt:0  Rx invalid frag:0\n          Tx excessive retries:0  Invalid misc:21   Missed beacon:0\n\ngmacario@rpi3bgm28:~ $\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eLaunch Kismet and configure it to use new Wi-Fi interface as datasource:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-bash\"\u003ekismet -c wlan1\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eResult:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-text\"\u003egmacario@rpi3bgm28:~ $ kismet -c wlan1\nINFO: Including sub-config file: /etc/kismet/kismet_httpd.conf\nINFO: Including sub-config file: /etc/kismet/kismet_memory.conf\nINFO: Including sub-config file: /etc/kismet/kismet_alerts.conf\nINFO: Including sub-config file: /etc/kismet/kismet_80211.conf\nINFO: Including sub-config file: /etc/kismet/kismet_logging.conf\nINFO: Including sub-config file: /etc/kismet/kismet_filter.conf\nINFO: Including sub-config file: /etc/kismet/kismet_uav.conf\nINFO: Loading config override file \u0026#39;/etc/kismet/kismet_package.conf\u0026#39;\nINFO: Optional sub-config file not present: /etc/kismet/kismet_package.conf\nINFO: Loading config override file \u0026#39;/etc/kismet/kismet_site.conf\u0026#39;\nINFO: Optional sub-config file not present: /etc/kismet/kismet_site.conf\nKISMET - Point your browser to http://localhost:2501 (or the address of this system) for the INFO: Keeping EAPOL packets in memory for easy download and WIDS\n      functionality; this can use more RAM.\nINFO: Registered PHY handler \u0026#39;IEEE802.11\u0026#39; as ID 0\nINFO: Registered PHY handler \u0026#39;RTL433\u0026#39; as ID 1\nINFO: Registered PHY handler \u0026#39;Z-Wave\u0026#39; as ID 2\nINFO: Registered PHY handler \u0026#39;Bluetooth\u0026#39; as ID 3\nINFO: Registered PHY handler \u0026#39;UAV\u0026#39; as ID 4\nINFO: Registered PHY handler \u0026#39;NrfMousejack\u0026#39; as ID 5\nINFO: Using default rates of 10/min, 1/sec for alert \u0026#39;BLEEDINGTOOTH\u0026#39;\nINFO: Registered PHY handler \u0026#39;BTLE\u0026#39; as ID 6\nINFO: Registered PHY handler \u0026#39;METER\u0026#39; as ID 7\nINFO: Indexing ADSB ICAO db\nINFO: Completed indexing ADSB ICAO db, 322278 lines 6446 indexes\nINFO: Registered PHY handler \u0026#39;ADSB\u0026#39; as ID 8\nINFO: Registered PHY handler \u0026#39;802.15.4\u0026#39; as ID 9\nINFO: Registered PHY handler \u0026#39;RADIATION\u0026#39; as ID 10\nINFO: Serving static file content from /usr/share/kismet/httpd/\nINFO: Enabling channel hopping by default on sources which support channel\n      control.\nINFO: Setting default channel hop rate to 5/sec\nINFO: Enabling channel list splitting on sources which share the same list\n      of channels\nINFO: Enabling channel list shuffling to optimize overlaps\nINFO: Sources will be re-opened if they encounter an error\nINFO: Saving datasources to the Kismet database log every 30 seconds.\nINFO: Launching remote capture server on 127.0.0.1 3501\nINFO: Data sources passed on the command line (via -c source), ignoring\n      source= definitions in the Kismet config file.\nINFO: Probing interface \u0026#39;wlan1\u0026#39; to find datasource type\nINFO: Opened kismetdb log file \u0026#39;.//Kismet-20230424-12-35-40-1.kismet\u0026#39;\nINFO: Saving packets to the Kismet database log.\nINFO: GPS track will be logged to the Kismet logfile\nINFO: Starting Kismet web server...\nINFO: HTTP server listening on 0.0.0.0:2501\nINFO: Could not open system plugin directory (/usr/lib/kismet/), skipping:\n      No such file or directory\nINFO: Did not find a user plugin directory (/home/gmacario/.kismet//plugins\n      /), skipping: No such file or directory\nINFO: Found type \u0026#39;linuxwifi\u0026#39; for \u0026#39;wlan1\u0026#39;\nINFO: wlan1 bringing down parent interface \u0026#39;wlan1\u0026#39;\nINFO: wlan1 finished configuring wlan1mon, ready to capture\nINFO: Data source \u0026#39;wlan1\u0026#39; launched successfully\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eBrowse \u003ca href=\"http://rpi3bgm28:2501\"\u003ehttp://rpi3bgm28:2501\u003c/a\u003e to access Kismet web UI.\u003c/p\u003e\n\u003cp\u003eThe first time you access the web UI, the following questions will be displayed:\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003cstrong\u003eSet Login\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003eTo finish setting up Kismet, you need to configure a login.\u003c/p\u003e\n\u003cp\u003eThis login will be stored in \u003ccode\u003e.kismet/kismet_httpd.conf\u003c/code\u003e in the\n\u003cem\u003ehome directory of the user who launched Kismet\u003c/em\u003e;\nThis server is running as gmacario, and the login will be saved\nin \u003ccode\u003e~gmacario/.kismet/kismet_httpd.conf\u003c/code\u003e.\u003c/p\u003e\n\u003cp\u003eSet Login\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eUser name: ...\u003c/li\u003e\n\u003cli\u003ePassword: ...\u003c/li\u003e\n\u003cli\u003eConfirm: ...\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eFill in the requested information, then click \u0026quot;Save\u0026quot;.\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003cstrong\u003eWelcome\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003eWelcome!\u003c/p\u003e\n\u003cp\u003eThis is the first time you\u0026#39;ve used this Kismet server in this browser.\u003c/p\u003e\n\u003cp\u003eKismet stores local settings in the HTML5 storage of your browser.\u003c/p\u003e\n\u003cp\u003eYou should configure your preferences and login settings in the settings panel!\u003c/p\u003e\n\u003cp\u003eSettings | Continue\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003c!-- TODO --\u003e\n\n\u003ch3 id=\"runtime-censorship\"\u003eRuntime censorship\u003c/h3\u003e\n\u003cp\u003eKismet can be configured to censor some information - such as the last digits of MAC address or SSID - displayed in the web UI, in order to make it easier to share screenshots or demos without revealing sensitive data.\u003c/p\u003e\n\u003cp\u003eCensorship mode can be enabled by adding \u003ccode\u003e?censor=1\u003c/code\u003e to Kismet URL, for instance\n\u003ca href=\"http://localhost:2501/?censor=1\"\u003ehttp://localhost:2501/?censor=1\u003c/a\u003e or \u003ca href=\"http://rpi3bgm28:2501/?censor=1\"\u003ehttp://rpi3bgm28:2501/?censor=1\u003c/a\u003e\u003c/p\u003e\n\u003c!-- TODO: Screenshot --\u003e\n\n\u003cp\u003eReference: \u003ca href=\"https://www.kismetwireless.net/docs/readme/configuring/webserver/\"\u003ehttps://www.kismetwireless.net/docs/readme/configuring/webserver/\u003c/a\u003e\u003c/p\u003e\n\u003c!--\nTODO: Try enabling Data Source hci0\n(should not be connected via wlab0, though)\n\nSee also:\n- \u003chttps://www.kismetwireless.net/docs/readme/datasources/datasources/\u003e\n- \u003chttps://www.kismetwireless.net/docs/readme/datasources/bluetooth-hci-bluetooth/\u003e\n\nKismet web UI: Data Sources \u003e TODO\n\nkismet -c hci0\n--\u003e\n\n\u003ch3 id=\"export-kismet-files-to-pcap\"\u003eExport \u003ccode\u003e*.kismet\u003c/code\u003e files to \u003ccode\u003e*.pcap\u003c/code\u003e\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"language-bash\"\u003egmacario@rpi3bgm28:~ $ kismetdb_to_pcap \\\n    --in Kismet-20230424-12-57-23-1.kismet \\\n    --out Kismet-20230424-12-57-23-1.kismet.pcap\nDone...\ngmacario@rpi3bgm28:~ $ ls -la Kismet-20230424-12-57-23-1.kismet*\n-rw-r--r-- 1 gmacario gmacario 9347072 Apr 24 15:17 Kismet-20230424-12-57-23-1.kismet\n-rw-r--r-- 1 gmacario gmacario 3575696 Apr 24 15:17 Kismet-20230424-12-57-23-1.kismet.pcap\ngmacario@rpi3bgm28:~ $\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eYou may then open the generated \u003ccode\u003e*.pcap\u003c/code\u003e file using a suitable tool, for instance \u003ca href=\"https://www.wireshark.org/\"\u003eWireshark\u003c/a\u003e.\u003c/p\u003e\n\u003c!-- TODO: Screenshot --\u003e\n\n\u003ch3 id=\"recovering-lost-passwords\"\u003eRecovering lost passwords\u003c/h3\u003e\n\u003cp\u003eAfter converting \u003ccode\u003e*.kismet\u003c/code\u003e to \u003ccode\u003e*.pcap\u003c/code\u003e using the \u003ccode\u003ekismetdb_to_pcap\u003c/code\u003e tool,\nbrowse \u003ca href=\"https://hashcat.net/cap2hashcat/\"\u003ehttps://hashcat.net/cap2hashcat/\u003c/a\u003e and upload the \u003ccode\u003e*.pcap\u003c/code\u003e file.\u003c/p\u003e\n\u003cp\u003eThe tool will verify the \u003ccode\u003e*.pcap\u003c/code\u003e file and convert it to a format\nsuitable for the \u003ca href=\"https://hashcat.net/hashcat/\"\u003ehashcat\u003c/a\u003e tool.\u003c/p\u003e\n\u003c!-- TODO --\u003e\n\n\u003ch3 id=\"optional-add-location-data-to-kismet-reports\"\u003e(Optional) Add location data to Kismet reports\u003c/h3\u003e\n\u003cp\u003eReference: \u003ca href=\"https://www.kismetwireless.net/docs/readme/gps/gps_gpsd/\"\u003ehttps://www.kismetwireless.net/docs/readme/gps/gps_gpsd/\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eIf you have a GPS (for instance, \u003ca href=\"https://www.amazon.com/Receiver-Antenna-Gmouse-Laptop-Navigation/dp/B073P3Y48Q\"\u003ethis one\u003c/a\u003e) available and follow the instruction in this section, you will be able to augment Kismet reports with actual location information.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eNOTE\u003c/strong\u003e: WORK-IN-PROGRESS\u003c/p\u003e\n\u003ch4 id=\"install-gpsd\"\u003eInstall GPSD\u003c/h4\u003e\n\u003cp\u003eFollowing the instructions at \u003ca href=\"https://gpsd.gitlab.io/gpsd/installation.html\"\u003ehttps://gpsd.gitlab.io/gpsd/installation.html\u003c/a\u003e,\nconnect a USB GPS into an empty USB port of the Raspberry Pi.\u003c/p\u003e\n\u003cp\u003eVerify with \u003ccode\u003esudo dmesg -w\u003c/code\u003e that the GPS is correctly recognized:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-text\"\u003e[494743.803508] usb 1-1.2: new full-speed USB device number 5 using dwc_otg\n[494743.905774] usb 1-1.2: New USB device found, idVendor=067b, idProduct=2303, bcdDevice= 3.00\n[494743.905806] usb 1-1.2: New USB device strings: Mfr=1, Product=2, SerialNumber=0\n[494743.905820] usb 1-1.2: Product: USB-Serial Controller\n[494743.905831] usb 1-1.2: Manufacturer: Prolific Technology Inc.\n[494744.259635] usbcore: registered new interface driver usbserial_generic\n[494744.259789] usbserial: USB Serial support registered for generic\n[494744.270315] usbcore: registered new interface driver pl2303\n[494744.270427] usbserial: USB Serial support registered for pl2303\n[494744.270591] pl2303 1-1.2:1.0: pl2303 converter detected\n[494744.277325] usb 1-1.2: pl2303 converter now attached to ttyUSB0\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eVerify that the character device has been created correctly:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-text\"\u003egmacario@rpi3bgm28:~ $ ls -la /dev/ttyUSB0\ncrw-rw---- 1 root dialout 188, 0 May  7 15:15 /dev/ttyUSB0\ngmacario@rpi3bgm28:~ $\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eIf you are not running as root ensure that the user is of the group owning the device:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-bash\"\u003esudo usermod -aG dialout $USER\nnewgrp dialout\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eMake sure you can get data from your GPS (replace \u003ccode\u003ettyXXX\u003c/code\u003e with the filename of the port detected by \u003ccode\u003edmesg\u003c/code\u003e):\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-bash\"\u003estty -F /dev/ttyXXX ispeed 4800 \u0026amp;\u0026amp; cat \u0026lt;/dev/ttyXXX\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eExample:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-text\"\u003egmacario@rpi3bgm28:~ $ stty -F /dev/ttyUSB0 ispeed 4800 \u0026amp;\u0026amp; cat \u0026lt;/dev/ttyUSB0\n3▒F▒▒f▒▒▒f▒▒▒▒SF6k\n$GPVTG,,T,,M,,N,,K,N*2C\n\n$GPGGA,001012.039,,,,,0,00,,,M,0.0,M,,0000*5E\n\n$GPGSA,A,1,,,,,,,,,,,,,,,*1E\n\n$GPRMC,001012.039,V,,,,,,,291006,,,N*49\n\n$GPVTG,,T,,M,,N,,K,N*2C\n\n$GPGGA,001013.039,,,,,0,00,,,M,0.0,M,,0000*5F\n\n$GPGSA,A,1,,,,,,,,,,,,,,,*1E\n\n$GPRMC,001013.039,V,,,,,,,291006,,,N*48\n\n$GPVTG,,T,,M,,N,,K,N*2C\n\n^C\ngmacario@rpi3bgm28:~ $\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eInstall \u003ccode\u003egpsd\u003c/code\u003e and \u003ccode\u003egpsd-clients\u003c/code\u003e (the second package is optional but will make troubleshooting easier):\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-bash\"\u003esudo apt install gpsd\nsudo apt install gpsd-clients\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eReboot the Raspberry Pi to verify that the GPSD service automatically starts at boot.\u003c/p\u003e\n\u003ch4 id=\"test-gpsd\"\u003eTest GPSD\u003c/h4\u003e\n\u003cp\u003eConnect to port 2947 on localhost. You should be greeted with a JSON message returning the version of GPSD which is correctly running:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-text\"\u003egmacario@rpi3bgm28:~ $ tailscale nc localhost 2947\n{\u0026quot;class\u0026quot;:\u0026quot;VERSION\u0026quot;,\u0026quot;release\u0026quot;:\u0026quot;3.22\u0026quot;,\u0026quot;rev\u0026quot;:\u0026quot;3.22\u0026quot;,\u0026quot;proto_major\u0026quot;:3,\u0026quot;proto_minor\u0026quot;:14}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eNow start raw and watcher modes. After a few minutes you should start receiving GPS reports:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-text\"\u003e?WATCH={\u0026quot;enable\u0026quot;:true,\u0026quot;json\u0026quot;:true};\n{\u0026quot;class\u0026quot;:\u0026quot;DEVICES\u0026quot;,\u0026quot;devices\u0026quot;:[{\u0026quot;class\u0026quot;:\u0026quot;DEVICE\u0026quot;,\u0026quot;path\u0026quot;:\u0026quot;/dev/ttyUSB0\u0026quot;,\u0026quot;activated\u0026quot;:\u0026quot;2023-05-07T13:34:29.463Z\u0026quot;,\u0026quot;native\u0026quot;:0,\u0026quot;bps\u0026quot;:9600,\u0026quot;parity\u0026quot;:\u0026quot;N\u0026quot;,\u0026quot;stopbits\u0026quot;:1,\u0026quot;cycle\u0026quot;:1.00}]}\n{\u0026quot;class\u0026quot;:\u0026quot;WATCH\u0026quot;,\u0026quot;enable\u0026quot;:true,\u0026quot;json\u0026quot;:true,\u0026quot;nmea\u0026quot;:false,\u0026quot;raw\u0026quot;:0,\u0026quot;scaled\u0026quot;:false,\u0026quot;timing\u0026quot;:false,\u0026quot;split24\u0026quot;:false,\u0026quot;pps\u0026quot;:false}\n{\u0026quot;class\u0026quot;:\u0026quot;DEVICE\u0026quot;,\u0026quot;path\u0026quot;:\u0026quot;/dev/ttyUSB0\u0026quot;,\u0026quot;driver\u0026quot;:\u0026quot;NMEA0183\u0026quot;,\u0026quot;activated\u0026quot;:\u0026quot;2023-05-07T13:35:03.168Z\u0026quot;,\u0026quot;native\u0026quot;:0,\u0026quot;bps\u0026quot;:4800,\u0026quot;parity\u0026quot;:\u0026quot;N\u0026quot;,\u0026quot;stopbits\u0026quot;:1,\u0026quot;cycle\u0026quot;:1.00}\n{\u0026quot;class\u0026quot;:\u0026quot;TPV\u0026quot;,\u0026quot;device\u0026quot;:\u0026quot;/dev/ttyUSB0\u0026quot;,\u0026quot;mode\u0026quot;:1}\n{\u0026quot;class\u0026quot;:\u0026quot;TPV\u0026quot;,\u0026quot;device\u0026quot;:\u0026quot;/dev/ttyUSB0\u0026quot;,\u0026quot;mode\u0026quot;:1}\n{\u0026quot;class\u0026quot;:\u0026quot;TPV\u0026quot;,\u0026quot;device\u0026quot;:\u0026quot;/dev/ttyUSB0\u0026quot;,\u0026quot;mode\u0026quot;:1}\n{\u0026quot;class\u0026quot;:\u0026quot;DEVICE\u0026quot;,\u0026quot;path\u0026quot;:\u0026quot;/dev/ttyUSB0\u0026quot;,\u0026quot;driver\u0026quot;:\u0026quot;SiRF\u0026quot;,\u0026quot;activated\u0026quot;:\u0026quot;2023-05-07T13:35:04.277Z\u0026quot;,\u0026quot;flags\u0026quot;:1,\u0026quot;native\u0026quot;:1,\u0026quot;bps\u0026quot;:4800,\u0026quot;parity\u0026quot;:\u0026quot;N\u0026quot;,\u0026quot;stopbits\u0026quot;:1,\u0026quot;cycle\u0026quot;:1.00}\n{\u0026quot;class\u0026quot;:\u0026quot;SKY\u0026quot;,\u0026quot;device\u0026quot;:\u0026quot;/dev/ttyUSB0\u0026quot;,\u0026quot;time\u0026quot;:\u0026quot;2026-06-14T00:04:20.040Z\u0026quot;,\u0026quot;nSat\u0026quot;:0,\u0026quot;uSat\u0026quot;:0}\n{\u0026quot;class\u0026quot;:\u0026quot;TPV\u0026quot;,\u0026quot;device\u0026quot;:\u0026quot;/dev/ttyUSB0\u0026quot;,\u0026quot;mode\u0026quot;:1,\u0026quot;time\u0026quot;:\u0026quot;2026-06-14T00:04:20.040Z\u0026quot;,\u0026quot;ept\u0026quot;:0.005}\n{\u0026quot;class\u0026quot;:\u0026quot;DEVICE\u0026quot;,\u0026quot;path\u0026quot;:\u0026quot;/dev/ttyUSB0\u0026quot;,\u0026quot;driver\u0026quot;:\u0026quot;SiRF\u0026quot;,\u0026quot;subtype\u0026quot;:\u0026quot;GSW3.2.4-SDK_3.1.00.12-SDK001P1.00 \u0026quot;,\u0026quot;activated\u0026quot;:\u0026quot;2023-05-07T13:35:05.183Z\u0026quot;,\u0026quot;flags\u0026quot;:1,\u0026quot;native\u0026quot;:1,\u0026quot;bps\u0026quot;:4800,\u0026quot;parity\u0026quot;:\u0026quot;N\u0026quot;,\u0026quot;stopbits\u0026quot;:1,\u0026quot;cycle\u0026quot;:1.00}\n{\u0026quot;class\u0026quot;:\u0026quot;DEVICE\u0026quot;,\u0026quot;path\u0026quot;:\u0026quot;/dev/ttyUSB0\u0026quot;,\u0026quot;driver\u0026quot;:\u0026quot;SiRF\u0026quot;,\u0026quot;subtype\u0026quot;:\u0026quot;GSW3.2.4-SDK_3.1.00.12-SDK001P1.00 \u0026quot;,\u0026quot;activated\u0026quot;:\u0026quot;2023-05-07T13:35:05.309Z\u0026quot;,\u0026quot;flags\u0026quot;:1,\u0026quot;native\u0026quot;:1,\u0026quot;bps\u0026quot;:4800,\u0026quot;parity\u0026quot;:\u0026quot;N\u0026quot;,\u0026quot;stopbits\u0026quot;:1,\u0026quot;cycle\u0026quot;:1.00}\n{\u0026quot;class\u0026quot;:\u0026quot;SKY\u0026quot;,\u0026quot;device\u0026quot;:\u0026quot;/dev/ttyUSB0\u0026quot;,\u0026quot;time\u0026quot;:\u0026quot;2026-06-14T00:04:21.040Z\u0026quot;,\u0026quot;hdop\u0026quot;:0.00,\u0026quot;nSat\u0026quot;:0,\u0026quot;uSat\u0026quot;:0}\n{\u0026quot;class\u0026quot;:\u0026quot;TPV\u0026quot;,\u0026quot;device\u0026quot;:\u0026quot;/dev/ttyUSB0\u0026quot;,\u0026quot;mode\u0026quot;:1,\u0026quot;time\u0026quot;:\u0026quot;2026-06-14T00:04:21.040Z\u0026quot;,\u0026quot;ept\u0026quot;:0.005}\n{\u0026quot;class\u0026quot;:\u0026quot;DEVICE\u0026quot;,\u0026quot;path\u0026quot;:\u0026quot;/dev/ttyUSB0\u0026quot;,\u0026quot;driver\u0026quot;:\u0026quot;SiRF\u0026quot;,\u0026quot;subtype\u0026quot;:\u0026quot;GSW3.2.4-SDK_3.1.00.12-SDK001P1.00 \u0026quot;,\u0026quot;activated\u0026quot;:\u0026quot;2023-05-07T13:35:06.463Z\u0026quot;,\u0026quot;flags\u0026quot;:1,\u0026quot;native\u0026quot;:1,\u0026quot;bps\u0026quot;:4800,\u0026quot;parity\u0026quot;:\u0026quot;N\u0026quot;,\u0026quot;stopbits\u0026quot;:1,\u0026quot;cycle\u0026quot;:1.00}\n{\u0026quot;class\u0026quot;:\u0026quot;SKY\u0026quot;,\u0026quot;device\u0026quot;:\u0026quot;/dev/ttyUSB0\u0026quot;,\u0026quot;time\u0026quot;:\u0026quot;2026-06-14T00:04:22.050Z\u0026quot;,\u0026quot;hdop\u0026quot;:0.00,\u0026quot;nSat\u0026quot;:0,\u0026quot;uSat\u0026quot;:0}\n{\u0026quot;class\u0026quot;:\u0026quot;TPV\u0026quot;,\u0026quot;device\u0026quot;:\u0026quot;/dev/ttyUSB0\u0026quot;,\u0026quot;mode\u0026quot;:1,\u0026quot;time\u0026quot;:\u0026quot;2026-06-14T00:04:22.050Z\u0026quot;,\u0026quot;ept\u0026quot;:0.005}\n{\u0026quot;class\u0026quot;:\u0026quot;SKY\u0026quot;,\u0026quot;device\u0026quot;:\u0026quot;/dev/ttyUSB0\u0026quot;,\u0026quot;time\u0026quot;:\u0026quot;2026-06-14T00:04:23.040Z\u0026quot;,\u0026quot;hdop\u0026quot;:0.00,\u0026quot;nSat\u0026quot;:0,\u0026quot;uSat\u0026quot;:0}\n{\u0026quot;class\u0026quot;:\u0026quot;TPV\u0026quot;,\u0026quot;device\u0026quot;:\u0026quot;/dev/ttyUSB0\u0026quot;,\u0026quot;mode\u0026quot;:1,\u0026quot;time\u0026quot;:\u0026quot;2026-06-14T00:04:23.040Z\u0026quot;,\u0026quot;ept\u0026quot;:0.005}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eType \u0026quot;Ctrl-C\u0026quot; to close the socket.\u003c/p\u003e\n\u003cp\u003eIf you have installed \u003ccode\u003egpsd-clients\u003c/code\u003e, start the xgps or cgps client.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://user-images.githubusercontent.com/75182/236681456-e13aba0d-6c98-4dd8-bb66-4b0c07d906fc.png\" alt=\"image\"\u003e\u003c/p\u003e\n\u003ch3 id=\"configure-kismet-to-use-gpsd\"\u003eConfigure Kismet to use GPSD\u003c/h3\u003e\n\u003cp\u003eEdit file \u003ccode\u003e/etc/kismet/kismet_site.conf\u003c/code\u003e and add the following lines:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-text\"\u003e# See https://www.kismetwireless.net/docs/readme/gps/gps_gpsd/\ngps=gpsd:host=localhost,port=2947\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"language-bash\"\u003esudo service kismet restart\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eYou should then have location information on the top right of the web interface:\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://user-images.githubusercontent.com/75182/236682589-2af05653-50df-4e68-aa17-0327b4eef1b8.png\" alt=\"image\"\u003e\u003c/p\u003e\n\u003ch2 id=\"see-also\"\u003eSee also\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.linkielist.com/hacks/wpa-cracking-from-kismet-sensors/\"\u003eWPA Cracking from Kismet sensors\u003c/a\u003e - Linkielist.com, 2020-03-25\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.freecodecamp.org/news/wireless-security-using-raspberry-pi-4-kismet-and-python/\"\u003eHow to Secure Your Home Wireless Infrastructure with Kismet and Python\u003c/a\u003e - Jose Vicente Nunez on freeCodeCamp, 2022-03-02\u003c/li\u003e\n\u003c/ul\u003e\n\u003c!-- EOF --\u003e\n"},"config":{"title":"gmacario.github.io","description":"Gianpaolo Macario's public rants","social":{"github":{"name":"gmacario","link":"https://github.com/gmacario"},"twitter":{"name":"gpmacario","link":"https://www.twitter.com/gpmacario"}}}},"__N_SSG":true},"page":"/posts/[slug]","query":{"slug":"2023-04-24-kismet-rpi3bgm28"},"buildId":"dxj9iNLdCYMM-7ySs_-7F","runtimeConfig":{},"isFallback":false,"gsp":true}</script><script nomodule="" src="/_next/static/chunks/polyfills-144e5fa6fafab6397d9c.js"></script><script src="/_next/static/chunks/webpack-50bee04d1dc61f8adf5b.js" async=""></script><script src="/_next/static/chunks/framework.1a5e6c0bcaecf178eee2.js" async=""></script><script src="/_next/static/chunks/commons.a817edd9b2693fcc6af8.js" async=""></script><script src="/_next/static/chunks/main-daaff4f95c13923f49a5.js" async=""></script><script src="/_next/static/chunks/pages/_app-041b1432faef8bf5f62a.js" async=""></script><script src="/_next/static/chunks/b38cc82cec06c0ea8b096def674947a423bb2764.260eb1ac110a53311620.js" async=""></script><script src="/_next/static/chunks/pages/posts/%5Bslug%5D-1c9a30b06d2f3be2ac9c.js" async=""></script><script src="/_next/static/dxj9iNLdCYMM-7ySs_-7F/_buildManifest.js" async=""></script><script src="/_next/static/dxj9iNLdCYMM-7ySs_-7F/_ssgManifest.js" async=""></script></body></html>