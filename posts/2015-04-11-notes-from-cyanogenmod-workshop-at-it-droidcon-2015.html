<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><meta name="description" content="Gianpaolo Macario&#x27;s public rants"/><title>Notes from CyanogenMod Workshop at IT Droidcon 2015</title><meta name="next-head-count" content="4"/><link rel="preload" href="/_next/static/css/08fafe92abad983f984c.css" as="style"/><link rel="stylesheet" href="/_next/static/css/08fafe92abad983f984c.css" data-n-g=""/><noscript data-n-css=""></noscript><link rel="preload" href="/_next/static/chunks/webpack-50bee04d1dc61f8adf5b.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework.1a5e6c0bcaecf178eee2.js" as="script"/><link rel="preload" href="/_next/static/chunks/commons.a817edd9b2693fcc6af8.js" as="script"/><link rel="preload" href="/_next/static/chunks/main-daaff4f95c13923f49a5.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/_app-041b1432faef8bf5f62a.js" as="script"/><link rel="preload" href="/_next/static/chunks/b38cc82cec06c0ea8b096def674947a423bb2764.260eb1ac110a53311620.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/posts/%5Bslug%5D-1c9a30b06d2f3be2ac9c.js" as="script"/></head><body><div id="__next"><main class="h-screen flex flex-col"><header class="py-3 fixed top-0 z-50 flex flex-wrap justify-between w-screen bg-white border-b border-gray-200"><div class="mx-3 py-2 px-4  font-bold text-indigo-500">Gianpaolo Macario&#x27;s blog</div><div class="justify-end"><a class="mr-6 py-2 px-4 inline-block rounded h-full text-indigo-500 hover:text-white hover:bg-indigo-500" href="/">Home</a><a class="mr-6 py-2 px-4 inline-block rounded h-full text-indigo-500 hover:text-white hover:bg-indigo-500" href="/posts">Posts</a></div></header><div class="pt-28 mx-auto w-5/6 break-words flex flex-grow prose prose-indigo hover:prose-black md:prose-lg lg:prose-xl"><article><h1>Notes from CyanogenMod Workshop at IT Droidcon 2015</h1><div class="prose prose-indigo hover:prose-black md:prose-lg lg:prose-xl"><!-- markdown-link-check-disable -->

<p>Here are a few notes which I took when attending the <a href="http://it.droidcon.com/2015/sessions/cyanogen-workshop/">Cyanogen Workshop</a> during the <a href="http://it.droidcon.com/2015/">IT Droidcon 2015</a> which took place in Torino on 2015-04-10.</p>
<p>The workshop was led by <a href="https://twitter.com/ciwrl">Abhisek Devkota</a>, Senior Engineering and Community Manager at Cyanogen Inc., who was extremely good in driving the workshop forward and answered a lot of questions from the audience.</p>
<h3 id="preparing-the-development-environment">Preparing the development environment</h3>
<p>Due to some issues when creating the VPS instances that were going to the participants I instead used one machine which I had already available. That had the additional benefit to make sure I could reproduce all the steps - including provisioning the build environment!</p>
<p>I had a Ubuntu 14.04 64-bit server available via SSH with Docker installed.</p>
<p>After logging in to the server, I cloned the &quot;docker-cyanogenmod&quot; project</p>
<pre><code>$ git clone https://github.com/gmacario/docker-cyanogenmod.git -b test-droidcon
</code></pre>
<p>Note: the &quot;test-droidcon&quot; branch on my fork is used in order to install exactly the packages which Abhisek had installed in his VPS instances.</p>
<p>Then run the following commands to create a Docker container with all the needed software automagically installed:</p>
<pre><code>$ cd docker-cyanogenmod
$ ./run.sh
</code></pre>
<p>The first time it will take a few minutes to create the Docker image and start the container, but subsequent runs will be much faster!</p>
<p>As a result I eventually got a shell inside the container:</p>
<pre><code>cmbuild@c8226ae3ff79:~/android$ ls -la
total 8
drwxrwxr-x 2 cmbuild cmbuild 4096 Apr 10 16:53 .
drwxr-xr-x 7 cmbuild cmbuild 4096 Apr 10 17:10 ..
cmbuild@c8226ae3ff79:~/android$ free
             total       used       free     shared    buffers     cached
Mem:      16433600   15763396     670204      13960     966884   12194076
-/+ buffers/cache:    2602436   13831164
Swap:     16775164      78012   16697152
cmbuild@c8226ae3ff79:~/android$ df -h
Filesystem                                              Size  Used Avail Use% Mounted on
rootfs                                                  119G   81G   33G  72% /
none                                                    119G   81G   33G  72% /
shm                                                      64M     0   64M   0% /dev/shm
/dev/disk/by-uuid/b5696056-ded4-483a-be75-d0ac8afac2cb  119G   81G   33G  72% /etc/hosts
/dev/sda1                                               1.8T  922G  820G  53% /srv/ccache
cmbuild@c8226ae3ff79:~/android$
</code></pre>
<p>Wow, plenty of resources to use! Let&#39;s move on...</p>
<h3 id="installing-repo">Installing Repo</h3>
<p>Logged as cmbuild@container:</p>
<pre><code>$ mkdir -p ~/bin
$ curl https://storage.googleapis.com/git-repo-downloads/repo &gt; ~/bin/repo
$ chmod a+x ~/bin/repo
</code></pre>
<h3 id="installing-the-android-sdk">Installing the Android SDK</h3>
<p>Download the latest version of the Android SDK for Linux (24.1.2 as of 2015-04-10)</p>
<pre><code>$ mkdir -p ~/sdk
$ cd ~/sdk
$ curl -O http://dl.google.com/android/android-sdk_r24.1.2-linux.tgz
</code></pre>
<p>If the previous fails for whatever reasons (i.e. you are in a location which blocks access to Google)</p>
<pre><code>$ curl -O https://dl.dropboxusercontent.com/u/2834459/android-sdk_r24.1.2-linux.tgz
</code></pre>
<p>After extracting the file your may remove the install tarball to save space:</p>
<pre><code>$ tar zxvf android-sdk_r24.1.2-linux.tgz
$ rm android-sdk_r24.1.2-linux.tgz
</code></pre>
<p>Update <code>~/.bashrc</code> with the following definitions:</p>
<pre><code>$ cat &lt;&lt;END &gt;&gt;~/.bashrc
export ANDROID_HOME=&quot;\$HOME/sdk/android-sdk-linux&quot;
export PATH=&quot;\$ANDROID_HOME/tools:\$ANDROID_HOME/platform-tools:\$PATH&quot;
END
</code></pre>
<p>Then logout from the container and launch <code>./run.sh</code> again to make sure
the environment variables are set correctly.</p>
<h3 id="using-the-android-sdk">Using the Android SDK</h3>
<p>You should have the <code>android</code> command in PATH, therefore you may do the following:</p>
<p>Get help</p>
<pre><code>$ android --help
</code></pre>
<p>List remote SDK repository</p>
<pre><code>$ android list sdk
</code></pre>
<p>Update the SDK specified</p>
<pre><code>$ android update sdk --no-ui --filter 1,2,5
</code></pre>
<p>You must read and accept the license by typing &quot;y&quot;, then the download will start.</p>
<h3 id="git-config-and-repo-init">Git config and repo init</h3>
<pre><code>$ git config --global user.email &quot;email@example.com&quot;
$ git config --global user.name &quot;First Lastname&quot;
$ git config --global color.ui auto
</code></pre>
<p>Init repo</p>
<p>In our example we want to configure for CyanogenMod 12.0</p>
<pre><code>$ mkdir -p ~/android/cm12/
$ cd ~/android/cm12/
$ repo init -u https://github.com/CyanogenMod/android.git -b cm-12.0
</code></pre>
<p>You may also repo init AOSP pointing to the following URL instead: <a href="https://android.googlesource.com/platform/manifest">https://android.googlesource.com/platform/manifest</a></p>
<p>There is a GitHub mirror (not always up-to-date) of AOSP at <a href="https://github.com/android">https://github.com/android</a></p>
<h3 id="syncing-the-source-code">Syncing the source code</h3>
<!-- Start: 2015-04-10 20:53 CEST -->

<pre><code>$ repo sync â€“j16
</code></pre>
<p>(and a lot of waiting)</p>
<!-- End: 2015-04-10 22:45 CEST -->

<p>Result:</p>
<pre><code>cmbuild@c8226ae3ff79:~/android/cm12$ ls -la
total 116
drwxrwxr-x  28 cmbuild cmbuild 4096 Apr 10 20:41 .
drwxrwxr-x   3 cmbuild cmbuild 4096 Apr 10 18:48 ..
drwxrwxr-x   7 cmbuild cmbuild 4096 Apr 10 20:29 .repo
-r--r--r--   1 cmbuild cmbuild   87 Apr 10 20:29 Makefile
drwxrwxr-x   3 cmbuild cmbuild 4096 Apr 10 20:29 abi
drwxrwxr-x   3 cmbuild cmbuild 4096 Apr 10 20:29 android
drwxrwxr-x  14 cmbuild cmbuild 4096 Apr 10 20:29 art
drwxrwxr-x  10 cmbuild cmbuild 4096 Apr 10 20:29 bionic
drwxrwxr-x   3 cmbuild cmbuild 4096 Apr 10 20:29 bootable
drwxrwxr-x   7 cmbuild cmbuild 4096 Apr 10 20:29 build
drwxrwxr-x  12 cmbuild cmbuild 4096 Apr 10 20:29 cts
drwxrwxr-x  13 cmbuild cmbuild 4096 Apr 10 20:29 dalvik
drwxrwxr-x   6 cmbuild cmbuild 4096 Apr 10 20:29 developers
drwxrwxr-x  20 cmbuild cmbuild 4096 Apr 10 20:29 development
drwxrwxr-x   7 cmbuild cmbuild 4096 Apr 10 20:29 device
drwxrwxr-x   3 cmbuild cmbuild 4096 Apr 10 20:29 docs
drwxrwxr-x 237 cmbuild cmbuild 4096 Apr 10 20:33 external
drwxrwxr-x  18 cmbuild cmbuild 4096 Apr 10 20:34 frameworks
drwxrwxr-x  15 cmbuild cmbuild 4096 Apr 10 20:34 hardware
drwxrwxr-x  16 cmbuild cmbuild 4096 Apr 10 20:34 libcore
drwxrwxr-x   5 cmbuild cmbuild 4096 Apr 10 20:34 libnativehelper
drwxrwxr-x   8 cmbuild cmbuild 4096 Apr 10 20:35 ndk
drwxrwxr-x   9 cmbuild cmbuild 4096 Apr 10 20:36 packages
drwxrwxr-x   6 cmbuild cmbuild 4096 Apr 10 20:36 pdk
drwxrwxr-x  16 cmbuild cmbuild 4096 Apr 10 20:40 prebuilts
drwxrwxr-x  27 cmbuild cmbuild 4096 Apr 10 20:40 sdk
drwxrwxr-x  10 cmbuild cmbuild 4096 Apr 10 20:40 system
drwxrwxr-x   3 cmbuild cmbuild 4096 Apr 10 20:40 tools
drwxrwxr-x   4 cmbuild cmbuild 4096 Apr 10 20:41 vendor
cmbuild@c8226ae3ff79:~/android/cm12$
</code></pre>
<p>Disk usage:</p>
<pre><code>cmbuild@c8226ae3ff79:~/android/cm12$ du -sh
29G     .
cmbuild@c8226ae3ff79:~/android/cm12$
</code></pre>
<h3 id="choose-your-device">Choose your device</h3>
<p>Source the <code>envsetup.sh</code> script to setup build environment</p>
<pre><code>$ source build/envsetup.sh
</code></pre>
<p>You need to choose your device. CM 12 has 107 targets so far.
See <a href="https://github.com/CyanogenMod/hudson/blob/master/cm-build-targets">https://github.com/CyanogenMod/hudson/blob/master/cm-build-targets</a></p>
<ul>
<li>Samsung Galaxy SII (i9100) ==&gt; Only cm11</li>
<li>Emulated hardware (TBV whether they work with Lollypop, at least they worked with KitKat):<ul>
<li>Goldfish</li>
<li>Standard x86 emulator</li>
<li>(???) MIPS emulator</li>
</ul>
</li>
<li>One working device for CM12 is hammerhead (Nexus 5)</li>
</ul>
<p>You need to use the <code>breakfast</code> command.</p>
<p>The name of the command is a pun at the <code>lunch</code> command from AOSP, since this is more efficient and avoids fetching unneccessary repositories as <code>lunch</code> did.</p>
<p>If you invoke the <code>breakfast</code> command without options you will get be requested which device to build for:</p>
<pre><code>cmbuild@c8226ae3ff79:~/android/cm12$ breakfast
including vendor/cm/vendorsetup.sh

You&#39;re building on Linux

Breakfast menu... pick a combo:
 1. full-eng                             55. cm_m8-userdebug
 2. cm_a5-userdebug                      56. cm_mako-userdebug
 3. cm_acclaim-userdebug                 57. cm_manta-userdebug
 4. cm_amami-userdebug                   58. cm_maserati-userdebug
 5. cm_bacon-userdebug                   59. cm_mb886-userdebug
 6. cm_castor-userdebug                  60. cm_memul-userdebug
 7. cm_castor_windy-userdebug            61. cm_mint-userdebug
 8. cm_condor-userdebug                  62. cm_mondrianwifi-userdebug
 9. cm_d800-userdebug                    63. cm_n3-userdebug
 10. cm_d801-userdebug                   64. cm_n5110-userdebug
 11. cm_d802-userdebug                   65. cm_nicki-userdebug
 12. cm_d850-userdebug                   66. cm_obake-userdebug
 13. cm_d851-userdebug                   67. cm_peregrine-userdebug
 14. cm_d852-userdebug                   68. cm_picassowifi-userdebug
 15. cm_d855-userdebug                   69. cm_pollux-userdebug
 16. cm_deb-userdebug                    70. cm_pollux_windy-userdebug
 17. cm_dlx-userdebug                    71. cm_quark-userdebug
 18. cm_e970-userdebug                   72. cm_scorpion-userdebug
 19. cm_e975-userdebug                   73. cm_scorpion_windy-userdebug
 20. cm_e980-userdebug                   74. cm_serrano3gxx-userdebug
 21. cm_evita-userdebug                  75. cm_serranoltexx-userdebug
 22. cm_falcon-userdebug                 76. cm_shamu-userdebug
 23. cm_find5-userdebug                  77. cm_sirius-userdebug
 24. cm_find7-userdebug                  78. cm_spyder-userdebug
 25. cm_find7s-userdebug                 79. cm_superior-userdebug
 26. cm_flo-userdebug                    80. cm_t0lte-userdebug
 27. cm_flounder-userdebug               81. cm_t6-userdebug
 28. cm_ghost-userdebug                  82. cm_t6spr-userdebug
 29. cm_grouper-userdebug                83. cm_t6vzw-userdebug
 30. cm_hammerhead-userdebug             84. cm_taoshan-userdebug
 31. cm_hammerheadcaf-userdebug          85. cm_targa-userdebug
 32. cm_hlte-userdebug                   86. cm_tf300t-userdebug
 33. cm_hltespr-userdebug                87. cm_tilapia-userdebug
 34. cm_hltetmo-userdebug                88. cm_titan-userdebug
 35. cm_honami-userdebug                 89. cm_togari-userdebug
 36. cm_i605-userdebug                   90. cm_togari_gpe-userdebug
 37. cm_i925-userdebug                   91. cm_trltespr-userdebug
 38. cm_jactivelte-userdebug             92. cm_trltetmo-userdebug
 39. cm_jewel-userdebug                  93. cm_trlteusc-userdebug
 40. cm_jflteatt-userdebug               94. cm_trltexx-userdebug
 41. cm_jfltespr-userdebug               95. cm_tsubasa-userdebug
 42. cm_jfltetmo-userdebug               96. cm_umts_spyder-userdebug
 43. cm_jfltevzw-userdebug               97. cm_v500-userdebug
 44. cm_jfltexx-userdebug                98. cm_victara-userdebug
 45. cm_klimtwifi-userdebug              99. cm_ville-userdebug
 46. cm_klte-userdebug                   100. cm_vs985-userdebug
 47. cm_kltespr-userdebug                101. cm_xt897-userdebug
 48. cm_ks01lte-userdebug                102. cm_xt907-userdebug
 49. cm_l900-userdebug                   103. cm_xt925-userdebug
 50. cm_ls970-userdebug                  104. cm_xt925_jbbl-userdebug
 51. cm_ls980-userdebug                  105. cm_xt926-userdebug
 52. cm_m7-userdebug                     106. cm_z3-userdebug
 53. cm_m7spr-userdebug                  107. cm_z3c-userdebug
 54. cm_m7vzw-userdebug
... and don&#39;t forget the bacon!

Which would you like? [aosp_arm-eng]
</code></pre>
<p>Alternatively you may specify the combo directly as a parameter:</p>
<pre><code>$ breakfast hammerhead
</code></pre>
<p>This causes breakfast to call <a href="https://github.com/CyanogenMod/android_build/blob/cm-12.0/tools/roomservice.py"><code>roomservice.py</code></a> to create <code>.repo/local_manifests/roomservice.xml</code>, then will fetch the additional repositories specific for your device.</p>
<p>Result:</p>
<pre><code>...
Fetching projects:  50% (1/2)  From https://github.com/CyanogenMod/android_kernel_lge_hammerhead
 * [new branch]      cm-12.0    -&gt; github/cm-12.0
Fetching projects: 100% (2/2), done.
Checking out files: 100% (41864/41864), done.

Looking for dependencies
Dependencies file not found, bailing out.
Looking for dependencies
Dependencies file not found, bailing out.
Done

============================================
PLATFORM_VERSION_CODENAME=REL
PLATFORM_VERSION=5.0.2
CM_VERSION=12-20150410-UNOFFICIAL-hammerhead
TARGET_PRODUCT=cm_hammerhead
TARGET_BUILD_VARIANT=userdebug
TARGET_BUILD_TYPE=release
TARGET_BUILD_APPS=
TARGET_ARCH=arm
TARGET_ARCH_VARIANT=armv7-a-neon
TARGET_CPU_VARIANT=krait
TARGET_2ND_ARCH=
TARGET_2ND_ARCH_VARIANT=
TARGET_2ND_CPU_VARIANT=
HOST_ARCH=x86_64
HOST_OS=linux
HOST_OS_EXTRA=Linux-3.13.0-46-generic-x86_64-with-Ubuntu-14.04-trusty
HOST_BUILD_TYPE=release
BUILD_ID=LRX22G
OUT_DIR=/home/cmbuild/android/cm12/out
============================================

cmbuild@c8226ae3ff79:~/android/cm12$
</code></pre>
<h3 id="get-the-proprietary-stuff">Get the proprietary stuff</h3>
<p>Look inside the device directory</p>
<pre><code>$ croot
$ cd device/lge/hammerhead
</code></pre>
<p><code>extract-files.sh</code> is a simple script to process the binary blob copying the xxx - distribution becomes a little bit sketch.</p>
<p>Alternatively you may create a file under <code>.repo/local_manifests</code> to fetch the proprietary stuff from your private repositories:</p>
<!--
We obviously have a problem, guys are working on remote servers
in Amsterdam. So for purely educational purposes a separate organization

See <https://github.com/Themuppets>
Example: proprietary_vendor_htc

Another is <https://github.com/donkeycoyote>

<http://www.replicant.us> is trying to address the problem differently.
They are actually trying to recreate one by one the working binaries
from sources.
-->

<h3 id="invoke-brunch">Invoke brunch</h3>
<!-- Start: 2015-04-11 00:02 CEST -->

<pre><code>$ croot
$ brunch hammerhead
</code></pre>
<p>Result:</p>
<pre><code>cmbuild@c8226ae3ff79:~/android/cm12$ brunch hammerhead
including vendor/cm/vendorsetup.sh
Looking for dependencies

============================================
PLATFORM_VERSION_CODENAME=REL
PLATFORM_VERSION=5.0.2
CM_VERSION=12-20150410-UNOFFICIAL-hammerhead
TARGET_PRODUCT=cm_hammerhead
TARGET_BUILD_VARIANT=userdebug
TARGET_BUILD_TYPE=release
TARGET_BUILD_APPS=
TARGET_ARCH=arm
TARGET_ARCH_VARIANT=armv7-a-neon
TARGET_CPU_VARIANT=krait
TARGET_2ND_ARCH=
TARGET_2ND_ARCH_VARIANT=
TARGET_2ND_CPU_VARIANT=
HOST_ARCH=x86_64
HOST_OS=linux
HOST_OS_EXTRA=Linux-3.13.0-46-generic-x86_64-with-Ubuntu-14.04-trusty
HOST_BUILD_TYPE=release
BUILD_ID=LRX22G
OUT_DIR=/home/cmbuild/android/cm12/out
============================================

...
loaded device-specific extensions from /tmp/targetfiles-LWkAIq/META/releasetools.py
using prebuilt recovery.img from IMAGES...
using system.img from target-files
Total of 262144 4096-byte output blocks in 1531 input chunks.
Generating digraph...
Finding vertex sequence...
Removing backward edges...
  0/0 dependencies (0.00%) were violated; 0 source blocks removed.
Reticulating splines...
using prebuilt boot.img from IMAGES...
   boot size (8880128) is 38.49% of limit (23068672)
no bootloader.img in target_files; skipping install
no radio.img in target_files; skipping install
  running:  openssl pkcs8 -in build/target/product/security/testkey.pk8 -inform DER -nocrypt
  running:  java -Xmx2048m -jar /home/cmbuild/android/cm12/out/host/linux-x86/framework/signapk.jar -w build/target/product/security/testkey.x509.pem build/target/product/security/testkey.pk8 /tmp/tmp0iiLTP /home/cmbuild/android/cm12/out/target/product/hammerhead/cm_hammerhead-ota-6eade6066f.zip
done.
Package Complete: /home/cmbuild/android/cm12/out/target/product/hammerhead/cm-12-20150410-UNOFFICIAL-hammerhead.zip
cmbuild@c8226ae3ff79:~/android/cm12$
</code></pre>
<!-- End: TODO -->

<h3 id="inspecting-build-results">Inspecting build results</h3>
<p>Inspecting contents of output directory:</p>
<pre><code>cmbuild@c8226ae3ff79:~/android/cm12$ ls -la out/target/product/hammerhead/
total 1069396
drwxrwxr-x 12 cmbuild cmbuild      4096 Apr 11 00:07 .
drwxrwxr-x  3 cmbuild cmbuild      4096 Apr 10 22:01 ..
-rw-rw-r--  1 cmbuild cmbuild        59 Apr 10 22:05 android-info.txt
-rw-r--r--  1 cmbuild cmbuild   8880128 Apr 10 23:36 boot.img
drwxrwxr-x  2 cmbuild cmbuild      4096 Apr 10 23:02 cache
-rw-r--r--  1 cmbuild cmbuild  13668740 Apr 10 23:02 cache.img
-rw-rw-r--  1 cmbuild cmbuild     58712 Apr 10 22:01 clean_steps.mk
-rw-rw-r--  2 cmbuild cmbuild 244214934 Apr 11 00:07 cm-12-20150410-UNOFFICIAL-hammerhead.zip
-rw-rw-r--  1 cmbuild cmbuild       132 Apr 11 00:07 cm-12-20150410-UNOFFICIAL-hammerhead.zip.md5sum
-rw-rw-r--  2 cmbuild cmbuild 244214934 Apr 11 00:07 cm_hammerhead-ota-6eade6066f.zip
drwxrwxr-x  3 cmbuild cmbuild      4096 Apr 10 23:41 data
drwxrwxr-x  2 cmbuild cmbuild      4096 Apr 10 22:56 fake_packages
drwxrwxr-x  4 cmbuild cmbuild      4096 Apr 10 22:04 gen
drwxrwxr-x  3 cmbuild cmbuild      4096 Apr 10 22:44 install
-rw-rw-r--  1 cmbuild cmbuild     78046 Apr 11 00:04 installed-files.txt
-rw-rw-r--  1 cmbuild cmbuild   8080672 Apr 10 22:56 kernel
drwxrwxr-x 20 cmbuild cmbuild      4096 Apr 11 00:04 obj
-rw-rw-r--  1 cmbuild cmbuild         5 Apr 11 00:06 ota_override_device
-rw-rw-r--  1 cmbuild cmbuild        49 Apr 11 00:06 ota_script_path
-rw-rw-r--  1 cmbuild cmbuild       836 Apr 10 22:01 previous_build_config.mk
-rw-rw-r--  1 cmbuild cmbuild   3471363 Apr 10 23:40 ramdisk-recovery.img
-rw-rw-r--  1 cmbuild cmbuild    796064 Apr 10 23:34 ramdisk.img
drwxrwxr-x  3 cmbuild cmbuild      4096 Apr 10 22:03 recovery
-rw-r--r--  1 cmbuild cmbuild  11556864 Apr 10 23:41 recovery.img
drwxrwxr-x  9 cmbuild cmbuild      4096 Apr 10 23:33 root
drwxrwxr-x  7 cmbuild cmbuild      4096 Apr 10 23:40 symbols
drwxrwxr-x 15 cmbuild cmbuild      4096 Apr 10 23:51 system
-rw-r--r--  1 cmbuild cmbuild 419157960 Apr 11 00:04 system.img
-rw-r--r--  1 cmbuild cmbuild 140786596 Apr 10 23:41 userdata.img
cmbuild@c8226ae3ff79:~/android/cm12$
</code></pre>
<p>Inspecting contents of <code>cm-12-20150410-UNOFFICIAL-hammerhead.zip</code></p>
<pre><code>cmbuild@c8226ae3ff79:~/android/cm12$ unzip -v out/target/product/hammerhead/cm-12-20150410-UNOFFICIAL-hammerhead.zip
Archive:  out/target/product/hammerhead/cm-12-20150410-UNOFFICIAL-hammerhead.zip
signed by SignApk
 Length   Method    Size  Cmpr    Date    Time   CRC-32   Name
--------  ------  ------- ---- ---------- ----- --------  ----
       0  Stored        0   0% 2008-02-29 02:33 00000000  system.patch.dat
     149  Defl:N      123  17% 2008-02-29 02:33 a3a91293  META-INF/com/android/metadata
  408960  Defl:N   265489  35% 2008-02-29 02:33 1de5a125  META-INF/com/google/android/update-binary
    1831  Defl:N      590  68% 2008-02-29 02:33 dee0683f  META-INF/com/google/android/updater-script
    2393  Defl:N      888  63% 2008-02-29 02:33 50280357  META-INF/org/cyanogenmod/releasekey
 8880128  Defl:N  7732336  13% 2008-02-29 02:33 d1fe8719  boot.img
   19329  Defl:N     4273  78% 2008-02-29 02:33 480587f1  file_contexts
     757  Defl:N      375  51% 2008-02-29 02:33 7353c0af  install/bin/backuptool.functions
    2187  Defl:N      806  63% 2008-02-29 02:33 99e63141  install/bin/backuptool.sh
     990  Defl:N      505  49% 2008-02-29 02:33 9ee1cdca  install/bin/otasigcheck.sh
420360192  Defl:N 236200233  44% 2008-02-29 02:33 cfe4e5d7  system.new.dat
     212  Defl:N      114  46% 2008-02-29 02:33 ecc0ae87  system.transfer.list
    4357  Defl:N     1747  60% 2008-02-29 02:33 9dc6e7b9  system/build.prop
    1675  Defl:N      943  44% 2008-02-29 02:33 c3fc0954  META-INF/com/android/otacert
    1148  Defl:N      605  47% 2008-02-29 02:33 bb9d55c1  META-INF/MANIFEST.MF
    1327  Defl:N      639  52% 2008-02-29 02:33 3d6de3c8  META-INF/CERT.SF
    1714  Defl:N     1154  33% 2008-02-29 02:33 6dfe7d7a  META-INF/CERT.RSA
--------          -------  ---                            -------
429687349         244210820  43%                            17 files
cmbuild@c8226ae3ff79:~/android/cm12$
</code></pre>
<p>Unfortunately I do not own a Nexus 5 where to try flashing the images, so I need to stop here.</p>
<p>One of the next days I will try building CM11 for my Samsung Galaxy SII.</p>
<!-- markdown-link-check-enable -->
<!-- EOF -->
</div></article></div><footer class="h-auto mt-20 bg-gray-100 justify-between border-t border-gray-200"><div class="pt-6 mx-auto  gap-x-6 w-9/12 flex flex-col prose prose-indigo hover:prose-black md:prose-lg lg:prose-xl"><div class="prose-xl"><p class="">gmacario.github.io</p></div><div class="flex flex-col sm:flex-row flex-wrap justify-between md:justify-start"><p class="mr-12 text-gray-600 prose-sm">gmacario.github.io</p><div class="mr-12 flex flex-col justify-start"><p class="text-gray-600 prose-sm flex flex-row"><svg class="MuiSvgIcon-root mr-2" focusable="false" viewBox="0 0 24 24" aria-hidden="true"><path d="M12 .3a12 12 0 0 0-3.8 23.4c.6.1.8-.3.8-.6v-2c-3.3.7-4-1.6-4-1.6-.6-1.4-1.4-1.8-1.4-1.8-1-.7.1-.7.1-.7 1.2 0 1.9 1.2 1.9 1.2 1 1.8 2.8 1.3 3.5 1 0-.8.4-1.3.7-1.6-2.7-.3-5.5-1.3-5.5-6 0-1.2.5-2.3 1.3-3.1-.2-.4-.6-1.6 0-3.2 0 0 1-.3 3.4 1.2a11.5 11.5 0 0 1 6 0c2.3-1.5 3.3-1.2 3.3-1.2.6 1.6.2 2.8 0 3.2.9.8 1.3 1.9 1.3 3.2 0 4.6-2.8 5.6-5.5 5.9.5.4.9 1 .9 2.2v3.3c0 .3.1.7.8.6A12 12 0 0 0 12 .3"></path></svg><a href="https://github.com/gmacario">gmacario</a></p><p class="text-gray-600 prose-sm flex flex-row"><svg class="MuiSvgIcon-root mr-2" focusable="false" viewBox="0 0 24 24" aria-hidden="true"><path d="M22.46 6c-.77.35-1.6.58-2.46.69.88-.53 1.56-1.37 1.88-2.38-.83.5-1.75.85-2.72 1.05C18.37 4.5 17.26 4 16 4c-2.35 0-4.27 1.92-4.27 4.29 0 .34.04.67.11.98C8.28 9.09 5.11 7.38 3 4.79c-.37.63-.58 1.37-.58 2.15 0 1.49.75 2.81 1.91 3.56-.71 0-1.37-.2-1.95-.5v.03c0 2.08 1.48 3.82 3.44 4.21a4.22 4.22 0 0 1-1.93.07 4.28 4.28 0 0 0 4 2.98 8.521 8.521 0 0 1-5.33 1.84c-.34 0-.68-.02-1.02-.06C3.44 20.29 5.7 21 8.12 21 16 21 20.33 14.46 20.33 8.79c0-.19 0-.37-.01-.56.84-.6 1.56-1.36 2.14-2.23z"></path></svg><a href="https://www.twitter.com/gpmacario">gpmacario</a></p></div><p class="mr-12 text-gray-600 prose-sm">Gianpaolo Macario&#x27;s public rants</p></div></div></footer></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"Notes from CyanogenMod Workshop at IT Droidcon 2015","content":"\u003c!-- markdown-link-check-disable --\u003e\n\n\u003cp\u003eHere are a few notes which I took when attending the \u003ca href=\"http://it.droidcon.com/2015/sessions/cyanogen-workshop/\"\u003eCyanogen Workshop\u003c/a\u003e during the \u003ca href=\"http://it.droidcon.com/2015/\"\u003eIT Droidcon 2015\u003c/a\u003e which took place in Torino on 2015-04-10.\u003c/p\u003e\n\u003cp\u003eThe workshop was led by \u003ca href=\"https://twitter.com/ciwrl\"\u003eAbhisek Devkota\u003c/a\u003e, Senior Engineering and Community Manager at Cyanogen Inc., who was extremely good in driving the workshop forward and answered a lot of questions from the audience.\u003c/p\u003e\n\u003ch3 id=\"preparing-the-development-environment\"\u003ePreparing the development environment\u003c/h3\u003e\n\u003cp\u003eDue to some issues when creating the VPS instances that were going to the participants I instead used one machine which I had already available. That had the additional benefit to make sure I could reproduce all the steps - including provisioning the build environment!\u003c/p\u003e\n\u003cp\u003eI had a Ubuntu 14.04 64-bit server available via SSH with Docker installed.\u003c/p\u003e\n\u003cp\u003eAfter logging in to the server, I cloned the \u0026quot;docker-cyanogenmod\u0026quot; project\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e$ git clone https://github.com/gmacario/docker-cyanogenmod.git -b test-droidcon\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eNote: the \u0026quot;test-droidcon\u0026quot; branch on my fork is used in order to install exactly the packages which Abhisek had installed in his VPS instances.\u003c/p\u003e\n\u003cp\u003eThen run the following commands to create a Docker container with all the needed software automagically installed:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e$ cd docker-cyanogenmod\n$ ./run.sh\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThe first time it will take a few minutes to create the Docker image and start the container, but subsequent runs will be much faster!\u003c/p\u003e\n\u003cp\u003eAs a result I eventually got a shell inside the container:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003ecmbuild@c8226ae3ff79:~/android$ ls -la\ntotal 8\ndrwxrwxr-x 2 cmbuild cmbuild 4096 Apr 10 16:53 .\ndrwxr-xr-x 7 cmbuild cmbuild 4096 Apr 10 17:10 ..\ncmbuild@c8226ae3ff79:~/android$ free\n             total       used       free     shared    buffers     cached\nMem:      16433600   15763396     670204      13960     966884   12194076\n-/+ buffers/cache:    2602436   13831164\nSwap:     16775164      78012   16697152\ncmbuild@c8226ae3ff79:~/android$ df -h\nFilesystem                                              Size  Used Avail Use% Mounted on\nrootfs                                                  119G   81G   33G  72% /\nnone                                                    119G   81G   33G  72% /\nshm                                                      64M     0   64M   0% /dev/shm\n/dev/disk/by-uuid/b5696056-ded4-483a-be75-d0ac8afac2cb  119G   81G   33G  72% /etc/hosts\n/dev/sda1                                               1.8T  922G  820G  53% /srv/ccache\ncmbuild@c8226ae3ff79:~/android$\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eWow, plenty of resources to use! Let\u0026#39;s move on...\u003c/p\u003e\n\u003ch3 id=\"installing-repo\"\u003eInstalling Repo\u003c/h3\u003e\n\u003cp\u003eLogged as cmbuild@container:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e$ mkdir -p ~/bin\n$ curl https://storage.googleapis.com/git-repo-downloads/repo \u0026gt; ~/bin/repo\n$ chmod a+x ~/bin/repo\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"installing-the-android-sdk\"\u003eInstalling the Android SDK\u003c/h3\u003e\n\u003cp\u003eDownload the latest version of the Android SDK for Linux (24.1.2 as of 2015-04-10)\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e$ mkdir -p ~/sdk\n$ cd ~/sdk\n$ curl -O http://dl.google.com/android/android-sdk_r24.1.2-linux.tgz\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eIf the previous fails for whatever reasons (i.e. you are in a location which blocks access to Google)\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e$ curl -O https://dl.dropboxusercontent.com/u/2834459/android-sdk_r24.1.2-linux.tgz\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eAfter extracting the file your may remove the install tarball to save space:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e$ tar zxvf android-sdk_r24.1.2-linux.tgz\n$ rm android-sdk_r24.1.2-linux.tgz\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eUpdate \u003ccode\u003e~/.bashrc\u003c/code\u003e with the following definitions:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e$ cat \u0026lt;\u0026lt;END \u0026gt;\u0026gt;~/.bashrc\nexport ANDROID_HOME=\u0026quot;\\$HOME/sdk/android-sdk-linux\u0026quot;\nexport PATH=\u0026quot;\\$ANDROID_HOME/tools:\\$ANDROID_HOME/platform-tools:\\$PATH\u0026quot;\nEND\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThen logout from the container and launch \u003ccode\u003e./run.sh\u003c/code\u003e again to make sure\nthe environment variables are set correctly.\u003c/p\u003e\n\u003ch3 id=\"using-the-android-sdk\"\u003eUsing the Android SDK\u003c/h3\u003e\n\u003cp\u003eYou should have the \u003ccode\u003eandroid\u003c/code\u003e command in PATH, therefore you may do the following:\u003c/p\u003e\n\u003cp\u003eGet help\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e$ android --help\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eList remote SDK repository\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e$ android list sdk\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eUpdate the SDK specified\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e$ android update sdk --no-ui --filter 1,2,5\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eYou must read and accept the license by typing \u0026quot;y\u0026quot;, then the download will start.\u003c/p\u003e\n\u003ch3 id=\"git-config-and-repo-init\"\u003eGit config and repo init\u003c/h3\u003e\n\u003cpre\u003e\u003ccode\u003e$ git config --global user.email \u0026quot;email@example.com\u0026quot;\n$ git config --global user.name \u0026quot;First Lastname\u0026quot;\n$ git config --global color.ui auto\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eInit repo\u003c/p\u003e\n\u003cp\u003eIn our example we want to configure for CyanogenMod 12.0\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e$ mkdir -p ~/android/cm12/\n$ cd ~/android/cm12/\n$ repo init -u https://github.com/CyanogenMod/android.git -b cm-12.0\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eYou may also repo init AOSP pointing to the following URL instead: \u003ca href=\"https://android.googlesource.com/platform/manifest\"\u003ehttps://android.googlesource.com/platform/manifest\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eThere is a GitHub mirror (not always up-to-date) of AOSP at \u003ca href=\"https://github.com/android\"\u003ehttps://github.com/android\u003c/a\u003e\u003c/p\u003e\n\u003ch3 id=\"syncing-the-source-code\"\u003eSyncing the source code\u003c/h3\u003e\n\u003c!-- Start: 2015-04-10 20:53 CEST --\u003e\n\n\u003cpre\u003e\u003ccode\u003e$ repo sync â€“j16\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e(and a lot of waiting)\u003c/p\u003e\n\u003c!-- End: 2015-04-10 22:45 CEST --\u003e\n\n\u003cp\u003eResult:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003ecmbuild@c8226ae3ff79:~/android/cm12$ ls -la\ntotal 116\ndrwxrwxr-x  28 cmbuild cmbuild 4096 Apr 10 20:41 .\ndrwxrwxr-x   3 cmbuild cmbuild 4096 Apr 10 18:48 ..\ndrwxrwxr-x   7 cmbuild cmbuild 4096 Apr 10 20:29 .repo\n-r--r--r--   1 cmbuild cmbuild   87 Apr 10 20:29 Makefile\ndrwxrwxr-x   3 cmbuild cmbuild 4096 Apr 10 20:29 abi\ndrwxrwxr-x   3 cmbuild cmbuild 4096 Apr 10 20:29 android\ndrwxrwxr-x  14 cmbuild cmbuild 4096 Apr 10 20:29 art\ndrwxrwxr-x  10 cmbuild cmbuild 4096 Apr 10 20:29 bionic\ndrwxrwxr-x   3 cmbuild cmbuild 4096 Apr 10 20:29 bootable\ndrwxrwxr-x   7 cmbuild cmbuild 4096 Apr 10 20:29 build\ndrwxrwxr-x  12 cmbuild cmbuild 4096 Apr 10 20:29 cts\ndrwxrwxr-x  13 cmbuild cmbuild 4096 Apr 10 20:29 dalvik\ndrwxrwxr-x   6 cmbuild cmbuild 4096 Apr 10 20:29 developers\ndrwxrwxr-x  20 cmbuild cmbuild 4096 Apr 10 20:29 development\ndrwxrwxr-x   7 cmbuild cmbuild 4096 Apr 10 20:29 device\ndrwxrwxr-x   3 cmbuild cmbuild 4096 Apr 10 20:29 docs\ndrwxrwxr-x 237 cmbuild cmbuild 4096 Apr 10 20:33 external\ndrwxrwxr-x  18 cmbuild cmbuild 4096 Apr 10 20:34 frameworks\ndrwxrwxr-x  15 cmbuild cmbuild 4096 Apr 10 20:34 hardware\ndrwxrwxr-x  16 cmbuild cmbuild 4096 Apr 10 20:34 libcore\ndrwxrwxr-x   5 cmbuild cmbuild 4096 Apr 10 20:34 libnativehelper\ndrwxrwxr-x   8 cmbuild cmbuild 4096 Apr 10 20:35 ndk\ndrwxrwxr-x   9 cmbuild cmbuild 4096 Apr 10 20:36 packages\ndrwxrwxr-x   6 cmbuild cmbuild 4096 Apr 10 20:36 pdk\ndrwxrwxr-x  16 cmbuild cmbuild 4096 Apr 10 20:40 prebuilts\ndrwxrwxr-x  27 cmbuild cmbuild 4096 Apr 10 20:40 sdk\ndrwxrwxr-x  10 cmbuild cmbuild 4096 Apr 10 20:40 system\ndrwxrwxr-x   3 cmbuild cmbuild 4096 Apr 10 20:40 tools\ndrwxrwxr-x   4 cmbuild cmbuild 4096 Apr 10 20:41 vendor\ncmbuild@c8226ae3ff79:~/android/cm12$\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eDisk usage:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003ecmbuild@c8226ae3ff79:~/android/cm12$ du -sh\n29G     .\ncmbuild@c8226ae3ff79:~/android/cm12$\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"choose-your-device\"\u003eChoose your device\u003c/h3\u003e\n\u003cp\u003eSource the \u003ccode\u003eenvsetup.sh\u003c/code\u003e script to setup build environment\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e$ source build/envsetup.sh\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eYou need to choose your device. CM 12 has 107 targets so far.\nSee \u003ca href=\"https://github.com/CyanogenMod/hudson/blob/master/cm-build-targets\"\u003ehttps://github.com/CyanogenMod/hudson/blob/master/cm-build-targets\u003c/a\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eSamsung Galaxy SII (i9100) ==\u0026gt; Only cm11\u003c/li\u003e\n\u003cli\u003eEmulated hardware (TBV whether they work with Lollypop, at least they worked with KitKat):\u003cul\u003e\n\u003cli\u003eGoldfish\u003c/li\u003e\n\u003cli\u003eStandard x86 emulator\u003c/li\u003e\n\u003cli\u003e(???) MIPS emulator\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eOne working device for CM12 is hammerhead (Nexus 5)\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eYou need to use the \u003ccode\u003ebreakfast\u003c/code\u003e command.\u003c/p\u003e\n\u003cp\u003eThe name of the command is a pun at the \u003ccode\u003elunch\u003c/code\u003e command from AOSP, since this is more efficient and avoids fetching unneccessary repositories as \u003ccode\u003elunch\u003c/code\u003e did.\u003c/p\u003e\n\u003cp\u003eIf you invoke the \u003ccode\u003ebreakfast\u003c/code\u003e command without options you will get be requested which device to build for:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003ecmbuild@c8226ae3ff79:~/android/cm12$ breakfast\nincluding vendor/cm/vendorsetup.sh\n\nYou\u0026#39;re building on Linux\n\nBreakfast menu... pick a combo:\n 1. full-eng                             55. cm_m8-userdebug\n 2. cm_a5-userdebug                      56. cm_mako-userdebug\n 3. cm_acclaim-userdebug                 57. cm_manta-userdebug\n 4. cm_amami-userdebug                   58. cm_maserati-userdebug\n 5. cm_bacon-userdebug                   59. cm_mb886-userdebug\n 6. cm_castor-userdebug                  60. cm_memul-userdebug\n 7. cm_castor_windy-userdebug            61. cm_mint-userdebug\n 8. cm_condor-userdebug                  62. cm_mondrianwifi-userdebug\n 9. cm_d800-userdebug                    63. cm_n3-userdebug\n 10. cm_d801-userdebug                   64. cm_n5110-userdebug\n 11. cm_d802-userdebug                   65. cm_nicki-userdebug\n 12. cm_d850-userdebug                   66. cm_obake-userdebug\n 13. cm_d851-userdebug                   67. cm_peregrine-userdebug\n 14. cm_d852-userdebug                   68. cm_picassowifi-userdebug\n 15. cm_d855-userdebug                   69. cm_pollux-userdebug\n 16. cm_deb-userdebug                    70. cm_pollux_windy-userdebug\n 17. cm_dlx-userdebug                    71. cm_quark-userdebug\n 18. cm_e970-userdebug                   72. cm_scorpion-userdebug\n 19. cm_e975-userdebug                   73. cm_scorpion_windy-userdebug\n 20. cm_e980-userdebug                   74. cm_serrano3gxx-userdebug\n 21. cm_evita-userdebug                  75. cm_serranoltexx-userdebug\n 22. cm_falcon-userdebug                 76. cm_shamu-userdebug\n 23. cm_find5-userdebug                  77. cm_sirius-userdebug\n 24. cm_find7-userdebug                  78. cm_spyder-userdebug\n 25. cm_find7s-userdebug                 79. cm_superior-userdebug\n 26. cm_flo-userdebug                    80. cm_t0lte-userdebug\n 27. cm_flounder-userdebug               81. cm_t6-userdebug\n 28. cm_ghost-userdebug                  82. cm_t6spr-userdebug\n 29. cm_grouper-userdebug                83. cm_t6vzw-userdebug\n 30. cm_hammerhead-userdebug             84. cm_taoshan-userdebug\n 31. cm_hammerheadcaf-userdebug          85. cm_targa-userdebug\n 32. cm_hlte-userdebug                   86. cm_tf300t-userdebug\n 33. cm_hltespr-userdebug                87. cm_tilapia-userdebug\n 34. cm_hltetmo-userdebug                88. cm_titan-userdebug\n 35. cm_honami-userdebug                 89. cm_togari-userdebug\n 36. cm_i605-userdebug                   90. cm_togari_gpe-userdebug\n 37. cm_i925-userdebug                   91. cm_trltespr-userdebug\n 38. cm_jactivelte-userdebug             92. cm_trltetmo-userdebug\n 39. cm_jewel-userdebug                  93. cm_trlteusc-userdebug\n 40. cm_jflteatt-userdebug               94. cm_trltexx-userdebug\n 41. cm_jfltespr-userdebug               95. cm_tsubasa-userdebug\n 42. cm_jfltetmo-userdebug               96. cm_umts_spyder-userdebug\n 43. cm_jfltevzw-userdebug               97. cm_v500-userdebug\n 44. cm_jfltexx-userdebug                98. cm_victara-userdebug\n 45. cm_klimtwifi-userdebug              99. cm_ville-userdebug\n 46. cm_klte-userdebug                   100. cm_vs985-userdebug\n 47. cm_kltespr-userdebug                101. cm_xt897-userdebug\n 48. cm_ks01lte-userdebug                102. cm_xt907-userdebug\n 49. cm_l900-userdebug                   103. cm_xt925-userdebug\n 50. cm_ls970-userdebug                  104. cm_xt925_jbbl-userdebug\n 51. cm_ls980-userdebug                  105. cm_xt926-userdebug\n 52. cm_m7-userdebug                     106. cm_z3-userdebug\n 53. cm_m7spr-userdebug                  107. cm_z3c-userdebug\n 54. cm_m7vzw-userdebug\n... and don\u0026#39;t forget the bacon!\n\nWhich would you like? [aosp_arm-eng]\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eAlternatively you may specify the combo directly as a parameter:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e$ breakfast hammerhead\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThis causes breakfast to call \u003ca href=\"https://github.com/CyanogenMod/android_build/blob/cm-12.0/tools/roomservice.py\"\u003e\u003ccode\u003eroomservice.py\u003c/code\u003e\u003c/a\u003e to create \u003ccode\u003e.repo/local_manifests/roomservice.xml\u003c/code\u003e, then will fetch the additional repositories specific for your device.\u003c/p\u003e\n\u003cp\u003eResult:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e...\nFetching projects:  50% (1/2)  From https://github.com/CyanogenMod/android_kernel_lge_hammerhead\n * [new branch]      cm-12.0    -\u0026gt; github/cm-12.0\nFetching projects: 100% (2/2), done.\nChecking out files: 100% (41864/41864), done.\n\nLooking for dependencies\nDependencies file not found, bailing out.\nLooking for dependencies\nDependencies file not found, bailing out.\nDone\n\n============================================\nPLATFORM_VERSION_CODENAME=REL\nPLATFORM_VERSION=5.0.2\nCM_VERSION=12-20150410-UNOFFICIAL-hammerhead\nTARGET_PRODUCT=cm_hammerhead\nTARGET_BUILD_VARIANT=userdebug\nTARGET_BUILD_TYPE=release\nTARGET_BUILD_APPS=\nTARGET_ARCH=arm\nTARGET_ARCH_VARIANT=armv7-a-neon\nTARGET_CPU_VARIANT=krait\nTARGET_2ND_ARCH=\nTARGET_2ND_ARCH_VARIANT=\nTARGET_2ND_CPU_VARIANT=\nHOST_ARCH=x86_64\nHOST_OS=linux\nHOST_OS_EXTRA=Linux-3.13.0-46-generic-x86_64-with-Ubuntu-14.04-trusty\nHOST_BUILD_TYPE=release\nBUILD_ID=LRX22G\nOUT_DIR=/home/cmbuild/android/cm12/out\n============================================\n\ncmbuild@c8226ae3ff79:~/android/cm12$\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"get-the-proprietary-stuff\"\u003eGet the proprietary stuff\u003c/h3\u003e\n\u003cp\u003eLook inside the device directory\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e$ croot\n$ cd device/lge/hammerhead\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003ccode\u003eextract-files.sh\u003c/code\u003e is a simple script to process the binary blob copying the xxx - distribution becomes a little bit sketch.\u003c/p\u003e\n\u003cp\u003eAlternatively you may create a file under \u003ccode\u003e.repo/local_manifests\u003c/code\u003e to fetch the proprietary stuff from your private repositories:\u003c/p\u003e\n\u003c!--\nWe obviously have a problem, guys are working on remote servers\nin Amsterdam. So for purely educational purposes a separate organization\n\nSee \u003chttps://github.com/Themuppets\u003e\nExample: proprietary_vendor_htc\n\nAnother is \u003chttps://github.com/donkeycoyote\u003e\n\n\u003chttp://www.replicant.us\u003e is trying to address the problem differently.\nThey are actually trying to recreate one by one the working binaries\nfrom sources.\n--\u003e\n\n\u003ch3 id=\"invoke-brunch\"\u003eInvoke brunch\u003c/h3\u003e\n\u003c!-- Start: 2015-04-11 00:02 CEST --\u003e\n\n\u003cpre\u003e\u003ccode\u003e$ croot\n$ brunch hammerhead\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eResult:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003ecmbuild@c8226ae3ff79:~/android/cm12$ brunch hammerhead\nincluding vendor/cm/vendorsetup.sh\nLooking for dependencies\n\n============================================\nPLATFORM_VERSION_CODENAME=REL\nPLATFORM_VERSION=5.0.2\nCM_VERSION=12-20150410-UNOFFICIAL-hammerhead\nTARGET_PRODUCT=cm_hammerhead\nTARGET_BUILD_VARIANT=userdebug\nTARGET_BUILD_TYPE=release\nTARGET_BUILD_APPS=\nTARGET_ARCH=arm\nTARGET_ARCH_VARIANT=armv7-a-neon\nTARGET_CPU_VARIANT=krait\nTARGET_2ND_ARCH=\nTARGET_2ND_ARCH_VARIANT=\nTARGET_2ND_CPU_VARIANT=\nHOST_ARCH=x86_64\nHOST_OS=linux\nHOST_OS_EXTRA=Linux-3.13.0-46-generic-x86_64-with-Ubuntu-14.04-trusty\nHOST_BUILD_TYPE=release\nBUILD_ID=LRX22G\nOUT_DIR=/home/cmbuild/android/cm12/out\n============================================\n\n...\nloaded device-specific extensions from /tmp/targetfiles-LWkAIq/META/releasetools.py\nusing prebuilt recovery.img from IMAGES...\nusing system.img from target-files\nTotal of 262144 4096-byte output blocks in 1531 input chunks.\nGenerating digraph...\nFinding vertex sequence...\nRemoving backward edges...\n  0/0 dependencies (0.00%) were violated; 0 source blocks removed.\nReticulating splines...\nusing prebuilt boot.img from IMAGES...\n   boot size (8880128) is 38.49% of limit (23068672)\nno bootloader.img in target_files; skipping install\nno radio.img in target_files; skipping install\n  running:  openssl pkcs8 -in build/target/product/security/testkey.pk8 -inform DER -nocrypt\n  running:  java -Xmx2048m -jar /home/cmbuild/android/cm12/out/host/linux-x86/framework/signapk.jar -w build/target/product/security/testkey.x509.pem build/target/product/security/testkey.pk8 /tmp/tmp0iiLTP /home/cmbuild/android/cm12/out/target/product/hammerhead/cm_hammerhead-ota-6eade6066f.zip\ndone.\nPackage Complete: /home/cmbuild/android/cm12/out/target/product/hammerhead/cm-12-20150410-UNOFFICIAL-hammerhead.zip\ncmbuild@c8226ae3ff79:~/android/cm12$\n\u003c/code\u003e\u003c/pre\u003e\n\u003c!-- End: TODO --\u003e\n\n\u003ch3 id=\"inspecting-build-results\"\u003eInspecting build results\u003c/h3\u003e\n\u003cp\u003eInspecting contents of output directory:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003ecmbuild@c8226ae3ff79:~/android/cm12$ ls -la out/target/product/hammerhead/\ntotal 1069396\ndrwxrwxr-x 12 cmbuild cmbuild      4096 Apr 11 00:07 .\ndrwxrwxr-x  3 cmbuild cmbuild      4096 Apr 10 22:01 ..\n-rw-rw-r--  1 cmbuild cmbuild        59 Apr 10 22:05 android-info.txt\n-rw-r--r--  1 cmbuild cmbuild   8880128 Apr 10 23:36 boot.img\ndrwxrwxr-x  2 cmbuild cmbuild      4096 Apr 10 23:02 cache\n-rw-r--r--  1 cmbuild cmbuild  13668740 Apr 10 23:02 cache.img\n-rw-rw-r--  1 cmbuild cmbuild     58712 Apr 10 22:01 clean_steps.mk\n-rw-rw-r--  2 cmbuild cmbuild 244214934 Apr 11 00:07 cm-12-20150410-UNOFFICIAL-hammerhead.zip\n-rw-rw-r--  1 cmbuild cmbuild       132 Apr 11 00:07 cm-12-20150410-UNOFFICIAL-hammerhead.zip.md5sum\n-rw-rw-r--  2 cmbuild cmbuild 244214934 Apr 11 00:07 cm_hammerhead-ota-6eade6066f.zip\ndrwxrwxr-x  3 cmbuild cmbuild      4096 Apr 10 23:41 data\ndrwxrwxr-x  2 cmbuild cmbuild      4096 Apr 10 22:56 fake_packages\ndrwxrwxr-x  4 cmbuild cmbuild      4096 Apr 10 22:04 gen\ndrwxrwxr-x  3 cmbuild cmbuild      4096 Apr 10 22:44 install\n-rw-rw-r--  1 cmbuild cmbuild     78046 Apr 11 00:04 installed-files.txt\n-rw-rw-r--  1 cmbuild cmbuild   8080672 Apr 10 22:56 kernel\ndrwxrwxr-x 20 cmbuild cmbuild      4096 Apr 11 00:04 obj\n-rw-rw-r--  1 cmbuild cmbuild         5 Apr 11 00:06 ota_override_device\n-rw-rw-r--  1 cmbuild cmbuild        49 Apr 11 00:06 ota_script_path\n-rw-rw-r--  1 cmbuild cmbuild       836 Apr 10 22:01 previous_build_config.mk\n-rw-rw-r--  1 cmbuild cmbuild   3471363 Apr 10 23:40 ramdisk-recovery.img\n-rw-rw-r--  1 cmbuild cmbuild    796064 Apr 10 23:34 ramdisk.img\ndrwxrwxr-x  3 cmbuild cmbuild      4096 Apr 10 22:03 recovery\n-rw-r--r--  1 cmbuild cmbuild  11556864 Apr 10 23:41 recovery.img\ndrwxrwxr-x  9 cmbuild cmbuild      4096 Apr 10 23:33 root\ndrwxrwxr-x  7 cmbuild cmbuild      4096 Apr 10 23:40 symbols\ndrwxrwxr-x 15 cmbuild cmbuild      4096 Apr 10 23:51 system\n-rw-r--r--  1 cmbuild cmbuild 419157960 Apr 11 00:04 system.img\n-rw-r--r--  1 cmbuild cmbuild 140786596 Apr 10 23:41 userdata.img\ncmbuild@c8226ae3ff79:~/android/cm12$\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eInspecting contents of \u003ccode\u003ecm-12-20150410-UNOFFICIAL-hammerhead.zip\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003ecmbuild@c8226ae3ff79:~/android/cm12$ unzip -v out/target/product/hammerhead/cm-12-20150410-UNOFFICIAL-hammerhead.zip\nArchive:  out/target/product/hammerhead/cm-12-20150410-UNOFFICIAL-hammerhead.zip\nsigned by SignApk\n Length   Method    Size  Cmpr    Date    Time   CRC-32   Name\n--------  ------  ------- ---- ---------- ----- --------  ----\n       0  Stored        0   0% 2008-02-29 02:33 00000000  system.patch.dat\n     149  Defl:N      123  17% 2008-02-29 02:33 a3a91293  META-INF/com/android/metadata\n  408960  Defl:N   265489  35% 2008-02-29 02:33 1de5a125  META-INF/com/google/android/update-binary\n    1831  Defl:N      590  68% 2008-02-29 02:33 dee0683f  META-INF/com/google/android/updater-script\n    2393  Defl:N      888  63% 2008-02-29 02:33 50280357  META-INF/org/cyanogenmod/releasekey\n 8880128  Defl:N  7732336  13% 2008-02-29 02:33 d1fe8719  boot.img\n   19329  Defl:N     4273  78% 2008-02-29 02:33 480587f1  file_contexts\n     757  Defl:N      375  51% 2008-02-29 02:33 7353c0af  install/bin/backuptool.functions\n    2187  Defl:N      806  63% 2008-02-29 02:33 99e63141  install/bin/backuptool.sh\n     990  Defl:N      505  49% 2008-02-29 02:33 9ee1cdca  install/bin/otasigcheck.sh\n420360192  Defl:N 236200233  44% 2008-02-29 02:33 cfe4e5d7  system.new.dat\n     212  Defl:N      114  46% 2008-02-29 02:33 ecc0ae87  system.transfer.list\n    4357  Defl:N     1747  60% 2008-02-29 02:33 9dc6e7b9  system/build.prop\n    1675  Defl:N      943  44% 2008-02-29 02:33 c3fc0954  META-INF/com/android/otacert\n    1148  Defl:N      605  47% 2008-02-29 02:33 bb9d55c1  META-INF/MANIFEST.MF\n    1327  Defl:N      639  52% 2008-02-29 02:33 3d6de3c8  META-INF/CERT.SF\n    1714  Defl:N     1154  33% 2008-02-29 02:33 6dfe7d7a  META-INF/CERT.RSA\n--------          -------  ---                            -------\n429687349         244210820  43%                            17 files\ncmbuild@c8226ae3ff79:~/android/cm12$\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eUnfortunately I do not own a Nexus 5 where to try flashing the images, so I need to stop here.\u003c/p\u003e\n\u003cp\u003eOne of the next days I will try building CM11 for my Samsung Galaxy SII.\u003c/p\u003e\n\u003c!-- markdown-link-check-enable --\u003e\n\u003c!-- EOF --\u003e\n"},"config":{"title":"gmacario.github.io","description":"Gianpaolo Macario's public rants","social":{"github":{"name":"gmacario","link":"https://github.com/gmacario"},"twitter":{"name":"gpmacario","link":"https://www.twitter.com/gpmacario"}}}},"__N_SSG":true},"page":"/posts/[slug]","query":{"slug":"2015-04-11-notes-from-cyanogenmod-workshop-at-it-droidcon-2015"},"buildId":"Aw-i0FAEyy0eh9Lt17O8l","runtimeConfig":{},"isFallback":false,"gsp":true}</script><script nomodule="" src="/_next/static/chunks/polyfills-144e5fa6fafab6397d9c.js"></script><script src="/_next/static/chunks/webpack-50bee04d1dc61f8adf5b.js" async=""></script><script src="/_next/static/chunks/framework.1a5e6c0bcaecf178eee2.js" async=""></script><script src="/_next/static/chunks/commons.a817edd9b2693fcc6af8.js" async=""></script><script src="/_next/static/chunks/main-daaff4f95c13923f49a5.js" async=""></script><script src="/_next/static/chunks/pages/_app-041b1432faef8bf5f62a.js" async=""></script><script src="/_next/static/chunks/b38cc82cec06c0ea8b096def674947a423bb2764.260eb1ac110a53311620.js" async=""></script><script src="/_next/static/chunks/pages/posts/%5Bslug%5D-1c9a30b06d2f3be2ac9c.js" async=""></script><script src="/_next/static/Aw-i0FAEyy0eh9Lt17O8l/_buildManifest.js" async=""></script><script src="/_next/static/Aw-i0FAEyy0eh9Lt17O8l/_ssgManifest.js" async=""></script></body></html>