<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><meta name="description" content="Gianpaolo Macario&#x27;s public rants"/><title>Installing OpenWrt on Kingston MLWG2</title><meta name="next-head-count" content="4"/><link rel="preload" href="/_next/static/css/08fafe92abad983f984c.css" as="style"/><link rel="stylesheet" href="/_next/static/css/08fafe92abad983f984c.css" data-n-g=""/><noscript data-n-css=""></noscript><link rel="preload" href="/_next/static/chunks/webpack-50bee04d1dc61f8adf5b.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework.1a5e6c0bcaecf178eee2.js" as="script"/><link rel="preload" href="/_next/static/chunks/commons.a817edd9b2693fcc6af8.js" as="script"/><link rel="preload" href="/_next/static/chunks/main-daaff4f95c13923f49a5.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/_app-041b1432faef8bf5f62a.js" as="script"/><link rel="preload" href="/_next/static/chunks/b38cc82cec06c0ea8b096def674947a423bb2764.260eb1ac110a53311620.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/posts/%5Bslug%5D-1c9a30b06d2f3be2ac9c.js" as="script"/></head><body><div id="__next"><main class="h-screen flex flex-col"><header class="py-3 fixed top-0 z-50 flex flex-wrap justify-between w-screen bg-white border-b border-gray-200"><div class="mx-3 py-2 px-4  font-bold text-indigo-500">Gianpaolo Macario&#x27;s blog</div><div class="justify-end"><a class="mr-6 py-2 px-4 inline-block rounded h-full text-indigo-500 hover:text-white hover:bg-indigo-500" href="/">Home</a><a class="mr-6 py-2 px-4 inline-block rounded h-full text-indigo-500 hover:text-white hover:bg-indigo-500" href="/posts">Posts</a></div></header><div class="pt-28 mx-auto w-5/6 break-words flex flex-grow prose prose-indigo hover:prose-black md:prose-lg lg:prose-xl"><article><h1>Installing OpenWrt on Kingston MLWG2</h1><div class="prose prose-indigo hover:prose-black md:prose-lg lg:prose-xl"><!-- markdown-link-check-disable -->

<h3 id="introduction">Introduction</h3>
<p>This blog post explains how to install <a href="https://openwrt.org/">OpenWrt</a> on the <a href="http://www.kingston.com/us/wireless/wireless_readers">Kingston Mobilelite Wireless MLWG2</a>.</p>
<h3 id="download-openwrt-image-for-mlwg2">Download OpenWrt image for MLWG2</h3>
<p>Download Chaos Chalmer 15.05 for mlwg2 from <a href="https://downloads.openwrt.org/chaos_calmer/15.05/ramips/mt7620/">https://downloads.openwrt.org/chaos_calmer/15.05/ramips/mt7620/</a></p>
<p>File: <a href="https://downloads.openwrt.org/chaos_calmer/15.05/ramips/mt7620/openwrt-15.05-ramips-mt7620-mlwg2-squashfs-sysupgrade.bin">https://downloads.openwrt.org/chaos_calmer/15.05/ramips/mt7620/openwrt-15.05-ramips-mt7620-mlwg2-squashfs-sysupgrade.bin</a></p>
<pre><code>gmacario@ITM-GMACARIO-W7 ~/Downloads
$ ls -la openwrt-15.05-ramips-mt7620-mlwg2-squashfs-sysupgrade.bin
-rwxrwx---+ 1 Administrators Domain Users 3407876 Nov 29 08:38 openwrt-15.05-ramips-mt7620-mlwg2-squashfs-sysupgrade.bin

gmacario@ITM-GMACARIO-W7 ~/Downloads
$ md5sum openwrt-15.05-ramips-mt7620-mlwg2-squashfs-sysupgrade.bin
6948bca859a59797fc5f5978f004e11a *openwrt-15.05-ramips-mt7620-mlwg2-squashfs-sysupgrade.bin

gmacario@ITM-GMACARIO-W7 ~/Downloads
$
</code></pre>
<h3 id="prepare-the-install-media">Prepare the install media</h3>
<p>Plug a FAT32-formatted USB pendrive on the host and put the following files:</p>
<pre><code>$ cd /media/xxx/
$ touch &#39;mlwG2_v;telnetd; .x.x.bin&#39;
$ cp ~/Downloads/openwrt-15.05-ramips-mt7620-mlwg2-squashfs-sysupgrade.bin .
$ ls -la
$ cd
$ umount /media/xxx
</code></pre>
<p>(Optional, recommended) Connect a USB-to-serial-TTL dongle to the serial console</p>
<table>
<thead>
<tr>
<th>MLWG2 pad</th>
<th>Signal</th>
<th>Notes</th>
<th>Connect to</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>+3.3Vdc</td>
<td>Marked with a white dot</td>
<td>DO NOT CONNECT</td>
</tr>
<tr>
<td>2</td>
<td>TX</td>
<td>Close to R139</td>
<td>USB-to-TTL dongle pin &quot;R&quot;</td>
</tr>
<tr>
<td>3</td>
<td>RX</td>
<td>Close to R54</td>
<td>USB-to-TTL dongle pin &quot;T&quot;</td>
</tr>
<tr>
<td>4</td>
<td>GND</td>
<td>-</td>
<td>USB-to-TTL dongle pin &quot;G&quot;</td>
</tr>
</tbody></table>
<p>Launch a terminal emulator (COMx:57600,8,n,1)</p>
<p>Plug the USB Pendrive into the USB connector of the MLWG2.</p>
<p>Connect to Wi-Fi network &quot;MLWG2-xxxx&quot; (replace xxxx with the last two bytes of the MAC address)</p>
<p>Then telnet to 192.168.201.254 (username:admin; password:none)</p>
<pre><code>C:\Users\gmacario&gt;telnet 192.168.201.254

(none) login: admin

BusyBox v1.12.1 (2014-09-18 09:46:08 CST) built-in shell (ash)
Enter &#39;help&#39; for a list of built-in commands.

#
</code></pre>
<p>Logged as admin@mlwg2</p>
<pre><code># mtd_write write /media/USB1/openwrt-ramips-mt7620n-mlwg2-squashfs-sysupgrade.bin KernelA
# mtd_write -r write /media/USB1/openwrt-ramips-mt7620n-mlwg2-squashfs-sysupgrade.bin KernelB
</code></pre>
<p>The MLWG2 will reboot after the second command is complete.</p>
<p>Result:</p>
<pre><code># ls -la /media
drwxrwxrwx    2 0        0            4096 USB1
drwxr-xr-x   18 0        0               0 ..
drwxr-xr-x    3 0        0               0 .
# ls -la /media/USB1
-rwxrwxrwx    1 0        0         3407876 openwrt-15.05-ramips-mt7620-mlwg2-squ
ashfs-sysupgrade.bin
-rwxrwxrwx    1 0        0               0 mlwG2_v;telnetd; .x.x.bin
drwxr-xr-x    3 0        0               0 ..
drwxrwxrwx    2 0        0            4096 .
# mtd_write write /media/USB1/openwrt-15.05-ramips-mt7620-mlwg2-squashfs-sysupgr
ade.bin KernelA
Unlocking KernelA ...
Writing from /media/USB1/openwrt-15.05-ramips-mt7620-mlwg2-squashfs-sysupgrade.b
in to KernelA ...  [w]
# mtd_write -r write /media/USB1/openwrt-15.05-ramips-mt7620-mlwg2-squashfs-sysu
pgrade.bin KernelB
Unlocking KernelB ...
Writing from /media/USB1/openwrt-15.05-ramips-mt7620-mlwg2-squashfs-sysupgrade.b
in to KernelB ...  [e]

Connection to host lost.

C:\Users\gmacario&gt;
</code></pre>
<p>Result on the serial console:</p>
<pre><code>
BusyBox v1.23.2 (2015-07-25 03:03:02 CEST) built-in shell (ash)

  _______                     ________        __
 |       |.-----.-----.-----.|  |  |  |.----.|  |_
 |   -   ||  _  |  -__|     ||  |  |  ||   _||   _|
 |_______||   __|_____|__|__||________||__|  |____|
          |__| W I R E L E S S   F R E E D O M
 -----------------------------------------------------
 CHAOS CALMER (15.05, r46767)
 -----------------------------------------------------
  * 1 1/2 oz Gin            Shake with a glassful
  * 1/4 oz Triple Sec       of broken ice and pour
  * 3/4 oz Lime Juice       unstrained into a goblet.
  * 1 1/2 oz Orange Juice
  * 1 tsp. Grenadine Syrup
 -----------------------------------------------------
root@OpenWrt:/# [   76.140000] random: nonblocking pool is initialized

root@OpenWrt:/#
</code></pre>
<p>Inspect OpenWrt configured interfaces</p>
<pre><code>root@OpenWrt:/# ifconfig -a
br-lan    Link encap:Ethernet  HWaddr 00:26:B7:08:E0:A2
          inet addr:192.168.1.1  Bcast:192.168.1.255  Mask:255.255.255.0
          inet6 addr: fda0:2235:dc76::1/60 Scope:Global
          inet6 addr: fe80::226:b7ff:fe08:e0a2/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:333 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0
          RX bytes:0 (0.0 B)  TX bytes:31038 (30.3 KiB)

eth0      Link encap:Ethernet  HWaddr 00:26:B7:08:E0:A2
          inet6 addr: fe80::226:b7ff:fe08:e0a2/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:138 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000
          RX bytes:0 (0.0 B)  TX bytes:14401 (14.0 KiB)
          Interrupt:5

eth0.1    Link encap:Ethernet  HWaddr 00:26:B7:08:E0:A2
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:130 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0
          RX bytes:0 (0.0 B)  TX bytes:11500 (11.2 KiB)

lo        Link encap:Local Loopback
          inet addr:127.0.0.1  Mask:255.0.0.0
          inet6 addr: ::1/128 Scope:Host
          UP LOOPBACK RUNNING  MTU:65536  Metric:1
          RX packets:9168 errors:0 dropped:0 overruns:0 frame:0
          TX packets:9168 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0
          RX bytes:623424 (608.8 KiB)  TX bytes:623424 (608.8 KiB)

wlan0     Link encap:Ethernet  HWaddr 00:26:B7:08:E0:A2
          BROADCAST MULTICAST  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000
          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)

root@OpenWrt:/#
</code></pre>
<h3 id="openwrt---first-login">OpenWrt - First Login</h3>
<p>See <a href="https://wiki.openwrt.org/doc/howto/firstlogin">https://wiki.openwrt.org/doc/howto/firstlogin</a></p>
<p>Configure your host to connect to 192.168.1.1 using the local network</p>
<p>TODO</p>
<h3 id="reconfigure-networking">Reconfigure networking</h3>
<p>From the serial console use the uci command to take a static IP address in your local network and use Google DNS (replace x and y appropriately)</p>
<pre><code># uci set network.lan.netmask=255.255.255.0
# uci set network.lan.ipaddr=192.168.x.y
# uci set network.lan.gateway=192.168.x.z
# uci set network.lan.broadcast=192.168.x.255
# uci set network.lan.dns=&quot;8.8.4.4 8.8.8.8&quot;
# uci commit network
</code></pre>
<p>As an alternative, directly edit file <code>/etc/config/network</code></p>
<pre><code># vi /etc/config/network
</code></pre>
<p>Then restart networking</p>
<pre><code># /etc/init.d/network restart
</code></pre>
<p>Verify that the network configuration has changed accordingly (in this example we had network.lan.ipaddr=192.168.64.65)</p>
<pre><code>root@OpenWrt:/etc/config# ifconfig
br-lan    Link encap:Ethernet  HWaddr 00:26:B7:08:E0:A2
          inet addr:192.168.64.65  Bcast:192.168.64.255  Mask:255.255.255.0
          inet6 addr: fda0:2235:dc76::1/60 Scope:Global
          inet6 addr: fe80::226:b7ff:fe08:e0a2/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:37 errors:0 dropped:0 overruns:0 frame:0
          TX packets:26 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0
          RX bytes:2615 (2.5 KiB)  TX bytes:2655 (2.5 KiB)

eth0      Link encap:Ethernet  HWaddr 00:26:B7:08:E0:A2
          inet6 addr: fe80::226:b7ff:fe08:e0a2/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:1958 errors:0 dropped:0 overruns:0 frame:0
          TX packets:200 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000
          RX bytes:310839 (303.5 KiB)  TX bytes:21653 (21.1 KiB)
          Interrupt:5

eth0.1    Link encap:Ethernet  HWaddr 00:26:B7:08:E0:A2
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:69 errors:0 dropped:0 overruns:0 frame:0
          TX packets:35 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0
          RX bytes:4919 (4.8 KiB)  TX bytes:3389 (3.3 KiB)

lo        Link encap:Local Loopback
          inet addr:127.0.0.1  Mask:255.0.0.0
          inet6 addr: ::1/128 Scope:Host
          UP LOOPBACK RUNNING  MTU:65536  Metric:1
          RX packets:2064 errors:0 dropped:0 overruns:0 frame:0
          TX packets:2064 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0
          RX bytes:140352 (137.0 KiB)  TX bytes:140352 (137.0 KiB)

root@OpenWrt:/etc/config#
</code></pre>
<p>Perform some tests:</p>
<p>From the MLWG2, try pinging another host in the same subnet - for instance, the default gateway</p>
<pre><code># ping &lt;default_gateway_ip&gt;
</code></pre>
<p>Now try pinging a well known server - for instance, Google DNS</p>
<pre><code># ping 8.8.8.8
</code></pre>
<p>From a Linux machine on the same subnet do a port scan of the MLWG2</p>
<pre><code>$ sudo nmap &lt;device_ip&gt;
</code></pre>
<p>Stay tuned for future posts on some interesting uses of OpenWrt on my MLWG2!</p>
<h3 id="see-also">See also</h3>
<ul>
<li><a href="https://wiki.openwrt.org/toh/kingston/mlwg2">https://wiki.openwrt.org/toh/kingston/mlwg2</a></li>
<li><a href="https://github.com/gmacario/kingston-mlwg2-hack/wiki/Login-to-a-command-shell-on-MLWG2">https://github.com/gmacario/kingston-mlwg2-hack/wiki/Login-to-a-command-shell-on-MLWG2</a></li>
</ul>
<!-- markdown-link-check-enable -->
<!-- EOF -->
</div></article></div><footer class="h-auto mt-20 bg-gray-100 justify-between border-t border-gray-200"><div class="pt-6 mx-auto  gap-x-6 w-9/12 flex flex-col prose prose-indigo hover:prose-black md:prose-lg lg:prose-xl"><div class="prose-xl"><p class="">gmacario.github.io</p></div><div class="flex flex-col sm:flex-row flex-wrap justify-between md:justify-start"><p class="mr-12 text-gray-600 prose-sm">gmacario.github.io</p><div class="mr-12 flex flex-col justify-start"><p class="text-gray-600 prose-sm flex flex-row"><svg class="MuiSvgIcon-root mr-2" focusable="false" viewBox="0 0 24 24" aria-hidden="true"><path d="M12 .3a12 12 0 0 0-3.8 23.4c.6.1.8-.3.8-.6v-2c-3.3.7-4-1.6-4-1.6-.6-1.4-1.4-1.8-1.4-1.8-1-.7.1-.7.1-.7 1.2 0 1.9 1.2 1.9 1.2 1 1.8 2.8 1.3 3.5 1 0-.8.4-1.3.7-1.6-2.7-.3-5.5-1.3-5.5-6 0-1.2.5-2.3 1.3-3.1-.2-.4-.6-1.6 0-3.2 0 0 1-.3 3.4 1.2a11.5 11.5 0 0 1 6 0c2.3-1.5 3.3-1.2 3.3-1.2.6 1.6.2 2.8 0 3.2.9.8 1.3 1.9 1.3 3.2 0 4.6-2.8 5.6-5.5 5.9.5.4.9 1 .9 2.2v3.3c0 .3.1.7.8.6A12 12 0 0 0 12 .3"></path></svg><a href="https://github.com/gmacario">gmacario</a></p><p class="text-gray-600 prose-sm flex flex-row"><svg class="MuiSvgIcon-root mr-2" focusable="false" viewBox="0 0 24 24" aria-hidden="true"><path d="M22.46 6c-.77.35-1.6.58-2.46.69.88-.53 1.56-1.37 1.88-2.38-.83.5-1.75.85-2.72 1.05C18.37 4.5 17.26 4 16 4c-2.35 0-4.27 1.92-4.27 4.29 0 .34.04.67.11.98C8.28 9.09 5.11 7.38 3 4.79c-.37.63-.58 1.37-.58 2.15 0 1.49.75 2.81 1.91 3.56-.71 0-1.37-.2-1.95-.5v.03c0 2.08 1.48 3.82 3.44 4.21a4.22 4.22 0 0 1-1.93.07 4.28 4.28 0 0 0 4 2.98 8.521 8.521 0 0 1-5.33 1.84c-.34 0-.68-.02-1.02-.06C3.44 20.29 5.7 21 8.12 21 16 21 20.33 14.46 20.33 8.79c0-.19 0-.37-.01-.56.84-.6 1.56-1.36 2.14-2.23z"></path></svg><a href="https://www.twitter.com/gpmacario">gpmacario</a></p></div><p class="mr-12 text-gray-600 prose-sm">Gianpaolo Macario&#x27;s public rants</p></div></div></footer></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"Installing OpenWrt on Kingston MLWG2","content":"\u003c!-- markdown-link-check-disable --\u003e\n\n\u003ch3 id=\"introduction\"\u003eIntroduction\u003c/h3\u003e\n\u003cp\u003eThis blog post explains how to install \u003ca href=\"https://openwrt.org/\"\u003eOpenWrt\u003c/a\u003e on the \u003ca href=\"http://www.kingston.com/us/wireless/wireless_readers\"\u003eKingston Mobilelite Wireless MLWG2\u003c/a\u003e.\u003c/p\u003e\n\u003ch3 id=\"download-openwrt-image-for-mlwg2\"\u003eDownload OpenWrt image for MLWG2\u003c/h3\u003e\n\u003cp\u003eDownload Chaos Chalmer 15.05 for mlwg2 from \u003ca href=\"https://downloads.openwrt.org/chaos_calmer/15.05/ramips/mt7620/\"\u003ehttps://downloads.openwrt.org/chaos_calmer/15.05/ramips/mt7620/\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eFile: \u003ca href=\"https://downloads.openwrt.org/chaos_calmer/15.05/ramips/mt7620/openwrt-15.05-ramips-mt7620-mlwg2-squashfs-sysupgrade.bin\"\u003ehttps://downloads.openwrt.org/chaos_calmer/15.05/ramips/mt7620/openwrt-15.05-ramips-mt7620-mlwg2-squashfs-sysupgrade.bin\u003c/a\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003egmacario@ITM-GMACARIO-W7 ~/Downloads\n$ ls -la openwrt-15.05-ramips-mt7620-mlwg2-squashfs-sysupgrade.bin\n-rwxrwx---+ 1 Administrators Domain Users 3407876 Nov 29 08:38 openwrt-15.05-ramips-mt7620-mlwg2-squashfs-sysupgrade.bin\n\ngmacario@ITM-GMACARIO-W7 ~/Downloads\n$ md5sum openwrt-15.05-ramips-mt7620-mlwg2-squashfs-sysupgrade.bin\n6948bca859a59797fc5f5978f004e11a *openwrt-15.05-ramips-mt7620-mlwg2-squashfs-sysupgrade.bin\n\ngmacario@ITM-GMACARIO-W7 ~/Downloads\n$\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"prepare-the-install-media\"\u003ePrepare the install media\u003c/h3\u003e\n\u003cp\u003ePlug a FAT32-formatted USB pendrive on the host and put the following files:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e$ cd /media/xxx/\n$ touch \u0026#39;mlwG2_v;telnetd; .x.x.bin\u0026#39;\n$ cp ~/Downloads/openwrt-15.05-ramips-mt7620-mlwg2-squashfs-sysupgrade.bin .\n$ ls -la\n$ cd\n$ umount /media/xxx\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e(Optional, recommended) Connect a USB-to-serial-TTL dongle to the serial console\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eMLWG2 pad\u003c/th\u003e\n\u003cth\u003eSignal\u003c/th\u003e\n\u003cth\u003eNotes\u003c/th\u003e\n\u003cth\u003eConnect to\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\u003ctr\u003e\n\u003ctd\u003e1\u003c/td\u003e\n\u003ctd\u003e+3.3Vdc\u003c/td\u003e\n\u003ctd\u003eMarked with a white dot\u003c/td\u003e\n\u003ctd\u003eDO NOT CONNECT\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e2\u003c/td\u003e\n\u003ctd\u003eTX\u003c/td\u003e\n\u003ctd\u003eClose to R139\u003c/td\u003e\n\u003ctd\u003eUSB-to-TTL dongle pin \u0026quot;R\u0026quot;\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e3\u003c/td\u003e\n\u003ctd\u003eRX\u003c/td\u003e\n\u003ctd\u003eClose to R54\u003c/td\u003e\n\u003ctd\u003eUSB-to-TTL dongle pin \u0026quot;T\u0026quot;\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e4\u003c/td\u003e\n\u003ctd\u003eGND\u003c/td\u003e\n\u003ctd\u003e-\u003c/td\u003e\n\u003ctd\u003eUSB-to-TTL dongle pin \u0026quot;G\u0026quot;\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\u003c/table\u003e\n\u003cp\u003eLaunch a terminal emulator (COMx:57600,8,n,1)\u003c/p\u003e\n\u003cp\u003ePlug the USB Pendrive into the USB connector of the MLWG2.\u003c/p\u003e\n\u003cp\u003eConnect to Wi-Fi network \u0026quot;MLWG2-xxxx\u0026quot; (replace xxxx with the last two bytes of the MAC address)\u003c/p\u003e\n\u003cp\u003eThen telnet to 192.168.201.254 (username:admin; password:none)\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eC:\\Users\\gmacario\u0026gt;telnet 192.168.201.254\n\n(none) login: admin\n\nBusyBox v1.12.1 (2014-09-18 09:46:08 CST) built-in shell (ash)\nEnter \u0026#39;help\u0026#39; for a list of built-in commands.\n\n#\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eLogged as admin@mlwg2\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e# mtd_write write /media/USB1/openwrt-ramips-mt7620n-mlwg2-squashfs-sysupgrade.bin KernelA\n# mtd_write -r write /media/USB1/openwrt-ramips-mt7620n-mlwg2-squashfs-sysupgrade.bin KernelB\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThe MLWG2 will reboot after the second command is complete.\u003c/p\u003e\n\u003cp\u003eResult:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e# ls -la /media\ndrwxrwxrwx    2 0        0            4096 USB1\ndrwxr-xr-x   18 0        0               0 ..\ndrwxr-xr-x    3 0        0               0 .\n# ls -la /media/USB1\n-rwxrwxrwx    1 0        0         3407876 openwrt-15.05-ramips-mt7620-mlwg2-squ\nashfs-sysupgrade.bin\n-rwxrwxrwx    1 0        0               0 mlwG2_v;telnetd; .x.x.bin\ndrwxr-xr-x    3 0        0               0 ..\ndrwxrwxrwx    2 0        0            4096 .\n# mtd_write write /media/USB1/openwrt-15.05-ramips-mt7620-mlwg2-squashfs-sysupgr\nade.bin KernelA\nUnlocking KernelA ...\nWriting from /media/USB1/openwrt-15.05-ramips-mt7620-mlwg2-squashfs-sysupgrade.b\nin to KernelA ...  [w]\n# mtd_write -r write /media/USB1/openwrt-15.05-ramips-mt7620-mlwg2-squashfs-sysu\npgrade.bin KernelB\nUnlocking KernelB ...\nWriting from /media/USB1/openwrt-15.05-ramips-mt7620-mlwg2-squashfs-sysupgrade.b\nin to KernelB ...  [e]\n\nConnection to host lost.\n\nC:\\Users\\gmacario\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eResult on the serial console:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e\nBusyBox v1.23.2 (2015-07-25 03:03:02 CEST) built-in shell (ash)\n\n  _______                     ________        __\n |       |.-----.-----.-----.|  |  |  |.----.|  |_\n |   -   ||  _  |  -__|     ||  |  |  ||   _||   _|\n |_______||   __|_____|__|__||________||__|  |____|\n          |__| W I R E L E S S   F R E E D O M\n -----------------------------------------------------\n CHAOS CALMER (15.05, r46767)\n -----------------------------------------------------\n  * 1 1/2 oz Gin            Shake with a glassful\n  * 1/4 oz Triple Sec       of broken ice and pour\n  * 3/4 oz Lime Juice       unstrained into a goblet.\n  * 1 1/2 oz Orange Juice\n  * 1 tsp. Grenadine Syrup\n -----------------------------------------------------\nroot@OpenWrt:/# [   76.140000] random: nonblocking pool is initialized\n\nroot@OpenWrt:/#\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eInspect OpenWrt configured interfaces\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eroot@OpenWrt:/# ifconfig -a\nbr-lan    Link encap:Ethernet  HWaddr 00:26:B7:08:E0:A2\n          inet addr:192.168.1.1  Bcast:192.168.1.255  Mask:255.255.255.0\n          inet6 addr: fda0:2235:dc76::1/60 Scope:Global\n          inet6 addr: fe80::226:b7ff:fe08:e0a2/64 Scope:Link\n          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1\n          RX packets:0 errors:0 dropped:0 overruns:0 frame:0\n          TX packets:333 errors:0 dropped:0 overruns:0 carrier:0\n          collisions:0 txqueuelen:0\n          RX bytes:0 (0.0 B)  TX bytes:31038 (30.3 KiB)\n\neth0      Link encap:Ethernet  HWaddr 00:26:B7:08:E0:A2\n          inet6 addr: fe80::226:b7ff:fe08:e0a2/64 Scope:Link\n          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1\n          RX packets:0 errors:0 dropped:0 overruns:0 frame:0\n          TX packets:138 errors:0 dropped:0 overruns:0 carrier:0\n          collisions:0 txqueuelen:1000\n          RX bytes:0 (0.0 B)  TX bytes:14401 (14.0 KiB)\n          Interrupt:5\n\neth0.1    Link encap:Ethernet  HWaddr 00:26:B7:08:E0:A2\n          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1\n          RX packets:0 errors:0 dropped:0 overruns:0 frame:0\n          TX packets:130 errors:0 dropped:0 overruns:0 carrier:0\n          collisions:0 txqueuelen:0\n          RX bytes:0 (0.0 B)  TX bytes:11500 (11.2 KiB)\n\nlo        Link encap:Local Loopback\n          inet addr:127.0.0.1  Mask:255.0.0.0\n          inet6 addr: ::1/128 Scope:Host\n          UP LOOPBACK RUNNING  MTU:65536  Metric:1\n          RX packets:9168 errors:0 dropped:0 overruns:0 frame:0\n          TX packets:9168 errors:0 dropped:0 overruns:0 carrier:0\n          collisions:0 txqueuelen:0\n          RX bytes:623424 (608.8 KiB)  TX bytes:623424 (608.8 KiB)\n\nwlan0     Link encap:Ethernet  HWaddr 00:26:B7:08:E0:A2\n          BROADCAST MULTICAST  MTU:1500  Metric:1\n          RX packets:0 errors:0 dropped:0 overruns:0 frame:0\n          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0\n          collisions:0 txqueuelen:1000\n          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)\n\nroot@OpenWrt:/#\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"openwrt---first-login\"\u003eOpenWrt - First Login\u003c/h3\u003e\n\u003cp\u003eSee \u003ca href=\"https://wiki.openwrt.org/doc/howto/firstlogin\"\u003ehttps://wiki.openwrt.org/doc/howto/firstlogin\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eConfigure your host to connect to 192.168.1.1 using the local network\u003c/p\u003e\n\u003cp\u003eTODO\u003c/p\u003e\n\u003ch3 id=\"reconfigure-networking\"\u003eReconfigure networking\u003c/h3\u003e\n\u003cp\u003eFrom the serial console use the uci command to take a static IP address in your local network and use Google DNS (replace x and y appropriately)\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e# uci set network.lan.netmask=255.255.255.0\n# uci set network.lan.ipaddr=192.168.x.y\n# uci set network.lan.gateway=192.168.x.z\n# uci set network.lan.broadcast=192.168.x.255\n# uci set network.lan.dns=\u0026quot;8.8.4.4 8.8.8.8\u0026quot;\n# uci commit network\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eAs an alternative, directly edit file \u003ccode\u003e/etc/config/network\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e# vi /etc/config/network\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThen restart networking\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e# /etc/init.d/network restart\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eVerify that the network configuration has changed accordingly (in this example we had network.lan.ipaddr=192.168.64.65)\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eroot@OpenWrt:/etc/config# ifconfig\nbr-lan    Link encap:Ethernet  HWaddr 00:26:B7:08:E0:A2\n          inet addr:192.168.64.65  Bcast:192.168.64.255  Mask:255.255.255.0\n          inet6 addr: fda0:2235:dc76::1/60 Scope:Global\n          inet6 addr: fe80::226:b7ff:fe08:e0a2/64 Scope:Link\n          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1\n          RX packets:37 errors:0 dropped:0 overruns:0 frame:0\n          TX packets:26 errors:0 dropped:0 overruns:0 carrier:0\n          collisions:0 txqueuelen:0\n          RX bytes:2615 (2.5 KiB)  TX bytes:2655 (2.5 KiB)\n\neth0      Link encap:Ethernet  HWaddr 00:26:B7:08:E0:A2\n          inet6 addr: fe80::226:b7ff:fe08:e0a2/64 Scope:Link\n          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1\n          RX packets:1958 errors:0 dropped:0 overruns:0 frame:0\n          TX packets:200 errors:0 dropped:0 overruns:0 carrier:0\n          collisions:0 txqueuelen:1000\n          RX bytes:310839 (303.5 KiB)  TX bytes:21653 (21.1 KiB)\n          Interrupt:5\n\neth0.1    Link encap:Ethernet  HWaddr 00:26:B7:08:E0:A2\n          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1\n          RX packets:69 errors:0 dropped:0 overruns:0 frame:0\n          TX packets:35 errors:0 dropped:0 overruns:0 carrier:0\n          collisions:0 txqueuelen:0\n          RX bytes:4919 (4.8 KiB)  TX bytes:3389 (3.3 KiB)\n\nlo        Link encap:Local Loopback\n          inet addr:127.0.0.1  Mask:255.0.0.0\n          inet6 addr: ::1/128 Scope:Host\n          UP LOOPBACK RUNNING  MTU:65536  Metric:1\n          RX packets:2064 errors:0 dropped:0 overruns:0 frame:0\n          TX packets:2064 errors:0 dropped:0 overruns:0 carrier:0\n          collisions:0 txqueuelen:0\n          RX bytes:140352 (137.0 KiB)  TX bytes:140352 (137.0 KiB)\n\nroot@OpenWrt:/etc/config#\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003ePerform some tests:\u003c/p\u003e\n\u003cp\u003eFrom the MLWG2, try pinging another host in the same subnet - for instance, the default gateway\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e# ping \u0026lt;default_gateway_ip\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eNow try pinging a well known server - for instance, Google DNS\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e# ping 8.8.8.8\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eFrom a Linux machine on the same subnet do a port scan of the MLWG2\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e$ sudo nmap \u0026lt;device_ip\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eStay tuned for future posts on some interesting uses of OpenWrt on my MLWG2!\u003c/p\u003e\n\u003ch3 id=\"see-also\"\u003eSee also\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://wiki.openwrt.org/toh/kingston/mlwg2\"\u003ehttps://wiki.openwrt.org/toh/kingston/mlwg2\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/gmacario/kingston-mlwg2-hack/wiki/Login-to-a-command-shell-on-MLWG2\"\u003ehttps://github.com/gmacario/kingston-mlwg2-hack/wiki/Login-to-a-command-shell-on-MLWG2\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c!-- markdown-link-check-enable --\u003e\n\u003c!-- EOF --\u003e\n"},"config":{"title":"gmacario.github.io","description":"Gianpaolo Macario's public rants","social":{"github":{"name":"gmacario","link":"https://github.com/gmacario"},"twitter":{"name":"gpmacario","link":"https://www.twitter.com/gpmacario"}}}},"__N_SSG":true},"page":"/posts/[slug]","query":{"slug":"2015-11-29-install-openwrt-on-kingston-mlwg2"},"buildId":"-7k5ZcYCSvRaleGzPtn6k","runtimeConfig":{},"isFallback":false,"gsp":true}</script><script nomodule="" src="/_next/static/chunks/polyfills-144e5fa6fafab6397d9c.js"></script><script src="/_next/static/chunks/webpack-50bee04d1dc61f8adf5b.js" async=""></script><script src="/_next/static/chunks/framework.1a5e6c0bcaecf178eee2.js" async=""></script><script src="/_next/static/chunks/commons.a817edd9b2693fcc6af8.js" async=""></script><script src="/_next/static/chunks/main-daaff4f95c13923f49a5.js" async=""></script><script src="/_next/static/chunks/pages/_app-041b1432faef8bf5f62a.js" async=""></script><script src="/_next/static/chunks/b38cc82cec06c0ea8b096def674947a423bb2764.260eb1ac110a53311620.js" async=""></script><script src="/_next/static/chunks/pages/posts/%5Bslug%5D-1c9a30b06d2f3be2ac9c.js" async=""></script><script src="/_next/static/-7k5ZcYCSvRaleGzPtn6k/_buildManifest.js" async=""></script><script src="/_next/static/-7k5ZcYCSvRaleGzPtn6k/_ssgManifest.js" async=""></script></body></html>